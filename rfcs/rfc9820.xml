<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" ipr="trust200902" docName="draft-ietf-ace-wg-coap-eap-15" number="9820" updates="" obsoletes="" category="std" consensus="true" submissionType="IETF" tocDepth="3" tocInclude="true" sortRefs="true" symRefs="true" xml:lang="en" prepTime="2025-09-12T15:16:39" indexInclude="true" scripts="Common,Latin">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ace-wg-coap-eap-15" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9820" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="CoAP-EAP">Authentication Service Based on the Extensible Authentication Protocol (EAP) for Use with the Constrained Application Protocol (CoAP)</title>
    <seriesInfo name="RFC" value="9820" stream="IETF"/>
    <author initials="R." surname="Marin-Lopez" fullname="Rafa Marin-Lopez">
      <organization abbrev="University of Murcia" showOnFrontPage="true">University of Murcia</organization>
      <address>
        <postal>
          <street>Campus de Espinardo S/N, Faculty of Computer Science</street>
          <city>Murcia</city>
          <code>30100</code>
          <country>Spain</country>
        </postal>
        <email>rafa@um.es</email>
      </address>
    </author>
    <author initials="D." surname="Garcia-Carrillo" fullname="Dan Garcia-Carrillo">
      <organization abbrev="University of Oviedo" showOnFrontPage="true">University of Oviedo</organization>
      <address>
        <postal>
          <street>Calle Luis Ortiz Berrocal S/N, Edificio Polivalente</street>
          <city>Gijon</city>
          <region>Asturias</region>
          <code>33203</code>
          <country>Spain</country>
        </postal>
        <email>garciadan@uniovi.es</email>
      </address>
    </author>
    <date month="09" year="2025"/>
    <area>SEC</area>
    <workgroup>ace</workgroup>
    <keyword>CoAP</keyword>
    <keyword>EAP</keyword>
    <keyword>EAP lower layer</keyword>
    <keyword>Internet of Things</keyword>
    <keyword>IoT</keyword>
    <keyword>Constrained Node</keyword>
    <keyword>Smart Object</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">This document specifies an authentication service that uses the Constrained Application Protocol (CoAP) as a transport method to carry the Extensible Authentication Protocol (EAP). As such, it defines an EAP lower layer based on CoAP called "CoAP-EAP". One of the main goals is to authenticate a CoAP-enabled Internet of Things (IoT) device (EAP peer) that intends to join a security domain managed by a Controller (EAP authenticator). Secondly, it allows deriving key material to protect CoAP messages exchanged between them based on Object Security for Constrained RESTful Environments (OSCORE), enabling the establishment of a security association between them.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9820" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-language">Requirements Language</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-general-architecture">General Architecture</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-eap-operation">CoAP-EAP Operation</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-discovery">Discovery</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.2">
                <t indent="0" pn="section-toc.1-1.3.2.2.1"><xref derivedContent="3.2" format="counter" sectionFormat="of" target="section-3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-flow-of-operation-oscore-es">Flow of Operation (OSCORE Establishment)</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.3">
                <t indent="0" pn="section-toc.1-1.3.2.3.1"><xref derivedContent="3.3" format="counter" sectionFormat="of" target="section-3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-re-authentication">Re-Authentication</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.4">
                <t indent="0" pn="section-toc.1-1.3.2.4.1"><xref derivedContent="3.4" format="counter" sectionFormat="of" target="section-3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-managing-the-state-of-the-s">Managing the State of the Service</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.5">
                <t indent="0" pn="section-toc.1-1.3.2.5.1"><xref derivedContent="3.5" format="counter" sectionFormat="of" target="section-3.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-error-handling">Error Handling</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2.5.2">
                  <li pn="section-toc.1-1.3.2.5.2.1">
                    <t indent="0" pn="section-toc.1-1.3.2.5.2.1.1"><xref derivedContent="3.5.1" format="counter" sectionFormat="of" target="section-3.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-eap-authentication-failure">EAP Authentication Failure</xref></t>
                  </li>
                  <li pn="section-toc.1-1.3.2.5.2.2">
                    <t indent="0" pn="section-toc.1-1.3.2.5.2.2.1"><xref derivedContent="3.5.2" format="counter" sectionFormat="of" target="section-3.5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-non-responsive-endpoint">Non-Responsive Endpoint</xref></t>
                  </li>
                  <li pn="section-toc.1-1.3.2.5.2.3">
                    <t indent="0" pn="section-toc.1-1.3.2.5.2.3.1"><xref derivedContent="3.5.3" format="counter" sectionFormat="of" target="section-3.5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-duplicated-message-with-wel">Duplicated Message with /.well-known/coap-eap</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.3.2.6">
                <t indent="0" pn="section-toc.1-1.3.2.6.1"><xref derivedContent="3.6" format="counter" sectionFormat="of" target="section-3.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-proxy-operation-in-coap-eap">Proxy Operation in CoAP-EAP</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-eap-media-type-format">CoAP-EAP Media Type Format</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-objects-in-coap-eap">CBOR Objects in CoAP-EAP</xref></t>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cipher-suite-negotiation-an">Cipher Suite Negotiation and Key Derivation</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cipher-suite-negotiation">Cipher Suite Negotiation</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-deriving-the-oscore-securit">Deriving the OSCORE Security Context</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-discussion">Discussion</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-as-the-eap-lower-layer">CoAP as the EAP Lower Layer</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-size-of-the-eap-lower-layer">Size of the EAP Lower Layer vs. EAP Method Size</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-use-of-eap-methods">Use of EAP Methods</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.2">
                <t indent="0" pn="section-toc.1-1.8.2.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-authorization">Authorization</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.3">
                <t indent="0" pn="section-toc.1-1.8.2.3.1"><xref derivedContent="8.3" format="counter" sectionFormat="of" target="section-8.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-allowing-coap-eap-traffic-t">Allowing CoAP-EAP Traffic to Perform Authentication</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.4">
                <t indent="0" pn="section-toc.1-1.8.2.4.1"><xref derivedContent="8.4" format="counter" sectionFormat="of" target="section-8.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-freshness-of-the-key-materi">Freshness of the Key Material</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.5">
                <t indent="0" pn="section-toc.1-1.8.2.5.1"><xref derivedContent="8.5" format="counter" sectionFormat="of" target="section-8.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-channel-binding-support">Channel-Binding Support</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.6">
                <t indent="0" pn="section-toc.1-1.8.2.6.1"><xref derivedContent="8.6" format="counter" sectionFormat="of" target="section-8.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-additional-security-conside">Additional Security Considerations</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2">
              <li pn="section-toc.1-1.9.2.1">
                <t indent="0" pn="section-toc.1-1.9.2.1.1"><xref derivedContent="9.1" format="counter" sectionFormat="of" target="section-9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-eap-cipher-suites">CoAP-EAP Cipher Suites</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.2">
                <t indent="0" pn="section-toc.1-1.9.2.2.1"><xref derivedContent="9.2" format="counter" sectionFormat="of" target="section-9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cddl-in-coap-eap-informatio">CDDL in CoAP-EAP Information Elements</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.3">
                <t indent="0" pn="section-toc.1-1.9.2.3.1"><xref derivedContent="9.3" format="counter" sectionFormat="of" target="section-9.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-the-well-known-uris-registr">The Well-Known URIs Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.4">
                <t indent="0" pn="section-toc.1-1.9.2.4.1"><xref derivedContent="9.4" format="counter" sectionFormat="of" target="section-9.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-the-eap-lower-layers-regist">The EAP Lower Layers Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.5">
                <t indent="0" pn="section-toc.1-1.9.2.5.1"><xref derivedContent="9.5" format="counter" sectionFormat="of" target="section-9.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-media-types-registry">Media Types Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.6">
                <t indent="0" pn="section-toc.1-1.9.2.6.1"><xref derivedContent="9.6" format="counter" sectionFormat="of" target="section-9.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-content-formats-regist">CoAP Content-Formats Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.7">
                <t indent="0" pn="section-toc.1-1.9.2.7.1"><xref derivedContent="9.7" format="counter" sectionFormat="of" target="section-9.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-resource-type-rt-link-targe">Resource Type (rt=) Link Target Attribute Values Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.8">
                <t indent="0" pn="section-toc.1-1.9.2.8.1"><xref derivedContent="9.8" format="counter" sectionFormat="of" target="section-9.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-expert-review-instructions">Expert Review Instructions</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.2">
              <li pn="section-toc.1-1.10.2.1">
                <t indent="0" pn="section-toc.1-1.10.2.1.1"><xref derivedContent="10.1" format="counter" sectionFormat="of" target="section-10.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.10.2.2">
                <t indent="0" pn="section-toc.1-1.10.2.2.1"><xref derivedContent="10.2" format="counter" sectionFormat="of" target="section-10.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-flow-of-operation-dtls-esta">Flow of Operation (DTLS Establishment)</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
              <li pn="section-toc.1-1.11.2.1">
                <t indent="0" pn="section-toc.1-1.11.2.1.1"><xref derivedContent="A.1" format="counter" sectionFormat="of" target="section-appendix.a.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-deriving-dtls_psk-and-ident">Deriving DTLS_PSK and Identity</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="Appendix B" format="default" sectionFormat="of" target="section-appendix.b"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-using-coap-eap-for-distribu">Using CoAP-EAP for Distributing Key Material for IoT Networks</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="Appendix C" format="default" sectionFormat="of" target="section-appendix.c"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-use-case-scenarios">Example Use Case Scenarios</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
              <li pn="section-toc.1-1.13.2.1">
                <t indent="0" pn="section-toc.1-1.13.2.1.1"><xref derivedContent="C.1" format="counter" sectionFormat="of" target="section-appendix.c.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-1-coap-eap-using-ac">Example 1:  CoAP-EAP Using ACE</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.2">
                <t indent="0" pn="section-toc.1-1.13.2.2.1"><xref derivedContent="C.2" format="counter" sectionFormat="of" target="section-appendix.c.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-2-multiple-domains-">Example 2: Multiple Domains with AAA Infrastructures</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.3">
                <t indent="0" pn="section-toc.1-1.13.2.3.1"><xref derivedContent="C.3" format="counter" sectionFormat="of" target="section-appendix.c.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-3-single-domain-wit">Example 3: Single Domain with a AAA Infrastructure</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.4">
                <t indent="0" pn="section-toc.1-1.13.2.4.1"><xref derivedContent="C.4" format="counter" sectionFormat="of" target="section-appendix.c.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-4-single-domain-wit">Example 4: Single Domain Without a AAA Infrastructure</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.5">
                <t indent="0" pn="section-toc.1-1.13.2.5.1"><xref derivedContent="C.5" format="counter" sectionFormat="of" target="section-appendix.c.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-other-use-cases">Other Use Cases</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2.5.2">
                  <li pn="section-toc.1-1.13.2.5.2.1">
                    <t indent="0" pn="section-toc.1-1.13.2.5.2.1.1"><xref derivedContent="C.5.1" format="counter" sectionFormat="of" target="section-appendix.c.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-eap-for-network-access">CoAP-EAP for Network Access Authentication</xref></t>
                  </li>
                  <li pn="section-toc.1-1.13.2.5.2.2">
                    <t indent="0" pn="section-toc.1-1.13.2.5.2.2.1"><xref derivedContent="C.5.2" format="counter" sectionFormat="of" target="section-appendix.c.5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-eap-for-service-authen">CoAP-EAP for Service Authentication</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.d"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" pn="section-toc.1-1.15.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.e"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">This document specifies an authentication service (application) that uses the Extensible Authentication Protocol (EAP) <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> and is built on top of the Constrained Application Protocol (CoAP) <xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/>; it is called "CoAP-EAP". CoAP-EAP is an application that allows authenticating two CoAP endpoints by using EAP and establishing an Object Security for Constrained RESTful Environments (OSCORE) security association between them.
More specifically, this document specifies how CoAP can be used as a constrained, link-layer-independent, reliable EAP lower layer <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> to transport EAP messages between a CoAP server (acting as an EAP peer) and a CoAP client (acting as an EAP authenticator) using CoAP messages. The CoAP client has the option of contacting a backend Authentication, Authorization, and Accounting (AAA) infrastructure to complete the EAP negotiation, as described in the EAP specification <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>.</t>
      <t indent="0" pn="section-1-2">In the case of this specification, the EAP methods that can be transported with CoAP-EAP <bcp14>MUST</bcp14> export cryptographic material <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>. Examples of such methods are the EAP Generalized Pre-Shared Key (EAP-GPSK) <xref target="RFC5433" format="default" sectionFormat="of" derivedContent="RFC5433"/>, the EAP Method for Global System for Mobile Communications (GSM)
Subscriber Identity Modules (EAP-SIM) <xref target="RFC4186" format="default" sectionFormat="of" derivedContent="RFC4186"/>, the EAP Method for 3rd Generation Authentication and Key Agreement (EAP-AKA') <xref target="RFC5448" format="default" sectionFormat="of" derivedContent="RFC5448"/>,
EAP-TLS 1.3 <xref target="RFC9190" format="default" sectionFormat="of" derivedContent="RFC9190"/>, EAP with Ephemeral Diffie-Hellman over
CBOR Object Signing and Encryption (EAP-EDHOC) <xref target="I-D.ietf-emu-eap-edhoc" format="default" sectionFormat="of" derivedContent="EAP-EDHOC"/>, etc. ("CBOR" stands for "Concise Binary Object Representation".) In general, any EAP method
designed in the EAP Method Update (EMU) Working Group that exports the Master Session Key (MSK) can be used with CoAP-EAP. The MSK is used as the basis for further cryptographic derivations. This way, CoAP messages are protected after authentication. After the CoAP-EAP operation, an OSCORE security association is established between the endpoints of the service. Using the keying material from the authentication, other security associations could be generated. <xref target="flow-of-operation-dtls" format="default" sectionFormat="of" derivedContent="Appendix A"/> shows how to establish a (D)TLS security association using the keying material from the EAP authentication.</t>
      <t indent="0" pn="section-1-3">One of the main applications of CoAP-EAP involves Internet of Things (IoT) networks, where we can find very constrained links (e.g., limited bandwidth) and devices with limited capabilities. In these IoT scenarios, we identify the IoT device as the entity that wants to be authenticated by using EAP to join a domain that is managed by a Controller. In these cases, the IoT device is the EAP peer and the Controller is the entity steering the authentication (i.e., the EAP authenticator); from now on, the IoT device will be referred to as the EAP peer and the Controller will be referred to as the EAP authenticator. In these cases, EAP methods with fewer exchanges, shorter messages, and cryptographic algorithms suitable for constrained devices are preferable. The benefits of the EAP framework in IoT networks are highlighted in <xref target="EAP-Framework-IoT" format="default" sectionFormat="of" derivedContent="EAP-Framework-IoT"/>.</t>
      <section anchor="requirements-language" numbered="true" removeInRFC="false" toc="include" pn="section-1.1">
        <name slugifiedName="name-requirements-language">Requirements Language</name>
        <t indent="0" pn="section-1.1-1">The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
       "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>",
       "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>",
       "<bcp14>SHOULD NOT</bcp14>",
       "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
       "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document
       are to be interpreted as described in BCP 14
       <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only
       when, they appear in all capitals, as shown here.</t>
        <t indent="0" pn="section-1.1-2">Readers are expected to be familiar with the terms and concepts described in CoAP <xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/>, EAP <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>, and OSCORE <xref target="RFC8613" format="default" sectionFormat="of" derivedContent="RFC8613"/>.</t>
      </section>
    </section>
    <section anchor="general-architecture" numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-general-architecture">General Architecture</name>
      <t indent="0" pn="section-2-1"><xref target="arch" format="default" sectionFormat="of" derivedContent="Figure 1"/> illustrates the architecture defined in this document.  In this architecture, the EAP peer will act as a CoAP server for this
service and the domain EAP authenticator will act as a CoAP client. The rationale behind this decision is that EAP Requests will always travel from the EAP server to the EAP peer. Accordingly, EAP Responses will always travel from the EAP peer to the EAP server.</t>
      <t indent="0" pn="section-2-2">It is worth noting that the EAP authenticator <bcp14>MAY</bcp14> interact with a backend AAA infrastructure when EAP pass-through mode is used, which will place the EAP server in the AAA server that contains the information required to authenticate the EAP peer.</t>
      <t indent="0" pn="section-2-3">The protocol stack is described in <xref target="stack" format="default" sectionFormat="of" derivedContent="Figure 2"/>. CoAP-EAP is an application built on top of CoAP. On top of the application, there is an EAP state machine that can run any EAP method. In the case of this specification, the EAP method <bcp14>MUST</bcp14> support key derivation and export as specified in <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>: an MSK of at least 64 octets and an Extended Master Session Key (EMSK) of at least 64 octets. CoAP-EAP also relies on CoAP reliability mechanisms to transport EAP: CoAP over UDP with Confirmable messages <xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/> or CoAP over TCP, TLS, or WebSockets <xref target="RFC8323" format="default" sectionFormat="of" derivedContent="RFC8323"/>.</t>
      <figure anchor="arch" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-coap-eap-architecture">CoAP-EAP Architecture</name>
        <artset pn="section-2-4.1">
          <artwork type="svg" align="center" pn="section-2-4.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="480" viewBox="0 0 480 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,80" fill="none" stroke="black"/>
              <path d="M 80,32 L 80,80" fill="none" stroke="black"/>
              <path d="M 152,32 L 152,80" fill="none" stroke="black"/>
              <path d="M 272,32 L 272,80" fill="none" stroke="black"/>
              <path d="M 384,32 L 384,80" fill="none" stroke="black"/>
              <path d="M 472,32 L 472,80" fill="none" stroke="black"/>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"/>
              <path d="M 152,32 L 272,32" fill="none" stroke="black"/>
              <path d="M 384,32 L 472,32" fill="none" stroke="black"/>
              <path d="M 88,64 L 144,64" fill="none" stroke="black"/>
              <path d="M 280,64 L 376,64" fill="none" stroke="black"/>
              <path d="M 8,80 L 80,80" fill="none" stroke="black"/>
              <path d="M 152,80 L 272,80" fill="none" stroke="black"/>
              <path d="M 384,80 L 472,80" fill="none" stroke="black"/>
              <path d="M 8,112 L 40,112" fill="none" stroke="black"/>
              <path d="M 240,112 L 272,112" fill="none" stroke="black"/>
              <polygon class="arrowhead" points="384,64 372,58.4 372,69.6" fill="black" transform="rotate(0,376,64)"/>
              <polygon class="arrowhead" points="288,64 276,58.4 276,69.6" fill="black" transform="rotate(180,280,64)"/>
              <polygon class="arrowhead" points="280,112 268,106.4 268,117.6" fill="black" transform="rotate(0,272,112)"/>
              <polygon class="arrowhead" points="152,64 140,58.4 140,69.6" fill="black" transform="rotate(0,144,64)"/>
              <polygon class="arrowhead" points="96,64 84,58.4 84,69.6" fill="black" transform="rotate(180,88,64)"/>
              <polygon class="arrowhead" points="16,112 4,106.4 4,117.6" fill="black" transform="rotate(180,8,112)"/>
              <g class="text">
                <text x="40" y="52">EAP</text>
                <text x="192" y="52">EAP</text>
                <text x="428" y="52">AAA/</text>
                <text x="44" y="68">peer</text>
                <text x="216" y="68">authenticator</text>
                <text x="400" y="68">EAP</text>
                <text x="444" y="68">server</text>
                <text x="116" y="84">CoAP</text>
                <text x="328" y="84">AAA</text>
                <text x="332" y="100">(optional)</text>
                <text x="72" y="116">SCOPE</text>
                <text x="108" y="116">OF</text>
                <text x="140" y="116">THIS</text>
                <text x="196" y="116">DOCUMENT</text>
              </g>
            </svg>
          </artwork>
          <artwork type="ascii-art" align="center" pn="section-2-4.1.2">
  +--------+        +--------------+             +----------+
  |  EAP   |        |   EAP        |             |   AAA/   |
  |  peer  |&lt;------&gt;| authenticator|&lt;-----------&gt;|EAP server|
  +--------+  CoAP  +--------------+     AAA     +----------+
                                      (optional)
  &lt;---- SCOPE OF THIS DOCUMENT ----&gt;
</artwork>
        </artset>
      </figure>
      <figure anchor="stack" align="left" suppress-title="false" pn="figure-2">
        <name slugifiedName="name-coap-eap-stack">CoAP-EAP Stack</name>
        <artset pn="section-2-5.1">
          <artwork type="svg" align="center" pn="section-2-5.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="464" viewBox="0 0 464 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,192" fill="none" stroke="black"/>
              <path d="M 296,32 L 296,192" fill="none" stroke="black"/>
              <path d="M 8,32 L 296,32" fill="none" stroke="black"/>
              <path d="M 8,64 L 296,64" fill="none" stroke="black"/>
              <path d="M 312,80 L 328,80" fill="none" stroke="black"/>
              <path d="M 8,96 L 296,96" fill="none" stroke="black"/>
              <path d="M 8,128 L 296,128" fill="none" stroke="black"/>
              <path d="M 8,160 L 296,160" fill="none" stroke="black"/>
              <path d="M 8,192 L 296,192" fill="none" stroke="black"/>
              <polygon class="arrowhead" points="320,80 308,74.4 308,85.6" fill="black" transform="rotate(180,312,80)"/>
              <g class="text">
                <text x="96" y="52">EAP</text>
                <text x="136" y="52">State</text>
                <text x="192" y="52">Machine</text>
                <text x="112" y="84">Application</text>
                <text x="204" y="84">(CoAP-EAP)</text>
                <text x="356" y="84">This</text>
                <text x="412" y="84">Document</text>
                <text x="52" y="116">Requests</text>
                <text x="96" y="116">/</text>
                <text x="144" y="116">Responses</text>
                <text x="192" y="116">/</text>
                <text x="240" y="116">Signaling</text>
                <text x="320" y="116">RFC</text>
                <text x="356" y="116">7252</text>
                <text x="384" y="116">/</text>
                <text x="408" y="116">RFC</text>
                <text x="444" y="116">8323</text>
                <text x="80" y="148">Message</text>
                <text x="120" y="148">/</text>
                <text x="160" y="148">Message</text>
                <text x="224" y="148">Framing</text>
                <text x="320" y="148">RFC</text>
                <text x="356" y="148">7252</text>
                <text x="384" y="148">/</text>
                <text x="408" y="148">RFC</text>
                <text x="444" y="148">8323</text>
                <text x="68" y="180">Unreliable</text>
                <text x="120" y="180">/</text>
                <text x="164" y="180">Reliable</text>
                <text x="240" y="180">Transport</text>
                <text x="320" y="180">RFC</text>
                <text x="356" y="180">7252</text>
                <text x="384" y="180">/</text>
                <text x="408" y="180">RFC</text>
                <text x="444" y="180">8323</text>
              </g>
            </svg>
          </artwork>
          <artwork type="ascii-art" align="center" pn="section-2-5.1.2">
  +-----------------------------------+
  |         EAP State Machine         |
  +-----------------------------------+
  |       Application (CoAP-EAP)      | &lt;-- This Document
  +-----------------------------------+
  | Requests / Responses / Signaling  | RFC 7252 / RFC 8323
  +-----------------------------------+
  |     Message / Message Framing     | RFC 7252 / RFC 8323
  +-----------------------------------+
  |  Unreliable / Reliable Transport  | RFC 7252 / RFC 8323
  +-----------------------------------+
</artwork>
        </artset>
      </figure>
    </section>
    <section anchor="sec_coap-eap-operation" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-coap-eap-operation">CoAP-EAP Operation</name>
      <t indent="0" pn="section-3-1">Because CoAP-EAP uses reliable delivery as defined in CoAP <xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/> <xref target="RFC8323" format="default" sectionFormat="of" derivedContent="RFC8323"/>, EAP retransmission time is set to an infinite value, as mentioned in <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>. To maintain ordering guarantees, CoAP-EAP uses Hypermedia as the Engine of Application State (HATEOAS). Each step during the EAP authentication accesses a new resource in the CoAP server (EAP peer). The previous resource is removed once the new resource is created, indicating the resource that will process the next step of the EAP authentication.</t>
      <t indent="0" pn="section-3-2">One of the benefits of using EAP is that we can choose from a large variety of authentication methods.</t>
      <t indent="0" pn="section-3-3">In CoAP-EAP, the EAP peer will only have one authentication session with a specific EAP authenticator, and it will not process any other EAP authentication in parallel (with the same EAP authenticator). That is, a single ongoing EAP authentication is permitted for the same EAP peer and the same EAP authenticator. It may be worth noting that the EAP authenticator may have parallel EAP sessions with multiple EAP peers.</t>
      <t indent="0" pn="section-3-4">To access the authentication service, this document defines the well-known URI "coap-eap" (see <xref target="wellknown" format="default" sectionFormat="of" derivedContent="Section 9.3"/>).  The /.well-known/coap-eap URI is used with "coap", "coap+tcp", or "coap+ws".</t>
      <section anchor="discovery-section" numbered="true" removeInRFC="false" toc="include" pn="section-3.1">
        <name slugifiedName="name-discovery">Discovery</name>
        <t indent="0" pn="section-3.1-1">Before the CoAP-EAP exchange takes place, the EAP peer needs to discover the EAP authenticator or the entity that will enable the CoAP-EAP exchange (i.e., an intermediary). The discovery process is outside the scope of this document.</t>
        <t indent="0" pn="section-3.1-2">The CoAP-EAP application can be accessed through the URI "coap-eap" for the trigger message (see <xref target="flow-of-operation" format="default" sectionFormat="of" derivedContent="Section 3.2"/>, Step 0). The CoAP-EAP service can be discovered by asking directly about the services offered. This information can also be available in the resource directory <xref target="RFC9176" format="default" sectionFormat="of" derivedContent="RFC9176"/>.</t>
        <t indent="0" pn="section-3.1-3">Implementation notes: There are different methods for discovering the IPv6 address of the EAP authenticator or intermediary entity. For example, in a 6LoWPAN network, the Border Router will typically act as the EAP authenticator. Hence, after receiving the Router Advertisement (RA) messages from the Border Router, the EAP peer may engage in the CoAP-EAP exchange.</t>
      </section>
      <section anchor="flow-of-operation" numbered="true" removeInRFC="false" toc="include" pn="section-3.2">
        <name slugifiedName="name-flow-of-operation-oscore-es">Flow of Operation (OSCORE Establishment)</name>
        <t indent="0" pn="section-3.2-1"><xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/> shows the general flow of operation for CoAP-EAP to authenticate using EAP and establish an OSCORE Security Context. The flow does not show a specific EAP method. Instead, the chosen EAP method is represented by using a generic name (EAP-X).  The flow assumes that the EAP peer knows the EAP authenticator implements the CoAP-EAP service. A CoAP-EAP message has the media type "application/coap-eap". See <xref target="mediatypes" format="default" sectionFormat="of" derivedContent="Section 9.5"/>.</t>
        <t indent="0" pn="section-3.2-2">The steps for this flow of operation are as follows:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3.2-3">
          <li pn="section-3.2-3.1">
            <t indent="0" pn="section-3.2-3.1.1">Step 0. The EAP peer <bcp14>MUST</bcp14> start the CoAP-EAP
          process by sending a "POST /.well-known/coap-eap" request (trigger
          message). This message carries the 'No-Response' CoAP option <xref target="RFC7967" format="default" sectionFormat="of" derivedContent="RFC7967"/> to avoid waiting for a response that
          is not needed. This is the only message where the EAP authenticator
          acts as a CoAP server and the EAP peer acts as a CoAP client. The message
          also includes a URI in the payload of the message to indicate the
          resource where the EAP authenticator <bcp14>MUST</bcp14> send the
          next message. The name of the resource is selected by the CoAP
          server.</t>
          </li>
        </ul>
        <t indent="0" pn="section-3.2-4">Implementation notes: When generating the URI for a resource during a
          step of the authentication, the resource could have the following
          format as an example "path/eap/counter", where:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3.2-5">
          <li pn="section-3.2-5.1">"path" is some local path on the device to make the path unique.  This could be omitted if desired.</li>
          <li pn="section-3.2-5.2">"eap" is the name that indicates that the URI is for the EAP peer.
            This has no meaning for the protocol but helps with
            debugging.</li>
          <li pn="section-3.2-5.3">"counter" is an incrementing unique number for every new EAP Request.</li>
        </ul>
        <t indent="0" pn="section-3.2-6">So, per <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>, the URI for the first resource would be "/a/eap/1".</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3.2-7">
          <li pn="section-3.2-7.1">Step 1. The EAP authenticator sends a POST message to the
          resource indicated in Step 0 (e.g., "/a/eap/1"). The payload in this
          message contains the first EAP message (EAP-Request/Identity, or EAP-Req/Id) and the
          Recipient ID of the EAP authenticator (RID-C) for OSCORE, and
          <bcp14>MAY</bcp14> contain a CBOR array with a list of proposed
          cipher suites (CS-C) for OSCORE. If the cipher suite list is not
          included, the default cipher suite for OSCORE is used. The details
          of the cipher suite negotiation are discussed in <xref target="crypto-negotiation" format="default" sectionFormat="of" derivedContent="Section 6.1"/>.</li>
          <li pn="section-3.2-7.2">Step 2. The EAP peer processes the POST message sending the EAP
          Request (EAP-Req/Id) to the EAP peer state machine, which returns an
          EAP Response (EAP-Response/Identity, or EAP-Resp/Id). Then, the CoAP-EAP application assigns a new resource to the
          ongoing authentication process (e.g., "/a/eap/2") and deletes the
          previous one ("/a/eap/1"). Finally, the CoAP-EAP application sends a '2.01 Created' response
          with the new resource identifier in the Location-Path (and/or
          Location-Query) Options for the next step. The EAP Response, the
          Recipient ID of the EAP peer (RID-I), and the selected cipher suite
          for OSCORE (CS-I) are included in the payload. In this step, the EAP
          peer may create an OSCORE Security Context (see <xref target="OSCORE" format="default" sectionFormat="of" derivedContent="Section 6.2"/>). The required MSK will be
          available once the EAP authentication is successful (Step 7).</li>
          <li pn="section-3.2-7.3">Steps 3-6. From now on, the EAP authenticator and the EAP peer
          will exchange EAP packets related to the EAP method (EAP-X),
          transported in the CoAP message payload. The EAP authenticator will
          use the POST method to send EAP Requests to the EAP peer. The EAP
          peer will use a CoAP response to carry the EAP Response in the
          payload. EAP Requests and responses are represented in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/> using the nomenclature "EAP-X-Req" and "EAP-X-Resp",
          respectively.  When a POST message arrives (e.g., "/a/eap/1")
          carrying an EAP Request message, if processed correctly by the EAP
          peer state machine, it returns an EAP Response. Along with each EAP
          Response, a new resource is created (e.g., "/a/eap/3") for
          processing the next EAP Request and the ongoing resource (e.g.,
          "/a/eap/2") is erased. This way, ordering guarantees are
          achieved. Finally, an EAP Response is sent in the payload of a CoAP
          response that will also indicate the new resource in the
          Location-Path (and/or Location-Query) Options. If an
          error occurs while processing a legitimate message, the server will return a
          '4.00 Bad Request'. Error handling is discussed in
          <xref target="error-handling" format="default" sectionFormat="of" derivedContent="Section 3.5"/>.</li>
          <li pn="section-3.2-7.4">Step 7. When the EAP authentication ends successfully, the EAP
          authenticator obtains the MSK exported by the
          EAP method, an EAP Success message, and some authorization
          information <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/> (e.g., Session-Lifetime). The
          EAP authenticator creates the OSCORE Security Context using the MSK
          and Recipient ID of both entities exchanged in Steps 1 and 2. The
          establishment of the OSCORE Security Context is defined in <xref target="OSCORE" format="default" sectionFormat="of" derivedContent="Section 6.2"/>. Then, the EAP authenticator sends the POST
          message protected with OSCORE for key confirmation, including the EAP
          Success. The EAP authenticator <bcp14>MAY</bcp14> also send a
          Session-Lifetime, in seconds, which is represented by an unsigned
          integer in a CBOR Object (see <xref target="cbor-coap-eap" format="default" sectionFormat="of" derivedContent="Section 5"/>). If
          this Session-Lifetime is not sent, the EAP peer assumes a default
          value of 8 hours, as <bcp14>RECOMMENDED</bcp14> in <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>. The reception of the OSCORE-protected POST
          message is considered by the EAP peer as an alternate indication of
          success <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>. The EAP peer state machine in
          the EAP peer interprets the alternate indication of success
          (similarly to the arrival of an EAP Success) and returns the MSK,
          which is used to create the OSCORE Security Context in the EAP peer
          to process the protected POST message received from the EAP
          authenticator.</li>
          <li pn="section-3.2-7.5">Step 8. If the EAP authentication and the verification of the
          OSCORE-protected POST (Step 7) are successful, then the EAP peer
          answers with an OSCORE-protected '2.04 Changed'.  From this point
          on, communication with the last resource (e.g., "/a/eap/(n)")
          <bcp14>MUST</bcp14> be protected with OSCORE.  If allowed by
          application policy, the same OSCORE Security Context
          <bcp14>MAY</bcp14> be used to protect communication to other
          resources between the same endpoints.</li>
        </ul>
        <figure anchor="figure3" align="left" suppress-title="false" pn="figure-3">
          <name slugifiedName="name-coap-eap-flow-of-operation-">CoAP-EAP Flow of Operation with OSCORE</name>
          <artset pn="section-3.2-8.1">
            <artwork type="svg" align="center" pn="section-3.2-8.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="592" width="464" viewBox="0 0 464 592" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 16,512 L 16,528" fill="none" stroke="black"/>
                <path d="M 64,56 L 64,304" fill="none" stroke="black"/>
                <path d="M 64,336 L 64,560" fill="none" stroke="black"/>
                <path d="M 400,56 L 400,304" fill="none" stroke="black"/>
                <path d="M 400,336 L 400,560" fill="none" stroke="black"/>
                <path d="M 432,448 L 432,464" fill="none" stroke="black"/>
                <path d="M 24,48 L 120,48" fill="none" stroke="black"/>
                <path d="M 344,48 L 432,48" fill="none" stroke="black"/>
                <path d="M 72,112 L 392,112" fill="none" stroke="black"/>
                <path d="M 72,160 L 392,160" fill="none" stroke="black"/>
                <path d="M 72,208 L 392,208" fill="none" stroke="black"/>
                <path d="M 72,256 L 392,256" fill="none" stroke="black"/>
                <path d="M 72,304 L 392,304" fill="none" stroke="black"/>
                <path d="M 72,368 L 392,368" fill="none" stroke="black"/>
                <path d="M 72,416 L 392,416" fill="none" stroke="black"/>
                <path d="M 72,496 L 392,496" fill="none" stroke="black"/>
                <path d="M 72,560 L 392,560" fill="none" stroke="black"/>
                <polygon class="arrowhead" points="440,464 428,458.4 428,469.6" fill="black" transform="rotate(90,432,464)"/>
                <polygon class="arrowhead" points="400,560 388,554.4 388,565.6" fill="black" transform="rotate(0,392,560)"/>
                <polygon class="arrowhead" points="400,416 388,410.4 388,421.6" fill="black" transform="rotate(0,392,416)"/>
                <polygon class="arrowhead" points="400,304 388,298.4 388,309.6" fill="black" transform="rotate(0,392,304)"/>
                <polygon class="arrowhead" points="400,208 388,202.4 388,213.6" fill="black" transform="rotate(0,392,208)"/>
                <polygon class="arrowhead" points="400,112 388,106.4 388,117.6" fill="black" transform="rotate(0,392,112)"/>
                <polygon class="arrowhead" points="80,496 68,490.4 68,501.6" fill="black" transform="rotate(180,72,496)"/>
                <polygon class="arrowhead" points="80,368 68,362.4 68,373.6" fill="black" transform="rotate(180,72,368)"/>
                <polygon class="arrowhead" points="80,256 68,250.4 68,261.6" fill="black" transform="rotate(180,72,256)"/>
                <polygon class="arrowhead" points="80,160 68,154.4 68,165.6" fill="black" transform="rotate(180,72,160)"/>
                <polygon class="arrowhead" points="24,528 12,522.4 12,533.6" fill="black" transform="rotate(90,16,528)"/>
                <g class="text">
                  <text x="48" y="36">EAP</text>
                  <text x="84" y="36">peer</text>
                  <text x="336" y="36">EAP</text>
                  <text x="408" y="36">authenticator</text>
                  <text x="100" y="68">POST</text>
                  <text x="208" y="68">/.well-known/coap-eap</text>
                  <text x="52" y="84">0)</text>
                  <text x="128" y="84">No-Response</text>
                  <text x="160" y="100">Payload("/a/eap/1")</text>
                  <text x="300" y="132">POST</text>
                  <text x="356" y="132">/a/eap/1</text>
                  <text x="260" y="148">Payload(EAP-Req/Id||CS-C||RID-C)</text>
                  <text x="52" y="164">1)</text>
                  <text x="92" y="180">2.01</text>
                  <text x="144" y="180">Created</text>
                  <text x="232" y="180">Location-Path</text>
                  <text x="332" y="180">[/a/eap/2]</text>
                  <text x="208" y="196">Payload(EAP-Resp/Id||CS-I||RID-I)</text>
                  <text x="52" y="212">2)</text>
                  <text x="300" y="228">POST</text>
                  <text x="356" y="228">/a/eap/2</text>
                  <text x="308" y="244">Payload(EAP-X-Req)</text>
                  <text x="52" y="260">3)</text>
                  <text x="92" y="276">2.01</text>
                  <text x="144" y="276">Created</text>
                  <text x="232" y="276">Location-Path</text>
                  <text x="332" y="276">[/a/eap/3]</text>
                  <text x="152" y="292">Payload(EAP-X-Resp)</text>
                  <text x="52" y="308">4)</text>
                  <text x="236" y="324">....</text>
                  <text x="252" y="340">POST</text>
                  <text x="324" y="340">/a/eap/(n-1)</text>
                  <text x="308" y="356">Payload(EAP-X-Req)</text>
                  <text x="52" y="372">5)</text>
                  <text x="92" y="388">2.01</text>
                  <text x="144" y="388">Created</text>
                  <text x="232" y="388">Location-Path</text>
                  <text x="340" y="388">[/a/eap/(n)]</text>
                  <text x="152" y="404">Payload(EAP-X-Resp)</text>
                  <text x="52" y="420">6)</text>
                  <text x="432" y="436">MSK</text>
                  <text x="284" y="452">POST</text>
                  <text x="348" y="452">/a/eap/(n)</text>
                  <text x="364" y="468">OSCORE</text>
                  <text x="128" y="484">Payload(EAP</text>
                  <text x="288" y="484">Success||*Session-Lifetime)</text>
                  <text x="436" y="484">OSCORE</text>
                  <text x="16" y="500">MSK</text>
                  <text x="52" y="500">7)</text>
                  <text x="432" y="500">CTX</text>
                  <text x="92" y="532">2.04</text>
                  <text x="144" y="532">Changed</text>
                  <text x="28" y="548">OSCORE</text>
                  <text x="100" y="548">OSCORE</text>
                  <text x="16" y="564">CTX</text>
                  <text x="52" y="564">8)</text>
                  <text x="168" y="580">*Session-Lifetime</text>
                  <text x="252" y="580">is</text>
                  <text x="300" y="580">optional</text>
                </g>
              </svg>
            </artwork>
            <artwork type="ascii-art" align="center" pn="section-3.2-8.1.2">
    EAP peer                            EAP authenticator
  -------------                           ------------
        |  POST /.well-known/coap-eap             |
      0)|  No-Response                            |
        |  Payload("/a/eap/1")                    |
        |----------------------------------------&gt;|
        |                           POST /a/eap/1 |
        |        Payload(EAP-Req/Id||CS-C||RID-C) |
      1)|&lt;----------------------------------------|
        | 2.01 Created Location-Path [/a/eap/2]   |
        | Payload(EAP-Resp/Id||CS-I||RID-I)       |
      2)|----------------------------------------&gt;|
        |                           POST /a/eap/2 |
        |                     Payload(EAP-X-Req)  |
      3)|&lt;----------------------------------------|
        | 2.01 Created Location-Path [/a/eap/3]   |
        | Payload(EAP-X-Resp)                     |
      4)|----------------------------------------&gt;|
                            ....
        |                     POST /a/eap/(n-1)   |
        |                     Payload(EAP-X-Req)  |
      5)|&lt;----------------------------------------|
        | 2.01 Created Location-Path [/a/eap/(n)] |
        | Payload(EAP-X-Resp)                     |
      6)|----------------------------------------&gt;|
        |                                         |  MSK
        |                         POST /a/eap/(n) |   |
        |                                  OSCORE |   v
        |  Payload(EAP Success||*Session-Lifetime)| OSCORE
 MSK  7)|&lt;----------------------------------------|  CTX
  |     |                                         |
  v     | 2.04 Changed                            |
OSCORE  | OSCORE                                  |
 CTX  8)|----------------------------------------&gt;|
            *Session-Lifetime is optional
</artwork>
          </artset>
        </figure>
      </section>
      <section anchor="re-authentication" numbered="true" removeInRFC="false" toc="include" pn="section-3.3">
        <name slugifiedName="name-re-authentication">Re-Authentication</name>
        <t indent="0" pn="section-3.3-1">When the CoAP-EAP state is close to expiring, the EAP peer may want to start a new authentication process (re-authentication) to renew the state. The main goal is to obtain new and fresh keying material (MSK/EMSK) that, in turn, allows deriving a new OSCORE Security Context, increasing the protection against key leakage. The keying material <bcp14>MUST</bcp14> be renewed before the expiration of the Session-Lifetime. By default, the EAP key management framework <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/> establishes a default value of 8 hours to refresh the keying material. Certain EAP methods such as
Nimble Out-of-Band Authentication for EAP (EAP-NOOB) <xref target="RFC9140" format="default" sectionFormat="of" derivedContent="RFC9140"/> or EAP-AKA' <xref target="RFC5448" format="default" sectionFormat="of" derivedContent="RFC5448"/> provide fast reconnect for quicker re-authentication. The EAP Re-authentication Protocol (ERP) <xref target="RFC6696" format="default" sectionFormat="of" derivedContent="RFC6696"/> <bcp14>MAY</bcp14> also be used to avoid the repetition of the entire EAP exchange.</t>
        <t indent="0" pn="section-3.3-2">The re-authentication message flow will be the same as that shown in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>. Nevertheless, two different CoAP-EAP states will be active during the re-authentication: the current CoAP-EAP state and the new CoAP-EAP state, which will be created once the re-authentication has finished successfully. Once the re-authentication is completed successfully, the current CoAP-EAP state is deleted and replaced by the new CoAP-EAP state. If for any reason the re-authentication fails, the current CoAP-EAP state will be available until it expires, or it will be renewed during a subsequent re-authentication attempt.</t>
        <t indent="0" pn="section-3.3-3">If the re-authentication fails, it is up to the EAP peer to decide when to start a new re-authentication before the current EAP state expires.</t>
      </section>
      <section anchor="managing_boot_state" numbered="true" removeInRFC="false" toc="include" pn="section-3.4">
        <name slugifiedName="name-managing-the-state-of-the-s">Managing the State of the Service</name>
        <t indent="0" pn="section-3.4-1">The EAP peer and the EAP authenticator keep state during the CoAP-EAP negotiation. The CoAP-EAP state includes several important parts:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3.4-2">
          <li pn="section-3.4-2.1">
            <t indent="0" pn="section-3.4-2.1.1">A reference to an instance of the EAP (peer or authenticator/server) state machine.</t>
          </li>
          <li pn="section-3.4-2.2">
            <t indent="0" pn="section-3.4-2.2.1">The resource for the next message in the negotiation (e.g., "/a/eap/2").</t>
          </li>
          <li pn="section-3.4-2.3">
            <t indent="0" pn="section-3.4-2.3.1">The MSK, which is exported when the EAP authentication is successful. CoAP-EAP can access the different variables via the EAP state machine (see <xref target="RFC4137" format="default" sectionFormat="of" derivedContent="RFC4137"/>).</t>
          </li>
          <li pn="section-3.4-2.4">
            <t indent="0" pn="section-3.4-2.4.1">A reference to the OSCORE context.</t>
          </li>
        </ul>
        <t indent="0" pn="section-3.4-3">Once created, the EAP authenticator <bcp14>MAY</bcp14> choose to delete the state as described in <xref target="figure4" format="default" sectionFormat="of" derivedContent="Figure 4"/>. Conversely, the EAP peer may need to renew the CoAP-EAP state because the key material is close to expiring, as mentioned in <xref target="re-authentication" format="default" sectionFormat="of" derivedContent="Section 3.3"/>.</t>
        <t indent="0" pn="section-3.4-4">There are situations where the current CoAP-EAP state might need to be removed. For instance, due to its expiration or forced removal, the EAP peer has to be expelled from the security domain. Such an exchange is illustrated in <xref target="figure4" format="default" sectionFormat="of" derivedContent="Figure 4"/>.</t>
        <t indent="0" pn="section-3.4-5">If the EAP authenticator deems it necessary to remove the CoAP-EAP state from the EAP peer before it expires, it can send a DELETE command in a request to the EAP peer, referencing the last CoAP-EAP state resource given by the CoAP server, whose identifier will be the last one received (e.g., "/a/eap/(n)" in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>). This message is protected by the OSCORE security association to prevent forgery. Upon reception of this message, the CoAP server sends a response to the EAP authenticator with the code '2.02 Deleted', which is also protected by the OSCORE security association. If a response from the EAP peer does not arrive after EXCHANGE_LIFETIME, the EAP authenticator will remove the state.</t>
        <figure anchor="figure4" align="left" suppress-title="false" pn="figure-4">
          <name slugifiedName="name-deleting-state">Deleting State</name>
          <artset pn="section-3.4-6.1">
            <artwork type="svg" align="center" pn="section-3.4-6.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="432" viewBox="0 0 432 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 56,56 L 56,176" fill="none" stroke="black"/>
                <path d="M 376,56 L 376,176" fill="none" stroke="black"/>
                <path d="M 8,48 L 104,48" fill="none" stroke="black"/>
                <path d="M 312,48 L 408,48" fill="none" stroke="black"/>
                <path d="M 64,112 L 368,112" fill="none" stroke="black"/>
                <path d="M 64,176 L 368,176" fill="none" stroke="black"/>
                <polygon class="arrowhead" points="376,176 364,170.4 364,181.6" fill="black" transform="rotate(0,368,176)"/>
                <polygon class="arrowhead" points="72,112 60,106.4 60,117.6" fill="black" transform="rotate(180,64,112)"/>
                <g class="text">
                  <text x="32" y="36">EAP</text>
                  <text x="68" y="36">peer</text>
                  <text x="304" y="36">EAP</text>
                  <text x="376" y="36">authenticator</text>
                  <text x="252" y="84">DELETE</text>
                  <text x="324" y="84">/a/eap/(n)</text>
                  <text x="340" y="100">OSCORE</text>
                  <text x="84" y="148">2.02</text>
                  <text x="136" y="148">Deleted</text>
                  <text x="92" y="164">OSCORE</text>
                </g>
              </svg>
            </artwork>
            <artwork type="ascii-art" align="center" pn="section-3.4-6.1.2">
  EAP peer                          EAP authenticator
-------------                         -------------
      |                                       |
      |                     DELETE /a/eap/(n) |
      |                                OSCORE |
      |&lt;--------------------------------------|
      |                                       |
      | 2.02 Deleted                          |
      | OSCORE                                |
      |--------------------------------------&gt;|
</artwork>
          </artset>
        </figure>
      </section>
      <section anchor="error-handling" numbered="true" removeInRFC="false" toc="include" pn="section-3.5">
        <name slugifiedName="name-error-handling">Error Handling</name>
        <t indent="0" pn="section-3.5-1">This section elaborates on how different errors are handled: EAP authentication failure (<xref target="eap-authentication-failure" format="default" sectionFormat="of" derivedContent="Section 3.5.1"/>), a non-responsive endpoint (<xref target="non-responsive-endpoint" format="default" sectionFormat="of" derivedContent="Section 3.5.2"/>), and duplicated messages (<xref target="duplicated-message-with-well-knowncoap-eap" format="default" sectionFormat="of" derivedContent="Section 3.5.3"/>).</t>
        <section anchor="eap-authentication-failure" numbered="true" removeInRFC="false" toc="include" pn="section-3.5.1">
          <name slugifiedName="name-eap-authentication-failure">EAP Authentication Failure</name>
          <t indent="0" pn="section-3.5.1-1">The EAP authentication may fail in different situations (e.g., wrong credentials). The result is that the EAP authenticator will send an EAP Failure message because of a failed EAP authentication (Step 7 in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>). In this case, the EAP peer <bcp14>MUST</bcp14> send a response '4.01 Unauthorized' in Step 8. Therefore, Steps 7 and 8 are not protected in this case because no MSK is exported and the OSCORE Security Context is not yet generated.</t>
          <t indent="0" pn="section-3.5.1-2">If the EAP authentication fails during the re-authentication and the EAP authenticator sends an EAP Failure, the current CoAP-EAP state will still be usable until it expires.</t>
        </section>
        <section anchor="non-responsive-endpoint" numbered="true" removeInRFC="false" toc="include" pn="section-3.5.2">
          <name slugifiedName="name-non-responsive-endpoint">Non-Responsive Endpoint</name>
          <t indent="0" pn="section-3.5.2-1">If for any reason one of the entities becomes non-responsive, the CoAP-EAP state <bcp14>SHOULD</bcp14> be removed after a stipulated amount of time. The amount of time can be adjusted according to the policies established by the application or use case where CoAP-EAP is used. As a default value, the CoAP EXCHANGE_LIFETIME parameter, as defined in CoAP <xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/>, will be used.</t>
          <t indent="0" pn="section-3.5.2-2">The removal of the CoAP-EAP state in the EAP authenticator assumes that the EAP peer will need to authenticate again.</t>
          <t indent="0" pn="section-3.5.2-3">According to CoAP, EXCHANGE_LIFETIME considers the time it takes until a client stops expecting a response to a request. A timer is reset every time a message is sent.
By default, CoAP-EAP adopts the value of EXCHANGE_LIFETIME as a timer in the EAP peer and authenticator to remove the CoAP-EAP state if the authentication process has not progressed to completion during that time.</t>
          <t indent="0" pn="section-3.5.2-4">The EAP peer will remove the CoAP-EAP state if either the EXCHANGE_LIFETIME is triggered or the EAP peer state machine returns an eapFail.</t>
          <t indent="0" pn="section-3.5.2-5">The EAP authenticator will remove the CoAP-EAP state if either the EXCHANGE_LIFETIME is triggered or, when the EAP authenticator is operating in pass-through mode (i.e., the EAP authentication is performed against a AAA server), the EAP authenticator state machine returns "aaaTimeout" <xref target="RFC4137" format="default" sectionFormat="of" derivedContent="RFC4137"/>.</t>
        </section>
        <section anchor="duplicated-message-with-well-knowncoap-eap" numbered="true" removeInRFC="false" toc="include" pn="section-3.5.3">
          <name slugifiedName="name-duplicated-message-with-wel">Duplicated Message with /.well-known/coap-eap</name>
          <t indent="0" pn="section-3.5.3-1">The reception of the trigger message (Step 0 in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>) containing the URI /coap-eap needs some additional considerations, as the resource is always available in the EAP authenticator.</t>
          <t indent="0" pn="section-3.5.3-2">If a trigger message arrives at the EAP authenticator during an ongoing authentication with the same EAP peer, the EAP authenticator <bcp14>MUST</bcp14> silently discard this trigger message.</t>
          <t indent="0" pn="section-3.5.3-3">If an old "POST /.well-known/coap-eap" (Step 0 in <xref target="figure5" format="default" sectionFormat="of" derivedContent="Figure 5"/>) arrives at the EAP authenticator and there is no authentication ongoing, the EAP authenticator may understand that a new authentication process is requested. Consequently, the EAP authenticator will start a new EAP authentication. However, if the EAP peer did not start any authentication, it will send a '4.04 Not Found' in the response (<xref target="figure5" format="default" sectionFormat="of" derivedContent="Figure 5"/>).</t>
          <figure anchor="figure5" align="left" suppress-title="false" pn="figure-5">
            <name slugifiedName="name-well-known-coap-eap-with-no">/.well-known/coap-eap with No Ongoing Authentication from the EAP Authenticator</name>
            <artset pn="section-3.5.3-4.1">
              <artwork type="svg" align="center" pn="section-3.5.3-4.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="432" viewBox="0 0 432 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 32,56 L 32,208" fill="none" stroke="black"/>
                  <path d="M 368,56 L 368,208" fill="none" stroke="black"/>
                  <path d="M 8,48 L 80,48" fill="none" stroke="black"/>
                  <path d="M 328,48 L 400,48" fill="none" stroke="black"/>
                  <path d="M 160,112 L 360,112" fill="none" stroke="black"/>
                  <path d="M 40,160 L 360,160" fill="none" stroke="black"/>
                  <path d="M 40,208 L 360,208" fill="none" stroke="black"/>
                  <polygon class="arrowhead" points="368,208 356,202.4 356,213.6" fill="black" transform="rotate(0,360,208)"/>
                  <polygon class="arrowhead" points="368,112 356,106.4 356,117.6" fill="black" transform="rotate(0,360,112)"/>
                  <polygon class="arrowhead" points="48,160 36,154.4 36,165.6" fill="black" transform="rotate(180,40,160)"/>
                  <g class="text">
                    <text x="16" y="36">EAP</text>
                    <text x="52" y="36">peer</text>
                    <text x="304" y="36">EAP</text>
                    <text x="376" y="36">authenticator</text>
                    <text x="72" y="68">*POST</text>
                    <text x="184" y="68">/.well-known/coap-eap</text>
                    <text x="20" y="84">0)</text>
                    <text x="96" y="84">No-Response</text>
                    <text x="128" y="100">Payload("/a/eap/1")</text>
                    <text x="260" y="132">POST</text>
                    <text x="316" y="132">/a/eap/1</text>
                    <text x="248" y="148">Payload(EAP-Req/Id||CS-C)</text>
                    <text x="20" y="164">1)</text>
                    <text x="60" y="196">4.04</text>
                    <text x="96" y="196">Not</text>
                    <text x="136" y="196">found</text>
                    <text x="196" y="228">*Old</text>
                  </g>
                </svg>
              </artwork>
              <artwork type="ascii-art" align="center" pn="section-3.5.3-4.1.2">
  EAP peer                            EAP authenticator
  ----------                              ----------
    |  *POST /.well-known/coap-eap            |
  0)|  No-Response                            |
    |  Payload("/a/eap/1")                    |
    |               -------------------------&gt;|
    |                          POST /a/eap/1  |
    |              Payload(EAP-Req/Id||CS-C)  |
  1)|&lt;----------------------------------------|
    |                                         |
    | 4.04 Not Found                          |
    |----------------------------------------&gt;|
                        *Old
</artwork>
            </artset>
          </figure>
        </section>
      </section>
      <section anchor="proxy" numbered="true" removeInRFC="false" toc="include" pn="section-3.6">
        <name slugifiedName="name-proxy-operation-in-coap-eap">Proxy Operation in CoAP-EAP</name>
        <t indent="0" pn="section-3.6-1">The CoAP-EAP operation is intended to be compatible with the use of intermediary entities between the EAP peer and the EAP authenticator when direct communication is not possible. In this context, CoAP proxies can be used as enablers of the CoAP-EAP exchange.</t>
        <t indent="0" pn="section-3.6-2">This specification is limited to using standard CoAP <xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/> as well as standardized CoAP options <xref target="RFC8613" format="default" sectionFormat="of" derivedContent="RFC8613"/>. It does not specify any addition in the form of CoAP options. This is expected to ease the integration of CoAP intermediaries in the CoAP-EAP exchange.</t>
        <t indent="0" pn="section-3.6-3">When using proxies in the CoAP-EAP exchange, it should be considered that the exchange contains a role-reversal process at the beginning of the exchange. In the first message, the EAP peer acts as a CoAP client and the EAP authenticator acts as the CoAP server. In the remaining exchanges, the roles are reversed (i.e., the EAP
peer acts as the CoAP server, and the EAP authenticator acts as the CoAP client).
When using a proxy in the exchange, for message 0 it will act as a forward proxy, and as a reverse proxy for the rest. Additionally, in the first exchange, the EAP peer, as a CoAP client, sends the URI for the next CoAP message in the payload of a request. This is not the typical behavior, as URIs referring to new services/resources appear in Location-Path and/or Location-Query Options in CoAP responses. Hence, the proxy will have to treat the payload of Message 0 as if it were a Location-Path Option of a CoAP response.</t>
      </section>
    </section>
    <section anchor="coap-eap-media-type" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-coap-eap-media-type-format">CoAP-EAP Media Type Format</name>
      <t indent="0" pn="section-4-1">In the CoAP-EAP exchange, the format specified by the "application/coap-eap" media type will be used. See <xref target="mediatypes" format="default" sectionFormat="of" derivedContent="Section 9.5"/>.</t>
      <t indent="0" pn="section-4-2">In CoAP-EAP, there are two different elements that can be sent over the payload. The first one is a relative URI. This payload will be present for the first message (0) in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>.</t>
      <t indent="0" pn="section-4-3">In all the other cases, an EAP message will be followed by the CBOR Object specified in <xref target="cbor-coap-eap" format="default" sectionFormat="of" derivedContent="Section 5"/>. A visual example of the second case can be found in <xref target="figure7" format="default" sectionFormat="of" derivedContent="Figure 7"/> (<xref target="crypto-negotiation" format="default" sectionFormat="of" derivedContent="Section 6.1"/>).</t>
    </section>
    <section anchor="cbor-coap-eap" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-cbor-objects-in-coap-eap">CBOR Objects in CoAP-EAP</name>
      <t indent="0" pn="section-5-1">In the CoAP-EAP exchange, information needs to be exchanged between the two entities -- for example, the cipher suites that need to be negotiated, or authorization information (Session-Lifetime). There may also be a need to extend the information that has to be exchanged in the future. This section specifies the CBOR data structure <xref target="RFC8949" format="default" sectionFormat="of" derivedContent="RFC8949"/> to exchange information between the EAP peer and the EAP authenticator in the CoAP payload.</t>
      <t indent="0" pn="section-5-2"><xref target="figure6" format="default" sectionFormat="of" derivedContent="Figure 6"/> shows the specification of the CBOR Object to exchange information in CoAP-EAP.</t>
      <figure anchor="figure6" align="left" suppress-title="false" pn="figure-6">
        <name slugifiedName="name-cbor-data-structure-for-coa">CBOR Data Structure for CoAP-EAP</name>
        <artwork align="center" pn="section-5-3.1">
   CoAP-EAP_Info = {
      ?  1 : [+ int],     ; Cipher Suite (CS-C or CS-I)
      ?  2 : bstr,        ; RID-C
      ?  3 : bstr,        ; RID-I
      ?  4 : uint         ; Session-Lifetime
  }
</artwork>
      </figure>
      <t indent="0" pn="section-5-4">The parameters contain the following information:</t>
      <ol spacing="normal" indent="adaptive" start="1" type="1" pn="section-5-5">
        <li pn="section-5-5.1" derivedCounter="1.">Cipher Suite: An array with the list of proposed, or selected,
        CBOR Object Signing and Encryption (COSE) algorithms for OSCORE. If the
field is carried over a request,
        a proposed cipher suite is indicated; if it is carried over a
        response, it corresponds to the agreed-upon cipher suite.</li>
        <li pn="section-5-5.2" derivedCounter="2.">RID-C: The Recipient ID of the EAP authenticator. The EAP peer
        uses this value as the Sender ID for its OSCORE Sender Context. The EAP
        authenticator uses this value as the Recipient ID for its Recipient
        Context.</li>
        <li pn="section-5-5.3" derivedCounter="3.">RID-I: The Recipient ID of the EAP peer. The EAP authenticator
        uses this value as the Sender ID for its OSCORE Sender Context. The EAP
        peer uses this value as the Recipient ID for its Recipient Context.</li>
        <li pn="section-5-5.4" derivedCounter="4.">Session-Lifetime: The time that the session is valid, in seconds.</li>
      </ol>
      <t indent="0" pn="section-5-6">Other indexes can be used to carry additional values as needed, like specific authorization parameters.</t>
      <t indent="0" pn="section-5-7">The indexes from 65001 to 65535 are reserved for experimentation.</t>
    </section>
    <section anchor="key_deriv" numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-cipher-suite-negotiation-an">Cipher Suite Negotiation and Key Derivation</name>
      <section anchor="crypto-negotiation" numbered="true" removeInRFC="false" toc="include" pn="section-6.1">
        <name slugifiedName="name-cipher-suite-negotiation">Cipher Suite Negotiation</name>
        <t indent="0" pn="section-6.1-1">OSCORE runs after the EAP authentication, using the cipher suite selected in the cipher suite negotiation (Steps 1 and 2 in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>). To negotiate the cipher suite, CoAP-EAP follows a simple approach: The EAP authenticator sends a list, in decreasing order of preference, with the identifiers of the supported cipher suites (Step 1 in <xref target="figure8" format="default" sectionFormat="of" derivedContent="Figure 8"/>). In the response to that message (Step 2 in <xref target="figure8" format="default" sectionFormat="of" derivedContent="Figure 8"/>), the EAP peer sends its choice.</t>
        <t indent="0" pn="section-6.1-2">This list is included in the payload after the EAP message through a CBOR array. An example of how the fields are arranged in the CoAP payload can be seen in <xref target="figure7" format="default" sectionFormat="of" derivedContent="Figure 7"/>. An example exchange for the cipher suite negotiation is shown in <xref target="figure8" format="default" sectionFormat="of" derivedContent="Figure 8"/>. The EAP Request (EAP-Req/Id) and EAP Response (EAP-Resp/Id) are sent; both messages include the CBOR Object (<xref target="cbor-coap-eap" format="default" sectionFormat="of" derivedContent="Section 5"/>) containing the cipher suite field for the cipher suite negotiation.</t>
        <figure anchor="figure7" align="left" suppress-title="false" pn="figure-7">
          <name slugifiedName="name-cipher-suites-in-the-coap-p">Cipher Suites in the CoAP Payload</name>
          <artset pn="section-6.1-3.1">
            <artwork type="svg" align="center" pn="section-6.1-3.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="448" viewBox="0 0 448 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"/>
                <path d="M 64,32 L 64,64" fill="none" stroke="black"/>
                <path d="M 168,32 L 168,64" fill="none" stroke="black"/>
                <path d="M 240,32 L 240,64" fill="none" stroke="black"/>
                <path d="M 296,32 L 296,64" fill="none" stroke="black"/>
                <path d="M 440,32 L 440,64" fill="none" stroke="black"/>
                <path d="M 8,32 L 440,32" fill="none" stroke="black"/>
                <path d="M 8,64 L 440,64" fill="none" stroke="black"/>
                <path d="M 8,96 L 88,96" fill="none" stroke="black"/>
                <path d="M 208,96 L 288,96" fill="none" stroke="black"/>
                <path d="M 304,96 L 320,96" fill="none" stroke="black"/>
                <path d="M 424,96 L 440,96" fill="none" stroke="black"/>
                <polygon class="arrowhead" points="448,96 436,90.4 436,101.6" fill="black" transform="rotate(0,440,96)"/>
                <polygon class="arrowhead" points="312,96 300,90.4 300,101.6" fill="black" transform="rotate(180,304,96)"/>
                <polygon class="arrowhead" points="296,96 284,90.4 284,101.6" fill="black" transform="rotate(0,288,96)"/>
                <polygon class="arrowhead" points="16,96 4,90.4 4,101.6" fill="black" transform="rotate(180,8,96)"/>
                <g class="text">
                  <text x="36" y="52">Code</text>
                  <text x="116" y="52">Identifier</text>
                  <text x="204" y="52">Length</text>
                  <text x="268" y="52">Data</text>
                  <text x="340" y="52">cipher</text>
                  <text x="404" y="52">suites</text>
                  <text x="120" y="100">EAP</text>
                  <text x="164" y="100">Packet</text>
                  <text x="348" y="100">CBOR</text>
                  <text x="392" y="100">array</text>
                </g>
              </svg>
            </artwork>
            <artwork type="ascii-art" align="center" pn="section-6.1-3.1.2">
+------+------------+--------+------+-----------------+
| Code | Identifier | Length | Data |  cipher  suites |
+------+------------+--------+------+-----------------+

&lt;----------  EAP Packet  ----------&gt; &lt;-- CBOR array --&gt;
</artwork>
          </artset>
        </figure>
        <figure anchor="figure8" align="left" suppress-title="false" pn="figure-8">
          <name slugifiedName="name-cipher-suite-negotiation-2">Cipher Suite Negotiation</name>
          <artset pn="section-6.1-4.1">
            <artwork type="svg" align="center" pn="section-6.1-4.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="424" viewBox="0 0 424 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 32,72 L 32,208" fill="none" stroke="black"/>
                <path d="M 368,72 L 368,208" fill="none" stroke="black"/>
                <path d="M 8,64 L 104,64" fill="none" stroke="black"/>
                <path d="M 320,64 L 416,64" fill="none" stroke="black"/>
                <path d="M 40,112 L 360,112" fill="none" stroke="black"/>
                <path d="M 40,160 L 360,160" fill="none" stroke="black"/>
                <path d="M 40,208 L 360,208" fill="none" stroke="black"/>
                <polygon class="arrowhead" points="368,208 356,202.4 356,213.6" fill="black" transform="rotate(0,360,208)"/>
                <polygon class="arrowhead" points="368,112 356,106.4 356,117.6" fill="black" transform="rotate(0,360,112)"/>
                <polygon class="arrowhead" points="48,160 36,154.4 36,165.6" fill="black" transform="rotate(180,40,160)"/>
                <g class="text">
                  <text x="24" y="36">EAP</text>
                  <text x="60" y="36">peer</text>
                  <text x="328" y="36">EAP</text>
                  <text x="368" y="36">Auth.</text>
                  <text x="24" y="52">(CoAP</text>
                  <text x="80" y="52">server)</text>
                  <text x="336" y="52">(CoAP</text>
                  <text x="392" y="52">client)</text>
                  <text x="168" y="100">...</text>
                  <text x="260" y="132">POST</text>
                  <text x="316" y="132">/a/eap/1</text>
                  <text x="128" y="148">Payload(EAP-Req/Id,</text>
                  <text x="280" y="148">CBORArray[0,1,2])</text>
                  <text x="20" y="164">1)</text>
                  <text x="60" y="180">2.01</text>
                  <text x="112" y="180">Created</text>
                  <text x="200" y="180">Location-Path</text>
                  <text x="300" y="180">[/a/eap/2]</text>
                  <text x="124" y="196">Payload(EAP-Resp/Id,</text>
                  <text x="264" y="196">CBORArray[0])</text>
                  <text x="20" y="212">2)</text>
                  <text x="200" y="228">...</text>
                </g>
              </svg>
            </artwork>
            <artwork type="ascii-art" align="center" pn="section-6.1-4.1.2">
  EAP peer                              EAP Auth.
  (CoAP server)                          (CoAP client)
  -------------                          -------------
    |                                         |
    |               ...                       |
    |----------------------------------------&gt;|
    |                          POST /a/eap/1  |
    |  Payload(EAP-Req/Id, CBORArray[0,1,2])  |
  1)|&lt;----------------------------------------|
    | 2.01 Created Location-Path [/a/eap/2]   |
    | Payload(EAP-Resp/Id, CBORArray[0])      |
  2)|----------------------------------------&gt;|
                        ...
</artwork>
          </artset>
        </figure>
        <t indent="0" pn="section-6.1-5">If there is no CBOR array specifying the cipher suites, the default cipher suites are applied. If the EAP authenticator sends a restricted list of cipher suites that can be accepted, it <bcp14>MUST</bcp14> include the default value 0, since it is mandatory to implement. The EAP peer will have at least that option available.</t>
        <t indent="0" pn="section-6.1-6">The cipher suite requirements are inherited from those established by OSCORE <xref target="RFC8613" format="default" sectionFormat="of" derivedContent="RFC8613"/>, which are COSE algorithms <xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>. By default, the HMAC-based Extract-and-Expand Key Derivation Function (HKDF) algorithm is SHA-256 and the Authenticated Encryption with Associated Data (AEAD) algorithm is AES-CCM-16-64-128 <xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>. ("HMAC" stands for "Hashed Message Authentication Code".) Both are mandatory to implement. The other supported and negotiated cipher suites are listed below; these hash algorithms are considered in cases where the specification includes DTLS support in the future (TLS_SHA256, TLS_SHA384, TLS_SHA512; see <xref target="flow-of-operation-dtls" format="default" sectionFormat="of" derivedContent="Appendix A"/>):</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6.1-7">
          <li pn="section-6.1-7.1">
            <t indent="0" pn="section-6.1-7.1.1">0) AES-CCM-16-64-128, SHA-256 (default)</t>
          </li>
          <li pn="section-6.1-7.2">
            <t indent="0" pn="section-6.1-7.2.1">1) A128GCM, SHA-256</t>
          </li>
          <li pn="section-6.1-7.3">
            <t indent="0" pn="section-6.1-7.3.1">2) A256GCM, SHA-384</t>
          </li>
          <li pn="section-6.1-7.4">
            <t indent="0" pn="section-6.1-7.4.1">3) ChaCha20/Poly1305, SHA-256</t>
          </li>
          <li pn="section-6.1-7.5">
            <t indent="0" pn="section-6.1-7.5.1">4) ChaCha20/Poly1305, SHAKE256</t>
          </li>
        </ul>
        <t indent="0" pn="section-6.1-8">This specification uses the HKDF as defined in <xref target="RFC5869" format="default" sectionFormat="of" derivedContent="RFC5869"/> to derive the necessary key material. Since the key derivation process uses the MSK, which is considered fresh key material, the HKDF-Expand function (shortened here as "KDF") will be used. See <xref target="limit_eap_medhods" format="default" sectionFormat="of" derivedContent="Section 8.1"/> regarding why the use of this function is enough and it is not necessary to use KDF-Extract.</t>
      </section>
      <section anchor="OSCORE" numbered="true" removeInRFC="false" toc="include" pn="section-6.2">
        <name slugifiedName="name-deriving-the-oscore-securit">Deriving the OSCORE Security Context</name>
        <t indent="0" pn="section-6.2-1">The derivation of the OSCORE Security Context allows securing the communication between the EAP peer and the EAP authenticator once the MSK has been exported, providing confidentiality, integrity, key confirmation (Steps 7 and 8 in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>), and detection of downgrading attacks.</t>
        <t indent="0" pn="section-6.2-2">Once the Master Secret and Master Salt are derived, they can be used to derive the rest of the OSCORE Security Context (see <xref target="RFC8613" sectionFormat="of" section="3.2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8613#section-3.2.1" derivedContent="RFC8613"/>). It should be noted that the ID Context is not provided for the OSCORE Security Context derivation.</t>
        <t indent="0" pn="section-6.2-3">The Master Secret can be derived by using the chosen cipher suite and the KDF as follows:</t>
        <artwork align="center" pn="section-6.2-4">
Master Secret = KDF(MSK, CS | "COAP-EAP OSCORE MASTER SECRET", length)
</artwork>
        <t indent="0" pn="section-6.2-5">where:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6.2-6">
          <li pn="section-6.2-6.1">
            <t indent="0" pn="section-6.2-6.1.1">The MSK is exported by the EAP method. The use of the MSK for key derivation is discussed in <xref target="security_considerations" format="default" sectionFormat="of" derivedContent="Section 8"/>.</t>
          </li>
          <li pn="section-6.2-6.2">
            <t indent="0" pn="section-6.2-6.2.1">CS is the concatenation of the content of the cipher suite negotiation -- that is, the concatenation of two CBOR arrays CS-C and CS-I (with CBOR ints as elements), as defined in <xref target="cbor-coap-eap" format="default" sectionFormat="of" derivedContent="Section 5"/>. If neither CS-C nor CS-I was sent (i.e., default algorithms are used), the value used to generate CS will be the same as if the default algorithms were explicitly sent in CS-C or CS-I (i.e., a CBOR array with the cipher suite value of 0).</t>
          </li>
          <li pn="section-6.2-6.3">
            <t indent="0" pn="section-6.2-6.3.1">"COAP-EAP OSCORE MASTER SECRET" is the ASCII code representation of the non-NULL-terminated string (excluding the double quotes around it).</t>
          </li>
          <li pn="section-6.2-6.4">
            <t indent="0" pn="section-6.2-6.4.1">CS and "COAP-EAP OSCORE MASTER SECRET" are concatenated.</t>
          </li>
          <li pn="section-6.2-6.5">
            <t indent="0" pn="section-6.2-6.5.1">length is the size of the output key material.</t>
          </li>
        </ul>
        <t indent="0" pn="section-6.2-7">Similarly to the Master Secret, the Master Salt can be derived as follows:</t>
        <artwork align="center" pn="section-6.2-8">
Master Salt = KDF(MSK, CS | "COAP-EAP OSCORE MASTER SALT", length)
</artwork>
        <t indent="0" pn="section-6.2-9">where:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6.2-10">
          <li pn="section-6.2-10.1">
            <t indent="0" pn="section-6.2-10.1.1">The MSK is exported by the EAP method. The use of the MSK for key derivation is discussed in <xref target="security_considerations" format="default" sectionFormat="of" derivedContent="Section 8"/>.</t>
          </li>
          <li pn="section-6.2-10.2">
            <t indent="0" pn="section-6.2-10.2.1">CS is the concatenation of the content of the cipher suite negotiation -- that is, the concatenation of two CBOR arrays CS-C and CS-I (with CBOR ints as elements), as defined in <xref target="cbor-coap-eap" format="default" sectionFormat="of" derivedContent="Section 5"/>. If neither CS-C nor CS-I was sent (i.e., default algorithms are used), the value used to generate CS will be the same as if the default algorithms were explicitly sent in CS-C or CS-I (i.e., a CBOR array with the cipher suite value of 0).</t>
          </li>
          <li pn="section-6.2-10.3">
            <t indent="0" pn="section-6.2-10.3.1">"COAP-EAP OSCORE MASTER SALT" is the ASCII code representation of the non-NULL-terminated string (excluding the double quotes around it).</t>
          </li>
          <li pn="section-6.2-10.4">
            <t indent="0" pn="section-6.2-10.4.1">CS and "COAP-EAP OSCORE MASTER SALT" are concatenated.</t>
          </li>
          <li pn="section-6.2-10.5">
            <t indent="0" pn="section-6.2-10.5.1">length is the size of the output key material.</t>
          </li>
        </ul>
        <t indent="0" pn="section-6.2-11">Since the MSK is used to derive the Master Key, the correct verification of the OSCORE-protected request (Step 7) and response (Step 8) confirms that the EAP authenticator and the EAP peer have the same Master Secret, achieving key confirmation.</t>
        <t indent="0" pn="section-6.2-12">To prevent a downgrading attack, the content of the cipher suite
(referred to here as "CS") negotiation is embedded in the Master Secret derivation. If an attacker changes the value of the cipher suite negotiation, the result will be different OSCORE Security Contexts, which in turn will result in failure in Steps 7 and 8.</t>
        <t indent="0" pn="section-6.2-13">The EAP authenticator will use the Recipient ID of the EAP peer (RID-I) as the Sender ID for its OSCORE Sender Context. The EAP peer will use this value as the Recipient ID for its Recipient Context.</t>
        <t indent="0" pn="section-6.2-14">The EAP peer will use the Recipient ID of the EAP authenticator (RID-C) as the Sender ID for its OSCORE Sender Context. The EAP authenticator will use this value as the Recipient ID for its Recipient Context.</t>
      </section>
    </section>
    <section anchor="implementation_considerations" numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-discussion">Discussion</name>
      <section anchor="coap-as-eap-lower-layer" numbered="true" removeInRFC="false" toc="include" pn="section-7.1">
        <name slugifiedName="name-coap-as-the-eap-lower-layer">CoAP as the EAP Lower Layer</name>
        <t indent="0" pn="section-7.1-1">This section discusses the suitability of CoAP as the EAP lower layer and reviews the requisites imposed by EAP on any protocol transporting EAP. What EAP expects from its lower layers can be found in <xref target="RFC3748" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc3748#section-3.1" derivedContent="RFC3748"/>, which is elaborated next:</t>
        <dl spacing="normal" newline="false" indent="3" pn="section-7.1-2">
          <dt pn="section-7.1-2.1">Unreliable transport:</dt>
          <dd pn="section-7.1-2.2">EAP does not assume that lower layers are reliable, but it can benefit from a reliable lower layer. In this sense, CoAP provides a reliability mechanism (e.g., using Confirmable messages).</dd>
          <dt pn="section-7.1-2.3">Lower-layer error detection:</dt>
          <dd pn="section-7.1-2.4">EAP relies on lower-layer error detection (e.g., CRC, checksum, Message Integrity Check (MIC), etc.). For simplicity, CoAP-EAP delegates error detection to the lower layers, such as the link layer or transport layer (e.g., UDP over IPv6 or TCP).</dd>
          <dt pn="section-7.1-2.5">Lower-layer security:</dt>
          <dd pn="section-7.1-2.6">EAP does not require security services from the lower layers.</dd>
          <dt pn="section-7.1-2.7">Minimum MTU:</dt>
          <dd pn="section-7.1-2.8">Lower layers need to provide an EAP MTU size of 1020 octets or greater. CoAP assumes an upper bound of 1024 octets for its payload, which covers the EAP requirements when only the EAP message is sent in the CoAP payload. In the case of Messages 1 and 2 in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>, those messages have extra information apart from EAP. Nevertheless, the EAP-Req/Id has a fixed length of 5 bytes. Message 2, with the EAP-Resp/Id, would limit the length of the identity being used to the CoAP payload maximum size (1024) - len( CS-I || RID-I ) - EAP Response header (5 bytes), which leaves enough space for sending even lengthy identities. Nevertheless, this limitation can be overcome by using CoAP block-wise transfers <xref target="RFC7959" format="default" sectionFormat="of" derivedContent="RFC7959"/>.
Note: When EAP is proxied over a AAA framework, the Access-Request packets in RADIUS <bcp14>MUST</bcp14> contain a Framed-MTU attribute with a value of 1024 and, in
Diameter, the Framed-MTU Attribute-Value Pair (AVP) with a value of 1024. This information signals the AAA server that it should limit its responses to 1024 octets.</dd>
          <dt pn="section-7.1-2.9">Ordering guarantees:</dt>
          <dd pn="section-7.1-2.10">EAP relies on lower-layer ordering guarantees for correct operation. Regarding message ordering, every time a new message arrives at the authentication service hosted by the EAP peer, a new resource is created, and this is indicated in a '2.01 Created' response code along with the name of the new resource via Location-Path or Location-Query Options. This way, the application shows that its state has advanced.</dd>
        </dl>
        <t indent="0" pn="section-7.1-3">Although <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> states that "EAP provides its own support for duplicate elimination and retransmission," EAP is also reliant on
lower-layer ordering guarantees. In this regard, <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> talks about possible duplication and says, "Where the lower layer is reliable, it will provide the EAP layer with a non-duplicated stream of packets. However, while it is desirable that lower layers provide for non-duplication, this is not a requirement." CoAP provides a non-duplicated stream of packets and accomplishes the desirable non-duplication. In addition, <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> says that when EAP runs over a reliable lower layer "the authenticator retransmission timer <bcp14>SHOULD</bcp14> be set to an infinite value, so that retransmissions do not occur at the EAP layer."</t>
      </section>
      <section anchor="size-of-the-eap-lower-layer-vs-eap-method-size" numbered="true" removeInRFC="false" toc="include" pn="section-7.2">
        <name slugifiedName="name-size-of-the-eap-lower-layer">Size of the EAP Lower Layer vs. EAP Method Size</name>
        <t indent="0" pn="section-7.2-1">Regarding the impact that an EAP lower layer will have on the number of bytes of the whole authentication exchange, <xref target="CoAP-EAP" format="default" sectionFormat="of" derivedContent="CoAP-EAP"/> provides a comparison with another network-layer-based EAP lower layer, the Protocol for Carrying Authentication for Network Access (PANA) as defined in <xref target="RFC5191" format="default" sectionFormat="of" derivedContent="RFC5191"/>.</t>
        <t indent="0" pn="section-7.2-2">The EAP method being transported will take most of the exchange. However, the impact of the EAP lower layer cannot be ignored, especially in very constrained communication technologies such as those with limited capabilities (e.g., as can be found in IoT networks).</t>
        <t indent="0" pn="section-7.2-3">Note: To improve efficiency in environments with constrained devices and networks, the latest versions of EAP methods (e.g., EAP-AKA' <xref target="RFC5448" format="default" sectionFormat="of" derivedContent="RFC5448"/>, EAP-TLS 1.3 <xref target="RFC9190" format="default" sectionFormat="of" derivedContent="RFC9190"/>) are recommended over older versions. EAP methods more adapted for IoT networks (e.g., EAP-NOOB <xref target="RFC9140" format="default" sectionFormat="of" derivedContent="RFC9140"/>, EAP-EDHOC <xref target="I-D.ietf-emu-eap-edhoc" format="default" sectionFormat="of" derivedContent="EAP-EDHOC"/>, etc.) are also recommended.</t>
      </section>
    </section>
    <section anchor="security_considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-8-1">Security aspects to be considered include how authorization is managed, the use of the MSK as key material, and how trust in the EAP authenticator is established. Additional considerations such as EAP channel binding as per <xref target="RFC6677" format="default" sectionFormat="of" derivedContent="RFC6677"/> are also discussed here.</t>
      <section anchor="limit_eap_medhods" numbered="true" removeInRFC="false" toc="include" pn="section-8.1">
        <name slugifiedName="name-use-of-eap-methods">Use of EAP Methods</name>
        <t indent="0" pn="section-8.1-1">This document limits the use of EAP methods to those compliant with <xref target="RFC4017" format="default" sectionFormat="of" derivedContent="RFC4017"/>, yielding strong and fresh session keys such as the MSK. By this assumption, the HKDF-Expand function is used directly, as clarified in <xref target="RFC5869" format="default" sectionFormat="of" derivedContent="RFC5869"/>.</t>
      </section>
      <section anchor="authorization" numbered="true" removeInRFC="false" toc="include" pn="section-8.2">
        <name slugifiedName="name-authorization">Authorization</name>
        <t indent="0" pn="section-8.2-1">Authorization is part of bootstrapping. It serves to establish whether the EAP peer can join and the set of conditions it must adhere to. The authorization data will be gathered from the organization that is responsible for the EAP peer and sent to the EAP authenticator if a AAA infrastructure is deployed.</t>
        <t indent="0" pn="section-8.2-2">In standalone mode, the authorization information will be in the EAP authenticator. If pass-through mode is used, authorization data received from the AAA server can be delivered by the AAA protocol (e.g., RADIUS or Diameter).  Providing more fine-grained authorization data can be done by transporting the data using the Security Assertion Markup Language (SAML) in RADIUS <xref target="RFC7833" format="default" sectionFormat="of" derivedContent="RFC7833"/>.
After bootstrapping, additional authorization information may be needed to operate in the security domain. This can be taken care of by the solutions proposed in the Authentication and Authorization for Constrained Environments (ACE) WG, such as the use of OAuth <xref target="RFC9200" format="default" sectionFormat="of" derivedContent="RFC9200"/>, among other solutions, to provide ACE.</t>
      </section>
      <section anchor="allowing-coap-eap-traffic-to-perform-authentication" numbered="true" removeInRFC="false" toc="include" pn="section-8.3">
        <name slugifiedName="name-allowing-coap-eap-traffic-t">Allowing CoAP-EAP Traffic to Perform Authentication</name>
        <t indent="0" pn="section-8.3-1">Since CoAP is an application protocol, CoAP-EAP assumes certain IP connectivity in the link between the EAP peer and the EAP authenticator to run. This link <bcp14>MUST</bcp14> only authorize unprotected IP traffic to be sent between the EAP peer and the EAP authenticator during the authentication with CoAP-EAP. Once the authentication is successful, the key material generated by the EAP authentication (MSK) and any other traffic can be authorized if it is protected. It is worth noting that if the EAP authenticator is not in the same link as the EAP peer and an intermediate entity (e.g., a CoAP proxy) helps with this process, this
concept also applies to the communication between the EAP peer and the intermediary.</t>
        <t indent="0" pn="section-8.3-2">Alternatively, the link layer <bcp14>MAY</bcp14> provide support to transport CoAP-EAP without an IP address by using link-layer frames (e.g., by defining a new Key Management Protocol ID per IEEE 802.15.9 <xref target="IEEE802159" format="default" sectionFormat="of" derivedContent="IEEE802159"/>).</t>
      </section>
      <section anchor="freshness-of-the-key-material" numbered="true" removeInRFC="false" toc="include" pn="section-8.4">
        <name slugifiedName="name-freshness-of-the-key-materi">Freshness of the Key Material</name>
        <t indent="0" pn="section-8.4-1">In CoAP-EAP, there is no nonce exchange to provide freshness to the keys derived from the MSK. The MSKs and EMSKs are fresh key material per <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>. Since only one authentication is established per EAP authenticator, there is no need to generate additional key material. If a new MSK is required, a re-authentication can be done by running the process again or using a more lightweight EAP method to derive additional key material as elaborated in <xref target="re-authentication" format="default" sectionFormat="of" derivedContent="Section 3.3"/>.</t>
      </section>
      <section anchor="channel-binding-support" numbered="true" removeInRFC="false" toc="include" pn="section-8.5">
        <name slugifiedName="name-channel-binding-support">Channel-Binding Support</name>
        <t indent="0" pn="section-8.5-1">According to <xref target="RFC6677" format="default" sectionFormat="of" derivedContent="RFC6677"/>, channel binding, as related to EAP, is sent through the EAP method supporting it.</t>
        <t indent="0" pn="section-8.5-2">To satisfy the requirements of this document, the EAP lower-layer identifier for CoAP-EAP (10, as assigned by IANA; see <xref target="lowerlayer" format="default" sectionFormat="of" derivedContent="Section 9.4"/>) needs to be sent, in the EAP Lower-Layer Attribute if RADIUS is used.</t>
      </section>
      <section anchor="additional-security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8.6">
        <name slugifiedName="name-additional-security-conside">Additional Security Considerations</name>
        <t indent="0" pn="section-8.6-1">In the authentication process, it is possible for an entity to forge messages to generate denial-of-service (DoS) attacks on any of the entities involved. For instance, an attacker can forge multiple initial messages to start an authentication (Step 0 in <xref target="figure3" format="default" sectionFormat="of" derivedContent="Figure 3"/>) with the EAP authenticator as if they were sent by different EAP peers. Consequently, the EAP authenticator will start an authentication process for each message received in Step 0, sending the
EAP-Req/Id (Step 1).


</t>
        <t indent="0" pn="section-8.6-2">To minimize the effects of this DoS attack, it is <bcp14>RECOMMENDED</bcp14> that the EAP authenticator limit the rate at which it processes incoming messages in Step 0 to provide robustness against DoS attacks. The details of rate limiting are outside the scope of this specification. Nevertheless, the rate of these messages is also limited by the bandwidth available between the EAP peer and the EAP authenticator. This bandwidth will be especially limited in constrained links (e.g., Low-Power WANs (LPWANs)). Lastly, it is also <bcp14>RECOMMENDED</bcp14> to reduce at a minimum the state in the EAP authenticator at least until the EAP-Resp/Id is received by the EAP authenticator.</t>
        <t indent="0" pn="section-8.6-3">Another security-related concern is how to ensure that the EAP peer joining the security domain can trust the EAP authenticator. This issue is elaborated in <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>. In particular, the EAP peer knows it can trust the EAP authenticator because the key that is used to establish the security association is derived from the MSK. If the EAP authenticator has the MSK, it is because the AAA server of the EAP peer trusted the EAP authenticator.</t>
      </section>
    </section>
    <section anchor="IANA" numbered="true" removeInRFC="false" toc="include" pn="section-9">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <section anchor="ciphersuite" numbered="true" removeInRFC="false" toc="include" pn="section-9.1">
        <name slugifiedName="name-coap-eap-cipher-suites">CoAP-EAP Cipher Suites</name>
        <t indent="0" pn="section-9.1-1">IANA has created a new registry titled "CoAP-EAP Cipher Suites" under a new registry group named "CoAP-EAP".  The registration procedures are "Specification
Required", "Private Use", and "Standards Action with Expert Review" (see <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>), as shown in <xref target="ciphersute-registration-ranges" format="default" sectionFormat="of" derivedContent="Table 1"/>.</t>
        <table anchor="ciphersute-registration-ranges" align="center" pn="table-1">
          <name slugifiedName="name-registration-procedures-for">Registration Procedures for CoAP-EAP Cipher Suites</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">-65536 to -25</td>
              <td align="left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">-24 to -21</td>
              <td align="left" colspan="1" rowspan="1">Private Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">-20 to 23</td>
              <td align="left" colspan="1" rowspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">24 to 65535</td>
              <td align="left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-9.1-3">The columns of the registry are Value, Algorithms, Description, and Reference, where Value is an integer and the other columns are text strings.  The initial registrations are shown in <xref target="ciphersute-initial-value" format="default" sectionFormat="of" derivedContent="Table 2"/>.</t>
        <table anchor="ciphersute-initial-value" align="center" pn="table-2">
          <name slugifiedName="name-coap-eap-cipher-suites-init">CoAP-EAP Cipher Suites: Initial Registrations</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Algorithms</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="left" colspan="1" rowspan="1">10, -16</td>
              <td align="left" colspan="1" rowspan="1">AES-CCM-16-64-128, SHA-256</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">1, -16</td>
              <td align="left" colspan="1" rowspan="1">A128GCM, SHA-256</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="left" colspan="1" rowspan="1">3, -43</td>
              <td align="left" colspan="1" rowspan="1">A256GCM, SHA-384</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="left" colspan="1" rowspan="1">24, -16</td>
              <td align="left" colspan="1" rowspan="1">ChaCha20/Poly1305, SHA-256</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="left" colspan="1" rowspan="1">24, -45</td>
              <td align="left" colspan="1" rowspan="1">ChaCha20/Poly1305, SHAKE256</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="llid" numbered="true" removeInRFC="false" toc="include" pn="section-9.2">
        <name slugifiedName="name-cddl-in-coap-eap-informatio">CDDL in CoAP-EAP Information Elements</name>
        <t indent="0" pn="section-9.2-1">IANA has created a new registry titled "CoAP-EAP Information Elements" under a new registry group named "CoAP-EAP".  The registration procedures are "Standards Action with Expert Review", "Private Use", "Specification Required", and "Experimental Use" (see <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>),
as shown in <xref target="coap-eap-ie-registration-ranges" format="default" sectionFormat="of" derivedContent="Table 3"/>.
</t>
        <table anchor="coap-eap-ie-registration-ranges" align="center" pn="table-3">
          <name slugifiedName="name-registration-procedures-for-">Registration Procedures for CoAP-EAP Information Elements</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0 to 23</td>
              <td align="left" colspan="1" rowspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">24 to 49</td>
              <td align="left" colspan="1" rowspan="1">Private Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">50 to 65000</td>
              <td align="left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">65001 to 65535</td>
              <td align="left" colspan="1" rowspan="1">Experimental Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-9.2-3">The columns of the registry are Name, Label, CBOR Type, Description, and Reference, where Label is an integer and the other columns are text strings.  The initial registrations are shown in <xref target="coap-eap-ie-values" format="default" sectionFormat="of" derivedContent="Table 4"/>.</t>
        <table anchor="coap-eap-ie-values" align="center" pn="table-4">
          <name slugifiedName="name-coap-eap-information-elemen">CoAP-EAP Information Elements: Initial Registrations</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Label</th>
              <th align="left" colspan="1" rowspan="1">CBOR Type</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">Cipher Suite</td>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">CBOR Array</td>
              <td align="left" colspan="1" rowspan="1">List of the proposed or selected COSE algorithms for OSCORE</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">RID-C</td>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="left" colspan="1" rowspan="1">Byte String</td>
              <td align="left" colspan="1" rowspan="1">Contains the Recipient ID of the EAP authenticator</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">RID-I</td>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="left" colspan="1" rowspan="1">Byte String</td>
              <td align="left" colspan="1" rowspan="1">Contains the Recipient ID of the EAP peer</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">Session-Lifetime</td>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="left" colspan="1" rowspan="1">uint</td>
              <td align="left" colspan="1" rowspan="1">Contains the time that the session is valid, in seconds</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="wellknown" numbered="true" removeInRFC="false" toc="include" pn="section-9.3">
        <name slugifiedName="name-the-well-known-uris-registr">The Well-Known URIs Registry</name>
        <t indent="0" pn="section-9.3-1">IANA has added the well-known URI "coap-eap" to the "Well-Known URIs" registry under the "Well-Known URIs" registry group defined by <xref target="RFC8615" format="default" sectionFormat="of" derivedContent="RFC8615"/>.</t>
        <dl spacing="compact" newline="false" indent="3" pn="section-9.3-2">
          <dt pn="section-9.3-2.1">URI Suffix:</dt>
          <dd pn="section-9.3-2.2">coap-eap</dd>
          <dt pn="section-9.3-2.3">Reference:</dt>
          <dd pn="section-9.3-2.4">RFC 9820</dd>
          <dt pn="section-9.3-2.5">Status:</dt>
          <dd pn="section-9.3-2.6">permanent</dd>
          <dt pn="section-9.3-2.7">Change Controller:</dt>
          <dd pn="section-9.3-2.8">IETF</dd>
        </dl>
      </section>
      <section anchor="lowerlayer" numbered="true" removeInRFC="false" toc="include" pn="section-9.4">
        <name slugifiedName="name-the-eap-lower-layers-regist">The EAP Lower Layers Registry</name>
        <t indent="0" pn="section-9.4-1">IANA has added the identifier "CoAP-EAP" to the "EAP Lower Layers" registry (defined by <xref target="RFC6677" format="default" sectionFormat="of" derivedContent="RFC6677"/>) under the "Extensible Authentication Protocol (EAP) Registry".</t>
        <dl spacing="compact" newline="false" indent="3" pn="section-9.4-2">
          <dt pn="section-9.4-2.1">Value:</dt>
          <dd pn="section-9.4-2.2">10</dd>
          <dt pn="section-9.4-2.3">Lower Layer:</dt>
          <dd pn="section-9.4-2.4">CoAP-EAP</dd>
          <dt pn="section-9.4-2.5">Reference:</dt>
          <dd pn="section-9.4-2.6">RFC 9820</dd>
        </dl>
      </section>
      <section anchor="mediatypes" numbered="true" removeInRFC="false" toc="include" pn="section-9.5">
        <name slugifiedName="name-media-types-registry">Media Types Registry</name>
        <t indent="0" pn="section-9.5-1">IANA has added the media type "application/coap-eap" to the "Media Types" registry. <xref target="coap-eap-media-type" format="default" sectionFormat="of" derivedContent="Section 4"/> defines the format.</t>
        <dl spacing="normal" newline="false" indent="3" pn="section-9.5-2">
          <dt pn="section-9.5-2.1">Type name:</dt>
          <dd pn="section-9.5-2.2">application</dd>
          <dt pn="section-9.5-2.3">Subtype name:</dt>
          <dd pn="section-9.5-2.4">coap-eap</dd>
          <dt pn="section-9.5-2.5">Required parameters:</dt>
          <dd pn="section-9.5-2.6">N/A</dd>
          <dt pn="section-9.5-2.7">Optional parameters:</dt>
          <dd pn="section-9.5-2.8">N/A</dd>
          <dt pn="section-9.5-2.9">Encoding considerations:</dt>
          <dd pn="section-9.5-2.10">binary</dd>
          <dt pn="section-9.5-2.11">Security considerations:</dt>
          <dd pn="section-9.5-2.12">See <xref target="security_considerations" format="default" sectionFormat="of" derivedContent="Section 8"/> of RFC 9820.</dd>
          <dt pn="section-9.5-2.13">Interoperability considerations:</dt>
          <dd pn="section-9.5-2.14">N/A</dd>
          <dt pn="section-9.5-2.15">Published specification:</dt>
          <dd pn="section-9.5-2.16">RFC 9820</dd>
          <dt pn="section-9.5-2.17">Applications that use this media type:</dt>
          <dd pn="section-9.5-2.18">To be identified</dd>
          <dt pn="section-9.5-2.19">Fragment identifier considerations:</dt>
          <dd pn="section-9.5-2.20">N/A</dd>
          <dt pn="section-9.5-2.21">Additional information:</dt>
          <dd pn="section-9.5-2.22">
            <t indent="0" pn="section-9.5-2.22.1"><br/></t>
            <dl spacing="compact" indent="3" newline="false" pn="section-9.5-2.22.2">
              <dt pn="section-9.5-2.22.2.1">Magic number(s):</dt>
              <dd pn="section-9.5-2.22.2.2">N/A</dd>
              <dt pn="section-9.5-2.22.2.3">File extension(s):</dt>
              <dd pn="section-9.5-2.22.2.4">N/A</dd>
              <dt pn="section-9.5-2.22.2.5">Macintosh file type code(s):</dt>
              <dd pn="section-9.5-2.22.2.6">N/A</dd>
            </dl>
          </dd>
          <dt pn="section-9.5-2.23">Person and email address to contact for further information:</dt>
          <dd pn="section-9.5-2.24">ace@ietf.org</dd>
          <dt pn="section-9.5-2.25">Intended usage:</dt>
          <dd pn="section-9.5-2.26">COMMON</dd>
          <dt pn="section-9.5-2.27">Restrictions on usage:</dt>
          <dd pn="section-9.5-2.28">N/A</dd>
          <dt pn="section-9.5-2.29">Author:</dt>
          <dd pn="section-9.5-2.30">See the "Authors' Addresses" section of RFC 9820.</dd>
          <dt pn="section-9.5-2.31">Change Controller:</dt>
          <dd pn="section-9.5-2.32">IETF</dd>
        </dl>
      </section>
      <section anchor="content-format" numbered="true" removeInRFC="false" toc="include" pn="section-9.6">
        <name slugifiedName="name-coap-content-formats-regist">CoAP Content-Formats Registry</name>
        <t indent="0" pn="section-9.6-1">IANA has added the media type "application/coap-eap" to the "CoAP Content-Formats" registry under the "Constrained RESTful Environments (CoRE) Parameters" registry group, following the specification in <xref target="RFC7252" sectionFormat="of" section="12.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7252#section-12.3" derivedContent="RFC7252"/>.</t>
        <table anchor="content-format_registry" align="center" pn="table-5">
          <name slugifiedName="name-coap-content-formats-registr">CoAP Content-Formats Registry</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Media Type</th>
              <th align="left" colspan="1" rowspan="1">Content Encoding</th>
              <th align="left" colspan="1" rowspan="1">ID</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">application/coap-eap</td>
              <td align="left" colspan="1" rowspan="1">-</td>
              <td align="left" colspan="1" rowspan="1">269</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="resource-type" numbered="true" removeInRFC="false" toc="include" pn="section-9.7">
        <name slugifiedName="name-resource-type-rt-link-targe">Resource Type (rt=) Link Target Attribute Values Registry</name>
        <t indent="0" pn="section-9.7-1">IANA has added the resource type "core.coap-eap" to the "Resource Type (rt=) Link Target Attribute Values" registry under the "Constrained RESTful Environments (CoRE) Parameters" registry group.</t>
        <table anchor="resource-type-reg" align="center" pn="table-6">
          <name slugifiedName="name-resource-type-rt-link-target">Resource Type (rt=) Link Target Attribute Values Registry</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">core.coap-eap</td>
              <td align="left" colspan="1" rowspan="1">CoAP-EAP resource</td>
              <td align="left" colspan="1" rowspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="expert-review-instructions" numbered="true" removeInRFC="false" toc="include" pn="section-9.8">
        <name slugifiedName="name-expert-review-instructions">Expert Review Instructions</name>
        <t indent="0" pn="section-9.8-1">The IANA registries established in this document apply the
   "Specification Required", "Private Use", "Standards Action with Expert Review",
and "Experimental Use" policies.  (See also <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>.)
   This section provides general guidelines for what experts should focus on, but as they are designated experts for a reason, they should be granted flexibility.</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-9.8-2">
          <li pn="section-9.8-2.1">
            <t indent="0" pn="section-9.8-2.1.1">When defining the use of CoAP-EAP Information Elements (IEs), experts are expected to evaluate how the values are defined, their scope, and whether they align with CoAP-EAP's functionality and constraints. They are expected to assess whether the values are clear, well structured, and follow CoAP and CoAP-EAP conventions, such as concise encoding for constrained environments. They should ensure that these IEs can seamlessly integrate with existing CoAP implementations and extensions. Experts are also expected to verify that IE values are protected from unauthorized modification or misuse during transmission.</t>
          </li>
          <li pn="section-9.8-2.2">
            <t indent="0" pn="section-9.8-2.2.1">When adding new cipher suites, experts must ensure that algorithm values are sourced from the appropriate registry when required. They should also consider seeking input from relevant IETF working groups regarding the accuracy of registered parameters.</t>
          </li>
        </ul>
      </section>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-emu-eap-edhoc" to="EAP-EDHOC"/>
    <references anchor="sec-combined-references" pn="section-10">
      <name slugifiedName="name-references">References</name>
      <references anchor="sec-normative-references" pn="section-10.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC3748" target="https://www.rfc-editor.org/info/rfc3748" quoteTitle="true" derivedAnchor="RFC3748">
          <front>
            <title>Extensible Authentication Protocol (EAP)</title>
            <author fullname="B. Aboba" initials="B." surname="Aboba"/>
            <author fullname="L. Blunk" initials="L." surname="Blunk"/>
            <author fullname="J. Vollbrecht" initials="J." surname="Vollbrecht"/>
            <author fullname="J. Carlson" initials="J." surname="Carlson"/>
            <author fullname="H. Levkowetz" initials="H." role="editor" surname="Levkowetz"/>
            <date month="June" year="2004"/>
            <abstract>
              <t indent="0">This document defines the Extensible Authentication Protocol (EAP), an authentication framework which supports multiple authentication methods. EAP typically runs directly over data link layers such as Point-to-Point Protocol (PPP) or IEEE 802, without requiring IP. EAP provides its own support for duplicate elimination and retransmission, but is reliant on lower layer ordering guarantees. Fragmentation is not supported within EAP itself; however, individual EAP methods may support this. This document obsoletes RFC 2284. A summary of the changes between this document and RFC 2284 is available in Appendix A. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3748"/>
          <seriesInfo name="DOI" value="10.17487/RFC3748"/>
        </reference>
        <reference anchor="RFC5247" target="https://www.rfc-editor.org/info/rfc5247" quoteTitle="true" derivedAnchor="RFC5247">
          <front>
            <title>Extensible Authentication Protocol (EAP) Key Management Framework</title>
            <author fullname="B. Aboba" initials="B." surname="Aboba"/>
            <author fullname="D. Simon" initials="D." surname="Simon"/>
            <author fullname="P. Eronen" initials="P." surname="Eronen"/>
            <date month="August" year="2008"/>
            <abstract>
              <t indent="0">The Extensible Authentication Protocol (EAP), defined in RFC 3748, enables extensible network access authentication. This document specifies the EAP key hierarchy and provides a framework for the transport and usage of keying material and parameters generated by EAP authentication algorithms, known as "methods". It also provides a detailed system-level security analysis, describing the conditions under which the key management guidelines described in RFC 4962 can be satisfied. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5247"/>
          <seriesInfo name="DOI" value="10.17487/RFC5247"/>
        </reference>
        <reference anchor="RFC6677" target="https://www.rfc-editor.org/info/rfc6677" quoteTitle="true" derivedAnchor="RFC6677">
          <front>
            <title>Channel-Binding Support for Extensible Authentication Protocol (EAP) Methods</title>
            <author fullname="S. Hartman" initials="S." role="editor" surname="Hartman"/>
            <author fullname="T. Clancy" initials="T." surname="Clancy"/>
            <author fullname="K. Hoeper" initials="K." surname="Hoeper"/>
            <date month="July" year="2012"/>
            <abstract>
              <t indent="0">This document defines how to implement channel bindings for Extensible Authentication Protocol (EAP) methods to address the "lying Network Access Service (NAS)" problem as well as the "lying provider" problem. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6677"/>
          <seriesInfo name="DOI" value="10.17487/RFC6677"/>
        </reference>
        <reference anchor="RFC7252" target="https://www.rfc-editor.org/info/rfc7252" quoteTitle="true" derivedAnchor="RFC7252">
          <front>
            <title>The Constrained Application Protocol (CoAP)</title>
            <author fullname="Z. Shelby" initials="Z." surname="Shelby"/>
            <author fullname="K. Hartke" initials="K." surname="Hartke"/>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <date month="June" year="2014"/>
            <abstract>
              <t indent="0">The Constrained Application Protocol (CoAP) is a specialized web transfer protocol for use with constrained nodes and constrained (e.g., low-power, lossy) networks. The nodes often have 8-bit microcontrollers with small amounts of ROM and RAM, while constrained networks such as IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs) often have high packet error rates and a typical throughput of 10s of kbit/s. The protocol is designed for machine- to-machine (M2M) applications such as smart energy and building automation.</t>
              <t indent="0">CoAP provides a request/response interaction model between application endpoints, supports built-in discovery of services and resources, and includes key concepts of the Web such as URIs and Internet media types. CoAP is designed to easily interface with HTTP for integration with the Web while meeting specialized requirements such as multicast support, very low overhead, and simplicity for constrained environments.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7252"/>
          <seriesInfo name="DOI" value="10.17487/RFC7252"/>
        </reference>
        <reference anchor="RFC7959" target="https://www.rfc-editor.org/info/rfc7959" quoteTitle="true" derivedAnchor="RFC7959">
          <front>
            <title>Block-Wise Transfers in the Constrained Application Protocol (CoAP)</title>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <author fullname="Z. Shelby" initials="Z." role="editor" surname="Shelby"/>
            <date month="August" year="2016"/>
            <abstract>
              <t indent="0">The Constrained Application Protocol (CoAP) is a RESTful transfer protocol for constrained nodes and networks. Basic CoAP messages work well for small payloads from sensors and actuators; however, applications will need to transfer larger payloads occasionally -- for instance, for firmware updates. In contrast to HTTP, where TCP does the grunt work of segmenting and resequencing, CoAP is based on datagram transports such as UDP or Datagram Transport Layer Security (DTLS). These transports only offer fragmentation, which is even more problematic in constrained nodes and networks, limiting the maximum size of resource representations that can practically be transferred.</t>
              <t indent="0">Instead of relying on IP fragmentation, this specification extends basic CoAP with a pair of "Block" options for transferring multiple blocks of information from a resource representation in multiple request-response pairs. In many important cases, the Block options enable a server to be truly stateless: the server can handle each block transfer separately, with no need for a connection setup or other server-side memory of previous block transfers. Essentially, the Block options provide a minimal way to transfer larger representations in a block-wise fashion.</t>
              <t indent="0">A CoAP implementation that does not support these options generally is limited in the size of the representations that can be exchanged, so there is an expectation that the Block options will be widely used in CoAP implementations. Therefore, this specification updates RFC 7252.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7959"/>
          <seriesInfo name="DOI" value="10.17487/RFC7959"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol specifications. This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8323" target="https://www.rfc-editor.org/info/rfc8323" quoteTitle="true" derivedAnchor="RFC8323">
          <front>
            <title>CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets</title>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <author fullname="S. Lemay" initials="S." surname="Lemay"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <author fullname="K. Hartke" initials="K." surname="Hartke"/>
            <author fullname="B. Silverajan" initials="B." surname="Silverajan"/>
            <author fullname="B. Raymor" initials="B." role="editor" surname="Raymor"/>
            <date month="February" year="2018"/>
            <abstract>
              <t indent="0">The Constrained Application Protocol (CoAP), although inspired by HTTP, was designed to use UDP instead of TCP. The message layer of CoAP over UDP includes support for reliable delivery, simple congestion control, and flow control.</t>
              <t indent="0">Some environments benefit from the availability of CoAP carried over reliable transports such as TCP or Transport Layer Security (TLS). This document outlines the changes required to use CoAP over TCP, TLS, and WebSockets transports. It also formally updates RFC 7641 for use with these transports and RFC 7959 to enable the use of larger messages over a reliable transport.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8323"/>
          <seriesInfo name="DOI" value="10.17487/RFC8323"/>
        </reference>
        <reference anchor="RFC8613" target="https://www.rfc-editor.org/info/rfc8613" quoteTitle="true" derivedAnchor="RFC8613">
          <front>
            <title>Object Security for Constrained RESTful Environments (OSCORE)</title>
            <author fullname="G. Selander" initials="G." surname="Selander"/>
            <author fullname="J. Mattsson" initials="J." surname="Mattsson"/>
            <author fullname="F. Palombini" initials="F." surname="Palombini"/>
            <author fullname="L. Seitz" initials="L." surname="Seitz"/>
            <date month="July" year="2019"/>
            <abstract>
              <t indent="0">This document defines Object Security for Constrained RESTful Environments (OSCORE), a method for application-layer protection of the Constrained Application Protocol (CoAP), using CBOR Object Signing and Encryption (COSE). OSCORE provides end-to-end protection between endpoints communicating using CoAP or CoAP-mappable HTTP. OSCORE is designed for constrained nodes and networks supporting a range of proxy operations, including translation between different transport protocols.</t>
              <t indent="0">Although an optional functionality of CoAP, OSCORE alters CoAP options processing and IANA registration. Therefore, this document updates RFC 7252.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8613"/>
          <seriesInfo name="DOI" value="10.17487/RFC8613"/>
        </reference>
        <reference anchor="RFC8949" target="https://www.rfc-editor.org/info/rfc8949" quoteTitle="true" derivedAnchor="RFC8949">
          <front>
            <title>Concise Binary Object Representation (CBOR)</title>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <author fullname="P. Hoffman" initials="P." surname="Hoffman"/>
            <date month="December" year="2020"/>
            <abstract>
              <t indent="0">The Concise Binary Object Representation (CBOR) is a data format whose design goals include the possibility of extremely small code size, fairly small message size, and extensibility without the need for version negotiation. These design goals make it different from earlier binary serializations such as ASN.1 and MessagePack.</t>
              <t indent="0">This document obsoletes RFC 7049, providing editorial improvements, new details, and errata fixes while keeping full compatibility with the interchange format of RFC 7049. It does not create a new version of the format.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="94"/>
          <seriesInfo name="RFC" value="8949"/>
          <seriesInfo name="DOI" value="10.17487/RFC8949"/>
        </reference>
      </references>
      <references anchor="sec-informative-references" pn="section-10.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="CoAP-EAP" target="https://www.mdpi.com/1424-8220/16/3/358" quoteTitle="true" derivedAnchor="CoAP-EAP">
          <front>
            <title>Lightweight CoAP-Based Bootstrapping Service for the Internet of Things</title>
            <author initials="D." surname="Garcia-Carrillo" fullname="Dan Garcia-Carrillo">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Marin-Lopez" fullname="Rafael Marin-Lopez">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016"/>
          </front>
          <seriesInfo name="DOI" value="10.3390/s16030358"/>
          <refcontent>Sensors, vol. 16, no. 3</refcontent>
        </reference>
        <reference anchor="I-D.ietf-emu-eap-edhoc" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-emu-eap-edhoc-05" derivedAnchor="EAP-EDHOC">
          <front>
            <title>Using the Extensible Authentication Protocol (EAP) with Ephemeral Diffie-Hellman over COSE (EDHOC)</title>
            <author initials="D." surname="Garcia-Carrillo" fullname="Dan Garcia-Carrillo">
              <organization showOnFrontPage="true">University of Oviedo</organization>
            </author>
            <author initials="R." surname="Marin-Lopez" fullname="Rafael Marin-Lopez">
              <organization showOnFrontPage="true">University of Murcia</organization>
            </author>
            <author initials="G." surname="Selander" fullname="Göran Selander">
              <organization showOnFrontPage="true">Ericsson</organization>
            </author>
            <author initials="J." surname="Preuß Mattsson" fullname="John Preuß Mattsson">
              <organization showOnFrontPage="true">Ericsson</organization>
            </author>
            <author initials="F." surname="Lopez-Gomez" fullname="Francisco Lopez-Gomez">
              <organization showOnFrontPage="true">University of Murcia</organization>
            </author>
            <date month="July" day="30" year="2025"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-emu-eap-edhoc-05"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="EAP-Framework-IoT" target="https://ieeexplore.ieee.org/document/9579387" quoteTitle="true" derivedAnchor="EAP-Framework-IoT">
          <front>
            <title>Secure Network Access Authentication for IoT Devices: EAP Framework vs. Individual Protocols</title>
            <author initials="M." surname="Sethi" fullname="Mohit Sethi">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Aura" fullname="Tuomas Aura">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021"/>
          </front>
          <seriesInfo name="DOI" value="10.1109/MCOMSTD.201.2000088"/>
          <refcontent>IEEE Communications Standards Magazine, vol. 5, no. 3, pp. 34-39</refcontent>
        </reference>
        <reference anchor="IEEE802159" target="https://doi.org/10.1109/IEEESTD.2022.9690134" quoteTitle="true" derivedAnchor="IEEE802159">
          <front>
            <title>IEEE Standard for Transport of Key Management Protocol (KMP) Datagrams</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="January" year="2022"/>
          </front>
          <seriesInfo name="IEEE Std" value="802.15.9-2021"/>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2022.9690134"/>
        </reference>
        <reference anchor="LO-CoAP-EAP" target="https://www.mdpi.com/1424-8220/17/11/2646" quoteTitle="true" derivedAnchor="LO-CoAP-EAP">
          <front>
            <title>A CoAP-Based Network Access Authentication Service for Low-Power Wide Area Networks: LO-CoAP-EAP</title>
            <author initials="D." surname="Garcia-Carrillo" fullname="Dan Garcia-Carrillo">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Marin-Lopez" fullname="Rafael Marin-Lopez">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Kandasamy" fullname="Arunprabhu Kandasamy">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Pelov" fullname="Alexander Pelov">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017"/>
          </front>
          <seriesInfo name="DOI" value="10.3390/s17112646"/>
          <refcontent>Sensors, vol. 17, no. 11</refcontent>
        </reference>
        <reference anchor="RFC4017" target="https://www.rfc-editor.org/info/rfc4017" quoteTitle="true" derivedAnchor="RFC4017">
          <front>
            <title>Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</title>
            <author fullname="D. Stanley" initials="D." surname="Stanley"/>
            <author fullname="J. Walker" initials="J." surname="Walker"/>
            <author fullname="B. Aboba" initials="B." surname="Aboba"/>
            <date month="March" year="2005"/>
            <abstract>
              <t indent="0">The IEEE 802.11i MAC Security Enhancements Amendment makes use of IEEE 802.1X, which in turn relies on the Extensible Authentication Protocol (EAP). This document defines requirements for EAP methods used in IEEE 802.11 wireless LAN deployments. The material in this document has been approved by IEEE 802.11 and is being presented as an IETF RFC for informational purposes. This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4017"/>
          <seriesInfo name="DOI" value="10.17487/RFC4017"/>
        </reference>
        <reference anchor="RFC4137" target="https://www.rfc-editor.org/info/rfc4137" quoteTitle="true" derivedAnchor="RFC4137">
          <front>
            <title>State Machines for Extensible Authentication Protocol (EAP) Peer and Authenticator</title>
            <author fullname="J. Vollbrecht" initials="J." surname="Vollbrecht"/>
            <author fullname="P. Eronen" initials="P." surname="Eronen"/>
            <author fullname="N. Petroni" initials="N." surname="Petroni"/>
            <author fullname="Y. Ohba" initials="Y." surname="Ohba"/>
            <date month="August" year="2005"/>
            <abstract>
              <t indent="0">This document describes a set of state machines for Extensible Authentication Protocol (EAP) peer, EAP stand-alone authenticator (non-pass-through), EAP backend authenticator (for use on Authentication, Authorization, and Accounting (AAA) servers), and EAP full authenticator (for both local and pass-through). This set of state machines shows how EAP can be implemented to support deployment in either a peer/authenticator or peer/authenticator/AAA Server environment. The peer and stand-alone authenticator machines are illustrative of how the EAP protocol defined in RFC 3748 may be implemented. The backend and full/pass-through authenticators illustrate how EAP/AAA protocol support defined in RFC 3579 may be implemented. Where there are differences, RFC 3748 and RFC 3579 are authoritative.</t>
              <t indent="0">The state machines are based on the EAP "Switch" model. This model includes events and actions for the interaction between the EAP Switch and EAP methods. A brief description of the EAP "Switch" model is given in the Introduction section.</t>
              <t indent="0">The state machine and associated model are informative only. Implementations may achieve the same results using different methods. This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4137"/>
          <seriesInfo name="DOI" value="10.17487/RFC4137"/>
        </reference>
        <reference anchor="RFC4186" target="https://www.rfc-editor.org/info/rfc4186" quoteTitle="true" derivedAnchor="RFC4186">
          <front>
            <title>Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)</title>
            <author fullname="H. Haverinen" initials="H." role="editor" surname="Haverinen"/>
            <author fullname="J. Salowey" initials="J." role="editor" surname="Salowey"/>
            <date month="January" year="2006"/>
            <abstract>
              <t indent="0">This document specifies an Extensible Authentication Protocol (EAP) mechanism for authentication and session key distribution using the Global System for Mobile Communications (GSM) Subscriber Identity Module (SIM). GSM is a second generation mobile network standard. The EAP-SIM mechanism specifies enhancements to GSM authentication and key agreement whereby multiple authentication triplets can be combined to create authentication responses and session keys of greater strength than the individual GSM triplets. The mechanism also includes network authentication, user anonymity support, result indications, and a fast re-authentication procedure. This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4186"/>
          <seriesInfo name="DOI" value="10.17487/RFC4186"/>
        </reference>
        <reference anchor="RFC4764" target="https://www.rfc-editor.org/info/rfc4764" quoteTitle="true" derivedAnchor="RFC4764">
          <front>
            <title>The EAP-PSK Protocol: A Pre-Shared Key Extensible Authentication Protocol (EAP) Method</title>
            <author fullname="F. Bersani" initials="F." surname="Bersani"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <date month="January" year="2007"/>
            <abstract>
              <t indent="0">This document specifies EAP-PSK, an Extensible Authentication Protocol (EAP) method for mutual authentication and session key derivation using a Pre-Shared Key (PSK). EAP-PSK provides a protected communication channel when mutual authentication is successful for both parties to communicate over. This document describes the use of this channel only for protected exchange of result indications, but future EAP-PSK extensions may use the channel for other purposes. EAP-PSK is designed for authentication over insecure networks such as IEEE 802.11. This memo defines an Experimental Protocol for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4764"/>
          <seriesInfo name="DOI" value="10.17487/RFC4764"/>
        </reference>
        <reference anchor="RFC5191" target="https://www.rfc-editor.org/info/rfc5191" quoteTitle="true" derivedAnchor="RFC5191">
          <front>
            <title>Protocol for Carrying Authentication for Network Access (PANA)</title>
            <author fullname="D. Forsberg" initials="D." surname="Forsberg"/>
            <author fullname="Y. Ohba" initials="Y." role="editor" surname="Ohba"/>
            <author fullname="B. Patil" initials="B." surname="Patil"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <author fullname="A. Yegin" initials="A." surname="Yegin"/>
            <date month="May" year="2008"/>
            <abstract>
              <t indent="0">This document defines the Protocol for Carrying Authentication for Network Access (PANA), a network-layer transport for Extensible Authentication Protocol (EAP) to enable network access authentication between clients and access networks. In EAP terms, PANA is a UDP-based EAP lower layer that runs between the EAP peer and the EAP authenticator. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5191"/>
          <seriesInfo name="DOI" value="10.17487/RFC5191"/>
        </reference>
        <reference anchor="RFC5433" target="https://www.rfc-editor.org/info/rfc5433" quoteTitle="true" derivedAnchor="RFC5433">
          <front>
            <title>Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method</title>
            <author fullname="T. Clancy" initials="T." surname="Clancy"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <date month="February" year="2009"/>
            <abstract>
              <t indent="0">This memo defines an Extensible Authentication Protocol (EAP) method called EAP Generalized Pre-Shared Key (EAP-GPSK). This method is a lightweight shared-key authentication protocol supporting mutual authentication and key derivation. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5433"/>
          <seriesInfo name="DOI" value="10.17487/RFC5433"/>
        </reference>
        <reference anchor="RFC5448" target="https://www.rfc-editor.org/info/rfc5448" quoteTitle="true" derivedAnchor="RFC5448">
          <front>
            <title>Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')</title>
            <author fullname="J. Arkko" initials="J." surname="Arkko"/>
            <author fullname="V. Lehtovirta" initials="V." surname="Lehtovirta"/>
            <author fullname="P. Eronen" initials="P." surname="Eronen"/>
            <date month="May" year="2009"/>
            <abstract>
              <t indent="0">This specification defines a new EAP method, EAP-AKA', which is a small revision of the EAP-AKA (Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement) method. The change is a new key derivation function that binds the keys derived within the method to the name of the access network. The new key derivation mechanism has been defined in the 3rd Generation Partnership Project (3GPP). This specification allows its use in EAP in an interoperable manner. In addition, EAP-AKA' employs SHA-256 instead of SHA-1.</t>
              <t indent="0">This specification also updates RFC 4187, EAP-AKA, to prevent bidding down attacks from EAP-AKA'. This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5448"/>
          <seriesInfo name="DOI" value="10.17487/RFC5448"/>
        </reference>
        <reference anchor="RFC5869" target="https://www.rfc-editor.org/info/rfc5869" quoteTitle="true" derivedAnchor="RFC5869">
          <front>
            <title>HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</title>
            <author fullname="H. Krawczyk" initials="H." surname="Krawczyk"/>
            <author fullname="P. Eronen" initials="P." surname="Eronen"/>
            <date month="May" year="2010"/>
            <abstract>
              <t indent="0">This document specifies a simple Hashed Message Authentication Code (HMAC)-based key derivation function (HKDF), which can be used as a building block in various protocols and applications. The key derivation function (KDF) is intended to support a wide range of applications and requirements, and is conservative in its use of cryptographic hash functions. This document is not an Internet Standards Track specification; it is published for informational purposes.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5869"/>
          <seriesInfo name="DOI" value="10.17487/RFC5869"/>
        </reference>
        <reference anchor="RFC6696" target="https://www.rfc-editor.org/info/rfc6696" quoteTitle="true" derivedAnchor="RFC6696">
          <front>
            <title>EAP Extensions for the EAP Re-authentication Protocol (ERP)</title>
            <author fullname="Z. Cao" initials="Z." surname="Cao"/>
            <author fullname="B. He" initials="B." surname="He"/>
            <author fullname="Y. Shi" initials="Y." surname="Shi"/>
            <author fullname="Q. Wu" initials="Q." role="editor" surname="Wu"/>
            <author fullname="G. Zorn" initials="G." role="editor" surname="Zorn"/>
            <date month="July" year="2012"/>
            <abstract>
              <t indent="0">The Extensible Authentication Protocol (EAP) is a generic framework supporting multiple types of authentication methods. In systems where EAP is used for authentication, it is desirable to avoid repeating the entire EAP exchange with another authenticator. This document specifies extensions to EAP and the EAP keying hierarchy to support an EAP method-independent protocol for efficient re- authentication between the peer and an EAP re-authentication server through any authenticator. The re-authentication server may be in the home network or in the local network to which the peer is connecting. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6696"/>
          <seriesInfo name="DOI" value="10.17487/RFC6696"/>
        </reference>
        <reference anchor="RFC7833" target="https://www.rfc-editor.org/info/rfc7833" quoteTitle="true" derivedAnchor="RFC7833">
          <front>
            <title>A RADIUS Attribute, Binding, Profiles, Name Identifier Format, and Confirmation Methods for the Security Assertion Markup Language (SAML)</title>
            <author fullname="J. Howlett" initials="J." surname="Howlett"/>
            <author fullname="S. Hartman" initials="S." surname="Hartman"/>
            <author fullname="A. Perez-Mendez" initials="A." role="editor" surname="Perez-Mendez"/>
            <date month="May" year="2016"/>
            <abstract>
              <t indent="0">This document describes the use of the Security Assertion Markup Language (SAML) with RADIUS in the context of the Application Bridging for Federated Access Beyond web (ABFAB) architecture. It defines two RADIUS attributes, a SAML binding, a SAML name identifier format, two SAML profiles, and two SAML confirmation methods. The RADIUS attributes permit encapsulation of SAML Assertions and protocol messages within RADIUS, allowing SAML entities to communicate using the binding. The two profiles describe the application of this binding for ABFAB authentication and assertion Query/Request, enabling a Relying Party to request authentication of, or assertions for, users or machines (clients). These clients may be named using a Network Access Identifier (NAI) name identifier format. Finally, the subject confirmation methods allow requests and queries to be issued for a previously authenticated user or machine without needing to explicitly identify them as the subject. The use of the artifacts defined in this document is not exclusive to ABFAB. They can be applied in any Authentication, Authorization, and Accounting (AAA) scenario, such as network access control.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7833"/>
          <seriesInfo name="DOI" value="10.17487/RFC7833"/>
        </reference>
        <reference anchor="RFC7967" target="https://www.rfc-editor.org/info/rfc7967" quoteTitle="true" derivedAnchor="RFC7967">
          <front>
            <title>Constrained Application Protocol (CoAP) Option for No Server Response</title>
            <author fullname="A. Bhattacharyya" initials="A." surname="Bhattacharyya"/>
            <author fullname="S. Bandyopadhyay" initials="S." surname="Bandyopadhyay"/>
            <author fullname="A. Pal" initials="A." surname="Pal"/>
            <author fullname="T. Bose" initials="T." surname="Bose"/>
            <date month="August" year="2016"/>
            <abstract>
              <t indent="0">There can be machine-to-machine (M2M) scenarios where server responses to client requests are redundant. This kind of open-loop exchange (with no response path from the server to the client) may be desired to minimize resource consumption in constrained systems while updating many resources simultaneously or performing high-frequency updates. CoAP already provides Non-confirmable (NON) messages that are not acknowledged by the recipient. However, the request/response semantics still require the server to respond with a status code indicating "the result of the attempt to understand and satisfy the request", per RFC 7252.</t>
              <t indent="0">This specification introduces a CoAP option called 'No-Response'. Using this option, the client can explicitly express to the server its disinterest in all responses against the particular request. This option also provides granular control to enable expression of disinterest to a particular response class or a combination of response classes. The server MAY decide to suppress the response by not transmitting it back to the client according to the value of the No-Response option in the request. This option may be effective for both unicast and multicast requests. This document also discusses a few examples of applications that benefit from this option.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7967"/>
          <seriesInfo name="DOI" value="10.17487/RFC7967"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author fullname="M. Cotton" initials="M." surname="Cotton"/>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <author fullname="T. Narten" initials="T." surname="Narten"/>
            <date month="June" year="2017"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters. To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper. For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed. This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8446" target="https://www.rfc-editor.org/info/rfc8446" quoteTitle="true" derivedAnchor="RFC8446">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author fullname="E. Rescorla" initials="E." surname="Rescorla"/>
            <date month="August" year="2018"/>
            <abstract>
              <t indent="0">This document specifies version 1.3 of the Transport Layer Security (TLS) protocol. TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t indent="0">This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961. This document also specifies new requirements for TLS 1.2 implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8446"/>
          <seriesInfo name="DOI" value="10.17487/RFC8446"/>
        </reference>
        <reference anchor="RFC8615" target="https://www.rfc-editor.org/info/rfc8615" quoteTitle="true" derivedAnchor="RFC8615">
          <front>
            <title>Well-Known Uniform Resource Identifiers (URIs)</title>
            <author fullname="M. Nottingham" initials="M." surname="Nottingham"/>
            <date month="May" year="2019"/>
            <abstract>
              <t indent="0">This memo defines a path prefix for "well-known locations", "/.well-known/", in selected Uniform Resource Identifier (URI) schemes.</t>
              <t indent="0">In doing so, it obsoletes RFC 5785 and updates the URI schemes defined in RFC 7230 to reserve that space. It also updates RFC 7595 to track URI schemes that support well-known URIs in their registry.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8615"/>
          <seriesInfo name="DOI" value="10.17487/RFC8615"/>
        </reference>
        <reference anchor="RFC8824" target="https://www.rfc-editor.org/info/rfc8824" quoteTitle="true" derivedAnchor="RFC8824">
          <front>
            <title>Static Context Header Compression (SCHC) for the Constrained Application Protocol (CoAP)</title>
            <author fullname="A. Minaburo" initials="A." surname="Minaburo"/>
            <author fullname="L. Toutain" initials="L." surname="Toutain"/>
            <author fullname="R. Andreasen" initials="R." surname="Andreasen"/>
            <date month="June" year="2021"/>
            <abstract>
              <t indent="0">This document defines how to compress Constrained Application Protocol (CoAP) headers using the Static Context Header Compression and fragmentation (SCHC) framework. SCHC defines a header compression mechanism adapted for Constrained Devices. SCHC uses a static description of the header to reduce the header's redundancy and size. While RFC 8724 describes the SCHC compression and fragmentation framework, and its application for IPv6/UDP headers, this document applies SCHC to CoAP headers. The CoAP header structure differs from IPv6 and UDP, since CoAP uses a flexible header with a variable number of options, themselves of variable length. The CoAP message format is asymmetric: the request messages have a header format different from the format in the response messages. This specification gives guidance on applying SCHC to flexible headers and how to leverage the asymmetry for more efficient compression Rules.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8824"/>
          <seriesInfo name="DOI" value="10.17487/RFC8824"/>
        </reference>
        <reference anchor="RFC9031" target="https://www.rfc-editor.org/info/rfc9031" quoteTitle="true" derivedAnchor="RFC9031">
          <front>
            <title>Constrained Join Protocol (CoJP) for 6TiSCH</title>
            <author fullname="M. Vučinić" initials="M." role="editor" surname="Vučinić"/>
            <author fullname="J. Simon" initials="J." surname="Simon"/>
            <author fullname="K. Pister" initials="K." surname="Pister"/>
            <author fullname="M. Richardson" initials="M." surname="Richardson"/>
            <date month="May" year="2021"/>
            <abstract>
              <t indent="0">This document describes the minimal framework required for a new device, called a "pledge", to securely join a 6TiSCH (IPv6 over the Time-Slotted Channel Hopping mode of IEEE 802.15.4) network. The framework requires that the pledge and the JRC (Join Registrar/Coordinator, a central entity), share a symmetric key. How this key is provisioned is out of scope of this document. Through a single CoAP (Constrained Application Protocol) request-response exchange secured by OSCORE (Object Security for Constrained RESTful Environments), the pledge requests admission into the network, and the JRC configures it with link-layer keying material and other parameters. The JRC may at any time update the parameters through another request-response exchange secured by OSCORE. This specification defines the Constrained Join Protocol and its CBOR (Concise Binary Object Representation) data structures, and it describes how to configure the rest of the 6TiSCH communication stack for this join process to occur in a secure manner. Additional security mechanisms may be added on top of this minimal framework.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9031"/>
          <seriesInfo name="DOI" value="10.17487/RFC9031"/>
        </reference>
        <reference anchor="RFC9053" target="https://www.rfc-editor.org/info/rfc9053" quoteTitle="true" derivedAnchor="RFC9053">
          <front>
            <title>CBOR Object Signing and Encryption (COSE): Initial Algorithms</title>
            <author fullname="J. Schaad" initials="J." surname="Schaad"/>
            <date month="August" year="2022"/>
            <abstract>
              <t indent="0">Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size. There is a need to be able to define basic security services for this data format. This document defines a set of algorithms that can be used with the CBOR Object Signing and Encryption (COSE) protocol (RFC 9052).</t>
              <t indent="0">This document, along with RFC 9052, obsoletes RFC 8152.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9053"/>
          <seriesInfo name="DOI" value="10.17487/RFC9053"/>
        </reference>
        <reference anchor="RFC9140" target="https://www.rfc-editor.org/info/rfc9140" quoteTitle="true" derivedAnchor="RFC9140">
          <front>
            <title>Nimble Out-of-Band Authentication for EAP (EAP-NOOB)</title>
            <author fullname="T. Aura" initials="T." surname="Aura"/>
            <author fullname="M. Sethi" initials="M." surname="Sethi"/>
            <author fullname="A. Peltonen" initials="A." surname="Peltonen"/>
            <date month="December" year="2021"/>
            <abstract>
              <t indent="0">The Extensible Authentication Protocol (EAP) provides support for multiple authentication methods. This document defines the EAP-NOOB authentication method for nimble out-of-band (OOB) authentication and key derivation. The EAP method is intended for bootstrapping all kinds of Internet-of-Things (IoT) devices that have no preconfigured authentication credentials. The method makes use of a user-assisted, one-directional, out-of-band (OOB) message between the peer device and authentication server to authenticate the in-band key exchange. The device must have a nonnetwork input or output interface, such as a display, microphone, speaker, or blinking light, that can send or receive dynamically generated messages of tens of bytes in length.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9140"/>
          <seriesInfo name="DOI" value="10.17487/RFC9140"/>
        </reference>
        <reference anchor="RFC9147" target="https://www.rfc-editor.org/info/rfc9147" quoteTitle="true" derivedAnchor="RFC9147">
          <front>
            <title>The Datagram Transport Layer Security (DTLS) Protocol Version 1.3</title>
            <author fullname="E. Rescorla" initials="E." surname="Rescorla"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <author fullname="N. Modadugu" initials="N." surname="Modadugu"/>
            <date month="April" year="2022"/>
            <abstract>
              <t indent="0">This document specifies version 1.3 of the Datagram Transport Layer Security (DTLS) protocol. DTLS 1.3 allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t indent="0">The DTLS 1.3 protocol is based on the Transport Layer Security (TLS) 1.3 protocol and provides equivalent security guarantees with the exception of order protection / non-replayability. Datagram semantics of the underlying transport are preserved by the DTLS protocol.</t>
              <t indent="0">This document obsoletes RFC 6347.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9147"/>
          <seriesInfo name="DOI" value="10.17487/RFC9147"/>
        </reference>
        <reference anchor="RFC9176" target="https://www.rfc-editor.org/info/rfc9176" quoteTitle="true" derivedAnchor="RFC9176">
          <front>
            <title>Constrained RESTful Environments (CoRE) Resource Directory</title>
            <author fullname="C. Amsüss" initials="C." role="editor" surname="Amsüss"/>
            <author fullname="Z. Shelby" initials="Z." surname="Shelby"/>
            <author fullname="M. Koster" initials="M." surname="Koster"/>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <author fullname="P. van der Stok" initials="P." surname="van der Stok"/>
            <date month="April" year="2022"/>
            <abstract>
              <t indent="0">In many Internet of Things (IoT) applications, direct discovery of resources is not practical due to sleeping nodes or networks where multicast traffic is inefficient. These problems can be solved by employing an entity called a Resource Directory (RD), which contains information about resources held on other servers, allowing lookups to be performed for those resources. The input to an RD is composed of links, and the output is composed of links constructed from the information stored in the RD. This document specifies the web interfaces that an RD supports for web servers to discover the RD and to register, maintain, look up, and remove information on resources. Furthermore, new target attributes useful in conjunction with an RD are defined.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9176"/>
          <seriesInfo name="DOI" value="10.17487/RFC9176"/>
        </reference>
        <reference anchor="RFC9190" target="https://www.rfc-editor.org/info/rfc9190" quoteTitle="true" derivedAnchor="RFC9190">
          <front>
            <title>EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3</title>
            <author fullname="J. Preuß Mattsson" initials="J." surname="Preuß Mattsson"/>
            <author fullname="M. Sethi" initials="M." surname="Sethi"/>
            <date month="February" year="2022"/>
            <abstract>
              <t indent="0">The Extensible Authentication Protocol (EAP), defined in RFC 3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-TLS with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security and privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 (EAP-TLS 1.3) further improves security and privacy by always providing forward secrecy, never disclosing the peer identity, and by mandating use of revocation checking when compared to EAP-TLS with earlier versions of TLS. This document also provides guidance on authentication, authorization, and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9190"/>
          <seriesInfo name="DOI" value="10.17487/RFC9190"/>
        </reference>
        <reference anchor="RFC9200" target="https://www.rfc-editor.org/info/rfc9200" quoteTitle="true" derivedAnchor="RFC9200">
          <front>
            <title>Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)</title>
            <author fullname="L. Seitz" initials="L." surname="Seitz"/>
            <author fullname="G. Selander" initials="G." surname="Selander"/>
            <author fullname="E. Wahlstroem" initials="E." surname="Wahlstroem"/>
            <author fullname="S. Erdtman" initials="S." surname="Erdtman"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <date month="August" year="2022"/>
            <abstract>
              <t indent="0">This specification defines a framework for authentication and authorization in Internet of Things (IoT) environments called ACE-OAuth. The framework is based on a set of building blocks including OAuth 2.0 and the Constrained Application Protocol (CoAP), thus transforming a well-known and widely used authorization solution into a form suitable for IoT devices. Existing specifications are used where possible, but extensions are added and profiles are defined to better serve the IoT use cases.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9200"/>
          <seriesInfo name="DOI" value="10.17487/RFC9200"/>
        </reference>
        <reference anchor="THREAD" target="https://www.threadgroup.org/Portals/0/Documents/Thread_1.4_Features_White_Paper_September_2024.pdf" quoteTitle="true" derivedAnchor="THREAD">
          <front>
            <title>Thread 1.4 Features White Paper</title>
            <author initials="S." surname="Kumar" fullname="Saurabh Kumar">
            </author>
            <author initials="E." surname="Dijk" fullname="Esko Dijk">
            </author>
            <date month="September" year="2024"/>
          </front>
        </reference>
        <reference anchor="TS133.501" target="https://www.etsi.org/deliver/etsi_ts/133500_133599/133501/18.09.00_60/ts_133501v180900p.pdf" quoteTitle="true" derivedAnchor="TS133.501">
          <front>
            <title>5G; Security architecture and procedures for 5G System</title>
            <author>
              <organization showOnFrontPage="true">ETSI</organization>
            </author>
            <date month="April" year="2025"/>
          </front>
          <seriesInfo name="ETSI TS" value="133 501"/>
          <refcontent>V18.9.0</refcontent>
        </reference>
      </references>
    </references>
    <section anchor="flow-of-operation-dtls" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-flow-of-operation-dtls-esta">Flow of Operation (DTLS Establishment)</name>
      <t indent="0" pn="section-appendix.a-1">CoAP-EAP makes it possible to derive a Pre-Shared Key (PSK) from the MSK to allow (D)TLS PSK-based authentication between the EAP peer and the EAP authenticator instead of using OSCORE. In the case of using (D)TLS to establish a security association, there is a limitation on the use of intermediaries between the EAP peer and the EAP authenticator, as (D)TLS breaks the end-to-end communications when using intermediaries such as proxies.</t>
      <t indent="0" pn="section-appendix.a-2"><xref target="fig-dtls" format="default" sectionFormat="of" derivedContent="Figure 9"/> shows the last steps of the flow of operation for CoAP-EAP when (D)TLS is used to protect the communication between the EAP peer and the EAP authenticator using the keying material exported by the EAP authentication. The general flow is essentially the same as in the case of OSCORE, except that DTLS negotiation is established in Step 7. Once DTLS negotiation has finished successfully, the EAP peer is granted access to the domain. Step 7 <bcp14>MUST</bcp14> be interpreted by the EAP peer as an alternate success indication, which will end up with the MSK and the DTLS_PSK derivation for the (D)TLS authentication based on the PSK.</t>
      <figure anchor="fig-dtls" align="left" suppress-title="false" pn="figure-9">
        <name slugifiedName="name-coap-eap-flow-of-operation-w">CoAP-EAP Flow of Operation with DTLS</name>
        <artset pn="section-appendix.a-3.1">
          <artwork type="svg" align="center" pn="section-appendix.a-3.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="504" viewBox="0 0 504 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 32,176 L 32,192" fill="none" stroke="black"/>
              <path d="M 88,80 L 88,208" fill="none" stroke="black"/>
              <path d="M 424,80 L 424,208" fill="none" stroke="black"/>
              <path d="M 448,144 L 448,160" fill="none" stroke="black"/>
              <path d="M 16,48 L 112,48" fill="none" stroke="black"/>
              <path d="M 336,48 L 432,48" fill="none" stroke="black"/>
              <path d="M 96,112 L 416,112" fill="none" stroke="black"/>
              <path d="M 96,160 L 416,160" fill="none" stroke="black"/>
              <path d="M 96,190 L 192,190" fill="none" stroke="black"/>
              <path d="M 96,194 L 192,194" fill="none" stroke="black"/>
              <path d="M 328,190 L 416,190" fill="none" stroke="black"/>
              <path d="M 328,194 L 416,194" fill="none" stroke="black"/>
              <path d="M 144,224 L 160,224" fill="none" stroke="black"/>
              <path d="M 352,224 L 368,224" fill="none" stroke="black"/>
              <polygon class="arrowhead" points="456,160 444,154.4 444,165.6" fill="black" transform="rotate(90,448,160)"/>
              <polygon class="arrowhead" points="424,112 412,106.4 412,117.6" fill="black" transform="rotate(0,416,112)"/>
              <polygon class="arrowhead" points="376,224 364,218.4 364,229.6" fill="black" transform="rotate(0,368,224)"/>
              <polygon class="arrowhead" points="152,224 140,218.4 140,229.6" fill="black" transform="rotate(180,144,224)"/>
              <polygon class="arrowhead" points="104,160 92,154.4 92,165.6" fill="black" transform="rotate(180,96,160)"/>
              <polygon class="arrowhead" points="40,192 28,186.4 28,197.6" fill="black" transform="rotate(90,32,192)"/>
              <g class="text">
                <text x="40" y="36">EAP</text>
                <text x="76" y="36">peer</text>
                <text x="344" y="36">EAP</text>
                <text x="416" y="36">authenticator</text>
                <text x="216" y="68">...</text>
                <text x="116" y="84">2.01</text>
                <text x="168" y="84">Created</text>
                <text x="256" y="84">Location-Path</text>
                <text x="364" y="84">[/a/eap/(n)]</text>
                <text x="176" y="100">Payload(EAP-X-Resp)</text>
                <text x="76" y="116">6)</text>
                <text x="448" y="132">MSK</text>
                <text x="172" y="148">(D)TLS</text>
                <text x="216" y="148">1.3</text>
                <text x="260" y="148">Client</text>
                <text x="312" y="148">Hello</text>
                <text x="32" y="164">MSK</text>
                <text x="76" y="164">7)</text>
                <text x="468" y="180">DTLS_PSK</text>
                <text x="220" y="196">DTLS</text>
                <text x="280" y="196">handshake</text>
                <text x="36" y="212">DTLS_PSK</text>
                <text x="208" y="228">Protected</text>
                <text x="268" y="228">with</text>
                <text x="316" y="228">(D)TLS</text>
              </g>
            </svg>
          </artwork>
          <artwork type="ascii-art" align="center" pn="section-appendix.a-3.1.2">
    EAP peer                              EAP authenticator
  -------------                           -------------
                          ...
            | 2.01 Created Location-Path [/a/eap/(n)] |
            | Payload(EAP-X-Resp)                     |
          6)|----------------------------------------&gt;|
            |                                         | MSK
            |       (D)TLS 1.3 Client Hello           |  |
    MSK   7)|&lt;----------------------------------------|  v
     |      |                                         | DTLS_PSK
     v      |============= DTLS handshake ============|
  DTLS_PSK  |                                         |
                  &lt;-- Protected with (D)TLS --&gt;
</artwork>
        </artset>
      </figure>
      <t indent="0" pn="section-appendix.a-4">According to <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>, the provision of the PSK out of band also requires the provision of the KDF hash algorithm and the PSK identity. To simplify the design in CoAP-EAP, the KDF hash algorithm can be included in the list of cipher suites exchanged in Steps 1 and 2 (<xref target="figure8" format="default" sectionFormat="of" derivedContent="Figure 8"/>) if one wants to use DTLS instead of OSCORE. For the same reason, the PSK identity is derived from RID-C || RID-I as defined in <xref target="dtls-psk" format="default" sectionFormat="of" derivedContent="Appendix A.1"/>.</t>
      <t indent="0" pn="section-appendix.a-5">Analogous to how the cipher suite is negotiated for OSCORE (<xref target="crypto-negotiation" format="default" sectionFormat="of" derivedContent="Section 6.1"/>), the EAP authenticator sends a list, in decreasing order of preference, with the identifiers of the hash algorithms supported (Step 1). In the response, the EAP peer sends its choice.</t>
      <t indent="0" pn="section-appendix.a-6">This list is included in the payload after the EAP message with a CBOR array that contains the cipher suites. This CBOR array is enclosed as one of the elements of the CBOR Object used for transporting information in CoAP-EAP (see <xref target="cbor-coap-eap" format="default" sectionFormat="of" derivedContent="Section 5"/>).   An example of how the fields are arranged in the CoAP payload can be seen in <xref target="figure7" format="default" sectionFormat="of" derivedContent="Figure 7"/>.</t>
      <t indent="0" pn="section-appendix.a-7">If there is no CBOR array specifying the cipher suites, the default cipher suites are applied. If the EAP authenticator sends a restricted list of cipher suites that can be accepted, it <bcp14>MUST</bcp14> include the default value 0, since it is mandatory to implement. The EAP peer will have at least that option available.</t>
      <t indent="0" pn="section-appendix.a-8">For DTLS, the negotiated cipher suite is used to determine the hash function to be used to derive the "DTLS_PSK" from the MSK. The following hash algorithms are considered in cases where the specification includes DTLS support in the future:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-appendix.a-9">
        <li pn="section-appendix.a-9.1">
          <t indent="0" pn="section-appendix.a-9.1.1">5) TLS_SHA256</t>
        </li>
        <li pn="section-appendix.a-9.2">
          <t indent="0" pn="section-appendix.a-9.2.1">6) TLS_SHA384</t>
        </li>
        <li pn="section-appendix.a-9.3">
          <t indent="0" pn="section-appendix.a-9.3.1">7) TLS_SHA512</t>
        </li>
      </ul>
      <t indent="0" pn="section-appendix.a-10">The inclusion of these values, apart from indicating the hash algorithm, indicates that the EAP authenticator intends to establish an OSCORE security association or a DTLS security association after the authentication is completed. If both options appear in the cipher suite negotiation, the OSCORE security association will be preferred over DTLS.</t>
      <section anchor="dtls-psk" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.a.1">
        <name slugifiedName="name-deriving-dtls_psk-and-ident">Deriving DTLS_PSK and Identity</name>
        <t indent="0" pn="section-appendix.a.1-1">To enable DTLS after an EAP authentication, Identity and the PSK for DTLS are defined. Identity in this case is generated by concatenating the exchanged Sender ID and the Recipient ID.</t>
        <artwork align="left" pn="section-appendix.a.1-2">
                CoAP-EAP PSK Identity = RID-C || RID-I
</artwork>
        <t indent="0" pn="section-appendix.a.1-3">It is also possible to derive a PSK for DTLS <xref target="RFC9147" format="default" sectionFormat="of" derivedContent="RFC9147"/>, referred to here as "DTLS_PSK", from the MSK between both the EAP peer and EAP authenticator if required. The length of the DTLS_PSK will depend on the cipher suite. To have keying material with sufficient length, a key of 32 bytes is derived that can be truncated later if needed:</t>
        <artwork align="left" pn="section-appendix.a.1-4">
                DTLS_PSK = KDF(MSK, "CoAP-EAP DTLS_PSK", length)
</artwork>
        <t indent="0" pn="section-appendix.a.1-5">where:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-appendix.a.1-6">
          <li pn="section-appendix.a.1-6.1">
            <t indent="0" pn="section-appendix.a.1-6.1.1">The MSK is exported by the EAP method.</t>
          </li>
          <li pn="section-appendix.a.1-6.2">
            <t indent="0" pn="section-appendix.a.1-6.2.1">"CoAP-EAP DTLS_PSK" is the ASCII code representation of the non-NULL-terminated string (excluding the double quotes around it).</t>
          </li>
          <li pn="section-appendix.a.1-6.3">
            <t indent="0" pn="section-appendix.a.1-6.3.1">length is the size of the output key material.</t>
          </li>
        </ul>
      </section>
    </section>
    <section anchor="using-coap-eap-for-distributing-key-material-for-iot-networks" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-using-coap-eap-for-distribu">Using CoAP-EAP for Distributing Key Material for IoT Networks</name>
      <t indent="0" pn="section-appendix.b-1">Similarly to the example in <xref target="dtls-psk" format="default" sectionFormat="of" derivedContent="Appendix A.1"/>, where a PSK for DTLS is derived, it is possible to provide key material to different link layers after the CoAP-EAP authentication is complete.</t>
      <t indent="0" pn="section-appendix.b-2">For example, CoAP-EAP could be used to derive the PSK required to run the Constrained Join Protocol (CoJP) for IPv6 over the TSCH mode of IEEE 802.15.4e (6TiSCH) <xref target="RFC9031" format="default" sectionFormat="of" derivedContent="RFC9031"/>. ("TSCH" stands for "Time-Slotted Channel Hopping".)</t>
      <t indent="0" pn="section-appendix.b-3">Another example would be when a shared Network Key is required by the devices that join a network. An example of this Network Key can be found in the THREAD protocol <xref target="THREAD" format="default" sectionFormat="of" derivedContent="THREAD"/>. After CoAP-EAP execution, a security association based on OSCORE protects any exchange between the EAP peer and the EAP authenticator. This security association can be used for distributing the Network Key securely and other required parameters. How the Network Key is distributed after a successful CoAP-EAP authentication is outside the scope of this document.</t>
      <t indent="0" pn="section-appendix.b-4">How a particular link-layer technology uses the MSK to derive further key material for protecting the link layer or uses OSCORE protection to distribute key material is outside the scope of this document.</t>
    </section>
    <section anchor="examples-of-use-case-scenario" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-example-use-case-scenarios">Example Use Case Scenarios</name>
      <t indent="0" pn="section-appendix.c-1">In IoT networks, for an EAP peer to act as a trustworthy entity within a security domain, certain key material needs to be shared between the EAP peer and the EAP authenticator.</t>
      <t indent="0" pn="section-appendix.c-2">Next, examples of different use case scenarios will be elaborated on as related to the usage of CoAP-EAP.</t>
      <t indent="0" pn="section-appendix.c-3">Generally, four entities are involved:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-appendix.c-4">
        <li pn="section-appendix.c-4.1">
          <t indent="0" pn="section-appendix.c-4.1.1">Two EAP peers (A and B).</t>
        </li>
        <li pn="section-appendix.c-4.2">
          <t indent="0" pn="section-appendix.c-4.2.1">One EAP authenticator (C). The EAP authenticator manages a domain where EAP peers can be deployed. In IoT networks, it can be considered a more powerful machine than the EAP peers.</t>
        </li>
        <li pn="section-appendix.c-4.3">
          <t indent="0" pn="section-appendix.c-4.3.1">One AAA server. Optional. The AAA server is not constrained. Here, the EAP authenticator is operating in pass-through mode.</t>
        </li>
      </ul>
      <t indent="0" pn="section-appendix.c-5">Generally, any EAP peer wanting to join the domain managed by the EAP authenticator <bcp14>MUST</bcp14> perform a CoAP-EAP authentication with the EAP authenticator (C). This authentication <bcp14>MAY</bcp14> involve an external AAA server.  This means that the EAP peers (A and B), once deployed, will run CoAP-EAP once, as a bootstrapping phase, to establish a security association with C. Moreover, any other entity that wants to join and establish communications with EAP peers under
C's domain must also do the same.</t>
      <t indent="0" pn="section-appendix.c-6">By using EAP, the flexibility of having different types of credentials can be achieved. For instance, if a device that is not battery dependent and not very constrained is available, a heavier authentication method could be used. With varied EAP peers and networks, authentication methods that are more lightweight (e.g., EAP-NOOB <xref target="RFC9140" format="default" sectionFormat="of" derivedContent="RFC9140"/>, EAP-AKA' <xref target="RFC5448" format="default" sectionFormat="of" derivedContent="RFC5448"/>, EAP-PSK <xref target="RFC4764" format="default" sectionFormat="of" derivedContent="RFC4764"/>, EAP-EDHOC <xref target="I-D.ietf-emu-eap-edhoc" format="default" sectionFormat="of" derivedContent="EAP-EDHOC"/>, etc.) and
are able to adapt to different types of devices according to organization policies or device capabilities might need to be used.</t>
      <section anchor="example-1-coap-eap-in-ace" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.1">
        <name slugifiedName="name-example-1-coap-eap-using-ac">Example 1:  CoAP-EAP Using ACE</name>
        <t indent="0" pn="section-appendix.c.1-1">When using ACE, the process of client registration and provisioning of credentials to the client is not specified. The process of client registration and provisioning can be achieved using CoAP-EAP. Once the process of authentication with EAP is completed, the fresh key material is shared between the EAP peer and the EAP authenticator. With ACE, the EAP authenticator and the Authorization Server (AS) can be co-located.</t>
        <t indent="0" pn="section-appendix.c.1-2">Next, a general way to exemplify how client registration can be performed using CoAP-EAP is presented, to allow two EAP peers (A and B) to communicate and interact after a successful client registration.</t>
        <t indent="0" pn="section-appendix.c.1-3">EAP peer A wants to communicate with EAP peer B (e.g., to activate a light switch).  The overall process is divided into three phases.</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-appendix.c.1-4">
          <li pn="section-appendix.c.1-4.1">
            <t indent="0" pn="section-appendix.c.1-4.1.1">In the first phase, EAP peer A does not yet belong to EAP authenticator C's domain.  Then, it communicates with C and authenticates with CoAP-EAP, which, optionally, communicates with the AAA server to complete the authentication process. If the authentication is successful, a fresh MSK is shared between C and EAP peer A. This key material allows EAP peer A to establish a security association with C. Some authorization information may also be provided in this step. If EAP is used in standalone mode, the AS itself, having information about the devices, can be the entity providing said authorization information.</t>
            <t indent="0" pn="section-appendix.c.1-4.1.2">If authentication and authorization are correct, EAP peer A is enrolled in EAP authenticator C's domain for some period of time. In particular, <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/> recommends 8 hours, though the entity providing the authorization information can establish this lifetime.  In the same manner, B needs to perform the same process with CoAP-EAP to be part of EAP authenticator C's domain.</t>
          </li>
          <li pn="section-appendix.c.1-4.2">
            <t indent="0" pn="section-appendix.c.1-4.2.1">In the second phase, when EAP peer A wants to talk to EAP peer B, it contacts EAP authenticator C for authorization to access EAP peer B and obtain all the required information to do that securely (e.g., keys, tokens, authorization information, etc.).  This phase does NOT require the usage of CoAP-EAP.  The details of this phase are outside the scope of this document; the ACE framework is used for this purpose. See <xref target="RFC9200" format="default" sectionFormat="of" derivedContent="RFC9200"/>.</t>
          </li>
          <li pn="section-appendix.c.1-4.3">
            <t indent="0" pn="section-appendix.c.1-4.3.1">In the third phase, EAP peer A can access EAP peer B with the credentials and information obtained from EAP authenticator C during the second phase. This access can be repeated without contacting the EAP authenticator, as long as the credentials given to A are still valid.  The details of this phase are outside the scope of this document.</t>
          </li>
        </ul>
        <t indent="0" pn="section-appendix.c.1-5">It is worth noting that to join EAP authenticator C's domain, the first phase (authentication via CoAP-EAP) is required.  Once it is performed successfully, the communications are local to EAP authenticator C's domain and there is no need to perform a new EAP authentication as long as the key material is still valid. When the keys are about to expire, the EAP peer can engage in a re-authentication to renew the key material,
as explained in <xref target="re-authentication" format="default" sectionFormat="of" derivedContent="Section 3.3"/>.</t>
      </section>
      <section anchor="example-2-multi-domain-with-aaa-infrastructures" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.2">
        <name slugifiedName="name-example-2-multiple-domains-">Example 2: Multiple Domains with AAA Infrastructures</name>
        <t indent="0" pn="section-appendix.c.2-1">A device (A) of the domain acme.org uses a specific kind of credential
and intends to join the um.es domain. This user does not belong to this domain, for which it first performs a client registration using CoAP-EAP. To do this, it interacts with the EAP authenticator's domain, which in turn communicates with a AAA infrastructure (acting as a AAA client). Then, the local AAA server communicates with the home AAA server to complete the authentication. This way, the device can be considered as a trustworthy entity within EAP authenticator C's domain. In this scenario, the AS, in the role of the EAP authenticator, receives the key material from the AAA infrastructure.</t>
      </section>
      <section anchor="example-3-single-domain-with-aaa-infrastructure" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.3">
        <name slugifiedName="name-example-3-single-domain-wit">Example 3: Single Domain with a AAA Infrastructure</name>
        <t indent="0" pn="section-appendix.c.3-1">In this scenario, a university campus has several faculty buildings, where each building has its criteria or policies in place to manage EAP peers under an AS. All buildings belong to the same domain (e.g., um.es). All these buildings are managed with a AAA infrastructure. A new device (A) with credentials from the domain (e.g., um.es) will be able to perform the device registration with an EAP authenticator (C) of any building if they are managed by the same general domain.</t>
      </section>
      <section anchor="example-4-single-domain-without-aaa-infrastructure" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.4">
        <name slugifiedName="name-example-4-single-domain-wit">Example 4: Single Domain Without a AAA Infrastructure</name>
        <t indent="0" pn="section-appendix.c.4-1">In another case, without a AAA infrastructure, with an EAP authenticator that has co-located the EAP server, and using EAP standalone mode, all the devices can be managed within the same domain locally. Client registration of an EAP peer (A) with a Controller (C) can also be performed in the same manner.</t>
      </section>
      <section anchor="other-use-cases" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5">
        <name slugifiedName="name-other-use-cases">Other Use Cases</name>
        <section anchor="coap-eap-network-access-control" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5.1">
          <name slugifiedName="name-coap-eap-for-network-access">CoAP-EAP for Network Access Authentication</name>
          <t indent="0" pn="section-appendix.c.5.1-1">One of the first steps for an EAP peer is to perform the authentication to gain access to the network. To do so, the device must first be authenticated and granted authorization to gain access to the network. Additionally, security parameters such as credentials can be derived from the authentication process, allowing the trustworthy operation of the EAP peer in a particular network by joining the security domain. By using EAP, this can be achieved with flexibility and scalability, because of the different EAP methods available and the ability to rely on AAA infrastructures if needed to support multi-domain scenarios, which is a key feature when the EAP peers deployed under the same security domain belong, for example, to different organizations.</t>
          <t indent="0" pn="section-appendix.c.5.1-2">The following two cases apply to the process of joining a network:
1) the node has an IPv6 address (e.g., link-local IPv6 or IPv6 global address) and 2) the node does not have an IPv6 address.</t>
          <t indent="0" pn="section-appendix.c.5.1-3">In networks where the device is in place but no IP support is available until the EAP peer is authenticated, specific support for this EAP lower layer has to be defined to allow CoAP-EAP messages to be exchanged between the EAP peer and the EAP authenticator. For example, in IEEE 802.15.4 networks, a new Key Management
Protocol (KMP) ID can be defined to add such support in the case of IEEE 802.15.9 <xref target="IEEE802159" format="default" sectionFormat="of" derivedContent="IEEE802159"/>, where it can be assumed that the device has at least a link-layer IPv6 address.</t>
          <t indent="0" pn="section-appendix.c.5.1-4">When the EAP peer intends to be admitted into the network, it would search for an entity that offers the CoAP-EAP service, be it directly via the EAP authenticator or through an intermediary (e.g., proxy). See <xref target="discovery-section" format="default" sectionFormat="of" derivedContent="Section 3.1"/>.</t>
          <t indent="0" pn="section-appendix.c.5.1-5">CoAP-EAP will run between the EAP peer and the EAP authenticator or through an intermediary entity such as a proxy, as happens in a mesh network, where the EAP authenticator could be placed one or more hops away from the EAP peer. In the case that a proxy participates in CoAP-EAP, it will be because it is already a trustworthy entity within the domain and communicates through a secure channel with the EAP authenticator, as illustrated by <xref target="fig-network-proxy" format="default" sectionFormat="of" derivedContent="Figure 10"/>.</t>
          <t indent="0" pn="section-appendix.c.5.1-6">If the EAP peer cannot connect to the EAP authenticator directly, the
EAP peer can follow the same process as that described in
<xref target="proxy" format="default" sectionFormat="of" derivedContent="Section 3.6"/> to perform the authentication (i.e., can connect via
an intermediary entity (e.g., proxy) that is already part of the network (already shares
key material and communicates through a secure channel with the authenticator) and
can aid in running CoAP-EAP).</t>
          <t indent="0" pn="section-appendix.c.5.1-7">When CoAP-EAP is completed and the OSCORE security association is established with the EAP authenticator, the EAP peer receives the local configuration parameters for the network (e.g., a Network Key) and can configure a global IPv6 address. Moreover, there is no need for an intermediary entity after a successful authentication.</t>
          <t indent="0" pn="section-appendix.c.5.1-8">For removal, if the EAP authenticator decides to remove a particular EAP peer from the network or the peer itself intends to leave, either the EAP peer or the EAP authenticator can directly send a DELETE command to explicitly express that the network access state is removed, and the device will no longer belong to the network. Thus, any state related to the EAP peer is removed in the EAP authenticator. Forced removal can be done by sending new specific key material to the devices that still belong to the network, excluding the removed device, following a model similar to CoJP for 6TiSCH <xref target="RFC9031" format="default" sectionFormat="of" derivedContent="RFC9031"/>. The specifics on how this process is to be done are outside the scope of this document.</t>
          <figure anchor="fig-network-proxy" align="left" suppress-title="false" pn="figure-10">
            <name slugifiedName="name-coap-eap-through-coap-proxy">CoAP-EAP Through CoAP Proxy</name>
            <artset pn="section-appendix.c.5.1-9.1">
              <artwork type="svg" align="center" pn="section-appendix.c.5.1-9.1.1"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="568" viewBox="0 0 568 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,80" fill="none" stroke="black"/>
                  <path d="M 72,32 L 72,80" fill="none" stroke="black"/>
                  <path d="M 144,32 L 144,80" fill="none" stroke="black"/>
                  <path d="M 216,32 L 216,80" fill="none" stroke="black"/>
                  <path d="M 440,32 L 440,80" fill="none" stroke="black"/>
                  <path d="M 560,32 L 560,80" fill="none" stroke="black"/>
                  <path d="M 8,32 L 72,32" fill="none" stroke="black"/>
                  <path d="M 144,32 L 216,32" fill="none" stroke="black"/>
                  <path d="M 440,32 L 560,32" fill="none" stroke="black"/>
                  <path d="M 80,64 L 136,64" fill="none" stroke="black"/>
                  <path d="M 224,64 L 432,64" fill="none" stroke="black"/>
                  <path d="M 8,80 L 72,80" fill="none" stroke="black"/>
                  <path d="M 144,80 L 216,80" fill="none" stroke="black"/>
                  <path d="M 440,80 L 560,80" fill="none" stroke="black"/>
                  <path d="M 224,112 L 240,112" fill="none" stroke="black"/>
                  <path d="M 424,112 L 440,112" fill="none" stroke="black"/>
                  <polygon class="arrowhead" points="448,112 436,106.4 436,117.6" fill="black" transform="rotate(0,440,112)"/>
                  <polygon class="arrowhead" points="440,64 428,58.4 428,69.6" fill="black" transform="rotate(0,432,64)"/>
                  <polygon class="arrowhead" points="232,112 220,106.4 220,117.6" fill="black" transform="rotate(180,224,112)"/>
                  <polygon class="arrowhead" points="232,64 220,58.4 220,69.6" fill="black" transform="rotate(180,224,64)"/>
                  <polygon class="arrowhead" points="144,64 132,58.4 132,69.6" fill="black" transform="rotate(0,136,64)"/>
                  <polygon class="arrowhead" points="88,64 76,58.4 76,69.6" fill="black" transform="rotate(180,80,64)"/>
                  <g class="text">
                    <text x="32" y="52">EAP</text>
                    <text x="180" y="52">CoAP</text>
                    <text x="480" y="52">EAP</text>
                    <text x="36" y="68">peer</text>
                    <text x="184" y="68">proxy</text>
                    <text x="504" y="68">authenticator</text>
                    <text x="108" y="84">CoAP</text>
                    <text x="324" y="84">CoAP</text>
                    <text x="328" y="100">OSCORE/DTLS</text>
                    <text x="284" y="116">security</text>
                    <text x="368" y="116">association</text>
                  </g>
                </svg>
              </artwork>
              <artwork type="ascii-art" align="center" pn="section-appendix.c.5.1-9.1.2">
  +-------+        +--------+                           +--------------+
  | EAP   |        |  CoAP  |                           |   EAP        |
  | peer  |&lt;------&gt;|  proxy |&lt;-------------------------&gt;| authenticator|
  +-------+  CoAP  +--------+           CoAP            +--------------+
                                      OSCORE/DTLS
                              &lt;-- security association --&gt;
</artwork>
            </artset>
          </figure>
          <t indent="0" pn="section-appendix.c.5.1-10">Given that EAP is also used for network access authentication, this service can be adapted to other technologies -- for instance, to provide network access control to very constrained technologies (e.g., Long Range (LoRa) networks). The authors of <xref target="LO-CoAP-EAP" format="default" sectionFormat="of" derivedContent="LO-CoAP-EAP"/> provide a study of a minimal version of CoAP-EAP for LPWANs, with interesting results. In this specific case, compression as provided by Static Context Header Compression (SCHC) for CoAP <xref target="RFC8824" format="default" sectionFormat="of" derivedContent="RFC8824"/> can be leveraged.</t>
        </section>
        <section anchor="coap-eap-for-service-authentication" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5.2">
          <name slugifiedName="name-coap-eap-for-service-authen">CoAP-EAP for Service Authentication</name>
          <t indent="0" pn="section-appendix.c.5.2-1">It is not uncommon that the infrastructure where the device is deployed and the services of the EAP peer are managed by different organizations. Therefore, in addition to the authentication for network access control, the possibility of a secondary authentication to access different services has to be considered. This process of authentication, for example, will provide the necessary key material to establish a secure channel and interact with the entity in charge of granting access to different services.</t>
          <t indent="0" pn="section-appendix.c.5.2-2">In 5G, for example, consider primary and secondary authentication using EAP <xref target="TS133.501" format="default" sectionFormat="of" derivedContent="TS133.501"/>.</t>
        </section>
      </section>
    </section>
    <section numbered="false" anchor="acknowledgments" removeInRFC="false" toc="include" pn="section-appendix.d">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.d-1">We would like to thank the reviewers of this work: <contact fullname="Paul Wouters"/>, <contact fullname="Heikki Vatiainen"/>,
      <contact fullname="Josh Howlett"/>, <contact fullname="Deb Cooley"/>,
      <contact fullname="Eliot Lear"/>, <contact fullname="Alan DeKok"/>,
      <contact fullname="Carsten Bormann"/>, <contact fullname="Mohit       Sethi"/>, <contact fullname="Benjamin Kaduk"/>, <contact fullname="Christian Amsüss"/>, <contact fullname="John Preuß Mattsson"/>,
      <contact fullname="Göran Selander"/>, <contact fullname="Alexandre       Petrescu"/>, <contact fullname="Pedro Moreno-Sanchez"/>, and <contact fullname="Eduardo Ingles-Sanchez"/>.</t>
      <t indent="0" pn="section-appendix.d-2">We would also like to thank <contact fullname="Gabriel       Lopez-Millan"/> for the first review of this document, <contact fullname="Ivan Jimenez-Sanchez"/> for the first
      proof-of-concept implementation of this idea, <contact fullname="Julian       Niklas Schimmelpfennig"/> for the implementation of the Erbium-based IoT
      device implementation, and <contact fullname="Daniel Menendez       Gonzalez"/> for the Python implementation.</t>
      <t indent="0" pn="section-appendix.d-3">Thanks also to <contact fullname="Alexander Pelov"/> and <contact fullname="Laurent Toutain"/> for their valuable comments, especially regarding the
      potential optimizations of CoAP-EAP.</t>
      <t indent="0" pn="section-appendix.d-4">This work was supported in part by Grant PID2020-112675RB-C44 funded
      by MCIN/AEI/10.13039/5011000011033 (ONOFRE-3-UMU) and in part by the
      H2020 EU project IoTCrawler under contract 779852.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.e">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="R." surname="Marin-Lopez" fullname="Rafa Marin-Lopez">
        <organization abbrev="University of Murcia" showOnFrontPage="true">University of Murcia</organization>
        <address>
          <postal>
            <street>Campus de Espinardo S/N, Faculty of Computer Science</street>
            <city>Murcia</city>
            <code>30100</code>
            <country>Spain</country>
          </postal>
          <email>rafa@um.es</email>
        </address>
      </author>
      <author initials="D." surname="Garcia-Carrillo" fullname="Dan Garcia-Carrillo">
        <organization abbrev="University of Oviedo" showOnFrontPage="true">University of Oviedo</organization>
        <address>
          <postal>
            <street>Calle Luis Ortiz Berrocal S/N, Edificio Polivalente</street>
            <city>Gijon</city>
            <region>Asturias</region>
            <code>33203</code>
            <country>Spain</country>
          </postal>
          <email>garciadan@uniovi.es</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
