<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" docName="draft-ietf-bess-evpn-virtual-eth-segment-19" number="9784" obsoletes="" updates="" consensus="true" submissionType="IETF" ipr="trust200902" tocInclude="true" tocDepth="4" symRefs="true" sortRefs="true" xml:lang="en" prepTime="2025-06-27T14:56:37" indexInclude="true" scripts="Common,Latin">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-bess-evpn-virtual-eth-segment-19" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9784" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="EVPN Virtual Ethernet Segments">Virtual Ethernet Segments for EVPN and Provider Backbone Bridge EVPN</title>
    <seriesInfo name="RFC" value="9784" stream="IETF"/>
    <author initials="A" surname="Sajassi" fullname="Ali Sajassi">
      <organization showOnFrontPage="true">Cisco Systems</organization>
      <address>
        <email>sajassi@cisco.com</email>
      </address>
    </author>
    <author initials="P" surname="Brissette" fullname="Patrice Brissette">
      <organization showOnFrontPage="true">Cisco Systems</organization>
      <address>
        <email>pbrisset@cisco.com</email>
      </address>
    </author>
    <author initials="R" surname="Schell" fullname="Rick Schell">
      <organization showOnFrontPage="true">Independent</organization>
      <address>
        <email>rick_schell@outlook.com</email>
      </address>
    </author>
    <author initials="J" surname="Drake" fullname="John E. Drake">
      <organization showOnFrontPage="true">Independent</organization>
      <address>
        <email>je_drake@yahoo.com</email>
      </address>
    </author>
    <author initials="J" surname="Rabadan" fullname="Jorge Rabadan">
      <organization showOnFrontPage="true">Nokia</organization>
      <address>
        <email>jorge.rabadan@nokia.com</email>
      </address>
    </author>
    <date month="06" year="2025"/>
    <area>RTG</area>
    <workgroup>bess</workgroup>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
   Ethernet VPN (EVPN) and Provider Backbone Bridge EVPN (PBB-EVPN) introduce a 
   comprehensive suite of solutions for delivering Ethernet services over 
   MPLS/IP networks. These solutions offer advanced  
   multihoming capabilities. Specifically, they support Single-Active and 
   All-Active redundancy modes for an Ethernet Segment (ES), which is defined 
   as a collection of physical links connecting a multihomed device or network 
   to a set of Provider Edge (PE) devices. This document extends the concept of 
   an ES by allowing an ES to be associated with a set of Ethernet 
   Virtual Circuits (EVCs), such as VLANs, or other entities, including MPLS Label 
   Switched Paths (LSPs) or pseudowires (PWs). This extended concept is referred 
   to as virtual Ethernet Segments (vESes). This document lists the requirements 
   and specifies the necessary extensions to support vES in both EVPN and PBB-EVPN.    
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9784" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-language">Requirements Language</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.2.1"><xref derivedContent="1.2" format="counter" sectionFormat="of" target="section-1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-veses-in-access-ethernet-ne">vESes in Access Ethernet Networks</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.3">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.3.1"><xref derivedContent="1.3" format="counter" sectionFormat="of" target="section-1.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-veses-in-access-mpls-networ">vESes in Access MPLS Networks</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology">Terminology</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements">Requirements</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-homed-and-multihomed">Single-Homed and Multihomed vES</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.2">
                <t indent="0" pn="section-toc.1-1.3.2.2.1"><xref derivedContent="3.2" format="counter" sectionFormat="of" target="section-3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-local-switching">Local Switching</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.3">
                <t indent="0" pn="section-toc.1-1.3.2.3.1"><xref derivedContent="3.3" format="counter" sectionFormat="of" target="section-3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-evc-service-types">EVC Service Types</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.4">
                <t indent="0" pn="section-toc.1-1.3.2.4.1"><xref derivedContent="3.4" format="counter" sectionFormat="of" target="section-3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-designated-forwarder-df-ele">Designated Forwarder (DF) Election</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.5">
                <t indent="0" pn="section-toc.1-1.3.2.5.1"><xref derivedContent="3.5" format="counter" sectionFormat="of" target="section-3.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-evc-monitoring">EVC Monitoring</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.6">
                <t indent="0" pn="section-toc.1-1.3.2.6.1"><xref derivedContent="3.6" format="counter" sectionFormat="of" target="section-3.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-failure-and-recovery">Failure and Recovery</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.7">
                <t indent="0" pn="section-toc.1-1.3.2.7.1"><xref derivedContent="3.7" format="counter" sectionFormat="of" target="section-3.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fast-convergence">Fast Convergence</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-solution-overview">Solution Overview</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-evpn-df-election-for-ves">EVPN DF Election for vES</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-grouping-and-route-coloring">Grouping and Route Coloring for vES</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.2.2">
                  <li pn="section-toc.1-1.4.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.1.1"><xref derivedContent="4.2.1" format="counter" sectionFormat="of" target="section-4.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-evpn-route-coloring-for-ves">EVPN Route Coloring for vES</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.2.1"><xref derivedContent="4.2.2" format="counter" sectionFormat="of" target="section-4.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-pbb-evpn-route-coloring-for">PBB-EVPN Route Coloring for vES</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-failure-handling-and-recove">Failure Handling and Recovery</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-evc-failure-handling-for-si">EVC Failure Handling for Single-Active vES in EVPN</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-evc-failure-handling-for-a-">EVC Failure Handling for a Single-Active vES in PBB-EVPN</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-port-failure-handling-for-s">Port Failure Handling for Single-Active vESes in EVPN</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-port-failure-handling-for-si">Port Failure Handling for Single-Active vESes in PBB-EVPN</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.5">
                <t indent="0" pn="section-toc.1-1.5.2.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fast-convergence-in-evpn-an">Fast Convergence in EVPN and PBB-EVPN</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.2">
                <t indent="0" pn="section-toc.1-1.8.2.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1"> Ethernet VPN (EVPN) <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and Provider Backbone Bridge EVPN 
   (PBB-EVPN) <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> introduce 
   a comprehensive suite of solutions for delivering Ethernet services 
   over MPLS/IP networks. These solutions offer advanced 
   multihoming capabilities. Specifically, they support Single-Active and 
   All-Active redundancy modes for an Ethernet Segment (ES). As defined in 
   <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, an ES represents a collection of 
   Ethernet links that connect a customer site to one or more Provider Edge (PE) devices. </t>
      <t indent="0" pn="section-1-2"> This document extends the concept of an ES by allowing an ES to be 
   associated with a set of Ethernet Virtual Circuits (EVCs) (such as VLANs) or other 
   entities, including MPLS Label Switched Paths (LSPs) or pseudowires (PWs). This 
   extended concept is referred to as virtual Ethernet Segments (vESes). This document 
   lists the requirements and specifies the necessary extensions to support vES in both EVPN 
   and PBB-EVPN. The scope of this document includes PBB-EVPN <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/>, 
   EVPN over MPLS <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, and EVPN over IP <xref target="RFC8365" format="default" sectionFormat="of" derivedContent="RFC8365"/>;
   however, it excludes EVPN over SRv6 <xref target="RFC9252" format="default" sectionFormat="of" derivedContent="RFC9252"/>. </t>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-1.1">
        <name slugifiedName="name-requirements-language">Requirements Language</name>
        <t indent="0" pn="section-1.1-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-1.2">
        <name slugifiedName="name-veses-in-access-ethernet-ne">vESes in Access Ethernet Networks</name>
        <t indent="0" pn="section-1.2-1"> Some service providers (SPs) seek to extend the concept of physical 
   Ethernet links in an ES to encompass EVCs, 
   wherein multiple EVCs (such as VLANs) can be aggregated onto a single 
   physical External Network-Network Interface (ENNI). An ES composed 
   of a set of EVCs rather than physical links is referred to as a vES. 
   <xref target="fig-1" format="default" sectionFormat="of" derivedContent="Figure 1"/> illustrates two PE devices (PE1 and PE2), each with 
   an ENNI aggregating several EVCs. Some of these EVCs on a given ENNI 
   can be associated with vESes. For instance, the multihomed vES depicted 
   in <xref target="fig-1" format="default" sectionFormat="of" derivedContent="Figure 1"/> consists of EVC4 on ENNI1 and EVC5 on ENNI2. </t>
        <figure anchor="fig-1" align="left" suppress-title="false" pn="figure-1">
          <name slugifiedName="name-single-homed-devices-and-a-">Single-Homed Devices and a Dual-Homed Device/Network on the Same ENNI</name>
          <artwork align="left" pn="section-1.2-2.1">
                  Third-Party
    +-----+       EAP
    | CE11|EVC1  +---------+     
    +-----+   \  |         |       +---+
    Cust. A    \-0=========0--ENNI1|   |
    +-----+      |         |  ENNI1|   |   +-------+   +---+
    | CE12|EVC2--0=========0--ENNI1|PE1|---|       |   |   |
    +-----+      |         |  ENNI1|   |   |SP     |---|PE3|-
                 |       ==0--ENNI1|   |   |IP/MPLS|   |   | \  +---+
    +-----+      |      /  |       +---+   |Core   |   +---+  \-|   |
    | CE22|EVC3--0==== /   |               |Network|            |CE4|
    +-----+      |    X    |               |       |   +---+    |   |
    Cust. B      |   / \   |       +---+   |       |   |   |  /-|   |
    +-----+     -0===   ===0--ENNI2|   |   |       |---|PE4|-/  +---+
    | CE3 |EVC4/ |         |  ENNI2|PE2|---|       |   |   |
    |     |EVC5--0=========0--ENNI2|   |   +-------+   +---+
    +-----+      |         |       +---+
    Cust. C      +---------+   /\
           /\                  ||
           ||                  ENNI
           EVCs             Interface
    &lt;--------802.1Q----------&gt;  &lt;---- EVPN Network -----&gt; &lt;-802.1Q-&gt;</artwork>
        </figure>
        <t indent="0" pn="section-1.2-3"> ENNIs are commonly used to reach remote
   customer sites via independent Ethernet access networks or third-party
   Ethernet Access Providers (EAPs). ENNIs can
   aggregate traffic from many vESes (e.g., hundreds to thousands), 
   where each vES is represented by its associated EVC on that ENNI. As a result,
   ENNIs and their associated EVCs are key elements of SP external boundaries
   that are carefully designed and closely monitored. As a reminder, 
   the ENNI is the demarcation between the SP (IP/MPLS core network) and the 
   third-party Ethernet Access Provider.
        </t>
        <t indent="0" pn="section-1.2-4"> To meet customers' Service Level Agreements (SLAs), SPs build
   redundancy via multiple EVPN PEs and across multiple ENNIs (as shown
   in <xref target="fig-1" format="default" sectionFormat="of" derivedContent="Figure 1"/>), where a given vES can be multihomed to two or
   more EVPN
   PE devices (on two or more ENNIs) via their associated EVCs. Just
   like physical ESs in the solutions described in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/>, these vESes
   can be single-homed or multihomed ESs, and when multihomed, they
   can operate in either Single-Active or All-Active redundancy modes.
   In a typical SP external-boundary scenario (e.g., with an EAP), an ENNI can be associated with
   several thousands of single-homed vESes, several hundreds of Single-Active
   vESes, and tens or hundreds of All-Active vESes. The specific figures used throughout 
   this document reflect the relative quantities (hundreds, thousands, etc.) of various elements as understood at the time of writing. </t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-1.3">
        <name slugifiedName="name-veses-in-access-mpls-networ">vESes in Access MPLS Networks</name>
        <t indent="0" pn="section-1.3-1"> Other SPs want to extend the concept of
   physical links in an ES to individual PWs or to MPLS
   LSPs in Access MPLS networks, i.e., a vES
   consisting of a set of PWs or a set of LSPs. <xref target="fig-2" format="default" sectionFormat="of" derivedContent="Figure 2"/> illustrates this concept. </t>
        <figure anchor="fig-2" align="left" suppress-title="false" pn="figure-2">
          <name slugifiedName="name-a-dual-homed-and-single-hom">A Dual-Homed and Single-Homed Network on MPLS Aggregation Networks</name>
          <artwork align="left" pn="section-1.3-2.1">
                 MPLS Aggregation
                 Network
   +-----+      +-----------------+
   | CE11|EVC1  |                 |
   +-----+   \ +AG1-+  PW1      +-+---+
   Cust. A    -0----|===========|     |
   +-----+     | ---+===========|     |   +-------+   +---+
   | CE12|EVC2-0/   |  PW2   /\ | PE1 +---+       |   |   |
   +-----+     ++---+      /=||=|     |   |       +---+PE3+-
                |         //=||=|     |   |IP/MPLS|   |   | \  +---+
                |        //  \/ +-+---+   |Core   |   +---+  \-+   |
   +-----+EVC3  |    PW3//  LSP1  |       |Network|            |CE4|
   | CE13|    \+AG2-+==//         |       |       |   +---+    |   |
   +-----+     0    |==/PW4  /\ +-+---+   |       |   |   |  /-+   |
               0    |==PW5===||=|     |   |       +---+PE4+-/  +---+
   +-----+    /++---+==PW6===||=| PE2 +---+       |   |   |
   | CE14|EVC4  |            \/ |     |   +-------+   +---+
   +-----+      |           LSP2+-+---+
   Cust. C      +-----------------+
          /\
          ||
          EVCs
   &lt;--802.1Q--&gt; &lt;-----MPLS Agg----&gt; &lt;--- EVPN Network ---&gt; &lt;-802.1Q-&gt;</artwork>
        </figure>
        <t indent="0" pn="section-1.3-3"> In certain scenarios, SPs utilize MPLS Aggregation Networks 
   that are managed by separate administrative entities or third-party organizations 
   to gain access to their own IP/MPLS core network infrastructure. This situation 
   is depicted in <xref target="fig-2" format="default" sectionFormat="of" derivedContent="Figure 2"/>. </t>
        <t indent="0" pn="section-1.3-4"> In such scenarios, a vES is defined as a set of individual PWs 
	when aggregation is not feasible. If aggregation is possible, the vES can be 
	associated with a group of PWs that share the same unidirectional LSP pair, 
	where the LSP pair consists of the ingress and egress LSPs between the same 
	endpoints. </t>
        <t indent="0" pn="section-1.3-5"> In <xref target="fig-2" format="default" sectionFormat="of" derivedContent="Figure 2"/>, EVC3 is connected to
   a VPWS instance in AG2 that is connected to PE1 and PE2 via PW3 and
   PW5, respectively.  EVC4 is connected to another VPWS instance on
   AG2 that is connected to PE1 and PE2 via PW4 and PW6,
   respectively.  Since the PWs for the two VPWS instances can be
   aggregated into the same LSP pair going to and coming from the MPLS
   network, a common vES can be defined for the four mentioned
   PWs. In <xref target="fig-2" format="default" sectionFormat="of" derivedContent="Figure 2"/>, LSP1 and LSP2 represent the two LSP pairs between PE1
   and AG2 and between PE2 and AG2, respectively. The vES consists of these two LSP
   pairs (LSP1 and LSP2), and each LSP pair has two PWs. This vES will be
   shared by two separate EVPN instances (e.g., EVI-1 and EVI-2) in 
   the EVPN network. PW3 and PW4 are associated with EVI-1 and EVI-2, respectively, 
   on PE1, and PW5 and PW6 are associated with EVI-1 and EVI-2, respectively, on PE2. </t>
        <t indent="0" pn="section-1.3-6"> In some cases, the aggregation of PWs that share the same LSP pair
   may not be possible. For instance, if PW3 were terminated into a third PE, e.g.,
   PE3, instead of PE1, the vES would need to be defined on each PW on each PE.</t>
        <t indent="0" pn="section-1.3-7"> For MPLS/IP access networks where a vES represents a set of LSP 
   pairs or a set of PWs, this document extends the Single-Active multihoming 
   procedures defined in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> to
   accommodate vES. The extension of vES to support All-Active multihoming in 
   MPLS/IP access networks is beyond the scope of this document. </t>
        <t indent="0" pn="section-1.3-8"> This document defines the concept of a vES and specifies the additional extensions 
   necessary to support a vES in accordance with <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and 
   <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/>. <xref target="requirements" format="default" sectionFormat="of" derivedContent="Section 3"/> enumerates the set of 
   requirements for a vES. <xref target="overview" format="default" sectionFormat="of" derivedContent="Section 4"/> details the extensions for a 
   vES applicable to EVPN solutions, including those specified in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> 
   and <xref target="RFC7209" format="default" sectionFormat="of" derivedContent="RFC7209"/>. These extensions are designed to meet the requirements 
   listed in <xref target="requirements" format="default" sectionFormat="of" derivedContent="Section 3"/>. <xref target="overview" format="default" sectionFormat="of" derivedContent="Section 4"/> also provides 
   an overview of the solution, while <xref target="failure" format="default" sectionFormat="of" derivedContent="Section 5"/> addresses failure handling, 
   recovery, scalability, and fast convergence of <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and 
   <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> for vESes. </t>
      </section>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-terminology">Terminology</name>
      <dl newline="false" spacing="normal" indent="10" pn="section-2-1">
        <dt pn="section-2-1.1">AC:</dt>
        <dd pn="section-2-1.2">Attachment Circuit</dd>
        <dt pn="section-2-1.3">B-MAC:</dt>
        <dd pn="section-2-1.4">Backbone MAC Address </dd>
        <dt pn="section-2-1.5">CE:</dt>
        <dd pn="section-2-1.6">Customer Edge</dd>
        <dt pn="section-2-1.7">C-MAC:</dt>
        <dd pn="section-2-1.8">Customer/Client MAC Address </dd>
        <dt pn="section-2-1.9">DF:</dt>
        <dd pn="section-2-1.10">Designated Forwarder</dd>
        <dt pn="section-2-1.11">ENNI:</dt>
        <dd pn="section-2-1.12">External Network-Network Interface </dd>
        <dt pn="section-2-1.13">ES:</dt>
        <dd pn="section-2-1.14">Ethernet Segment </dd>
        <dt pn="section-2-1.15">ESI:</dt>
        <dd pn="section-2-1.16">Ethernet Segment Identifier </dd>
        <dt pn="section-2-1.17">Ethernet A-D:</dt>
        <dd pn="section-2-1.18">Ethernet Auto-Discovery </dd>
        <dt pn="section-2-1.19">EVC:</dt>
        <dd pn="section-2-1.20">Ethernet Virtual Circuit <xref target="MEF63" format="default" sectionFormat="of" derivedContent="MEF63"/> </dd>
        <dt pn="section-2-1.21">EVI:</dt>
        <dd pn="section-2-1.22">EVPN Instance </dd>
        <dt pn="section-2-1.23">EVPN:</dt>
        <dd pn="section-2-1.24">Ethernet VPN </dd>
        <dt pn="section-2-1.25">I-SID:</dt>
        <dd pn="section-2-1.26">Service Instance Identifier (24 bits and global within a PBB
   network; see <xref target="RFC7080" format="default" sectionFormat="of" derivedContent="RFC7080"/>). </dd>
        <dt pn="section-2-1.27">MAC:</dt>
        <dd pn="section-2-1.28">Media Access Control</dd>
        <dt pn="section-2-1.29">PBB:</dt>
        <dd pn="section-2-1.30">Provider Backbone Bridge </dd>
        <dt pn="section-2-1.31">PBB-EVPN:</dt>
        <dd pn="section-2-1.32">Provider Backbone Bridge EVPN </dd>
        <dt pn="section-2-1.33">PE:</dt>
        <dd pn="section-2-1.34">Provider Edge</dd>
        <dt pn="section-2-1.35">VPWS:</dt>
        <dd pn="section-2-1.36">Virtual Private Wire Service</dd>
        <dt pn="section-2-1.37">Single-Active (SA) Redundancy Mode:</dt>
        <dd pn="section-2-1.38">When only a single PE, among a
   group of PEs attached to an ES, is allowed to forward
   traffic to/from that ES, the ES is
   defined as operating in Single-Active redundancy mode. </dd>
        <dt pn="section-2-1.39">All-Active (AA) Redundancy Mode:</dt>
        <dd pn="section-2-1.40">When all PEs attached to an ES are allowed to forward traffic to/from that ES,
   the ES is defined as operating in All-Active
   redundancy mode. </dd>
      </dl>
    </section>
    <section anchor="requirements" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-requirements">Requirements</name>
      <t indent="0" pn="section-3-1"> This section describes the requirements specific to vES for EVPN and PBB-EVPN solutions. These requirements are in
   addition to the ones described in <xref target="RFC8214" format="default" sectionFormat="of" derivedContent="RFC8214"/>, <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, and
   <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/>. </t>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.1">
        <name slugifiedName="name-single-homed-and-multihomed">Single-Homed and Multihomed vES</name>
        <t indent="0" pn="section-3.1-1"> A PE device <bcp14>MUST</bcp14> support the following types of vESes: </t>
        <ol type="(R1%c)" indent="7" spacing="normal" start="1" pn="section-3.1-2">
        <li pn="section-3.1-2.1" derivedCounter="(R1a)">The PE <bcp14>MUST</bcp14> handle single-homed vESes on a
        single physical port, such as a single ENNI. </li>
          <li pn="section-3.1-2.2" derivedCounter="(R1b)">The PE <bcp14>MUST</bcp14> support a combination of
        single-homed vESes and Single-Active multihomed vESes simultaneously
        on a single physical port, such as a single ENNI.  Throughout this
        document, Single-Active multihomed vESes will be referred to as
        "Single-Active vESes". </li>
          <li pn="section-3.1-2.3" derivedCounter="(R1c)">The PE <bcp14>MAY</bcp14> support All-Active multihomed
        vESes on a single physical port.  Throughout this document, All-Active
        multihomed vESes will be referred to as "All-Active vESes". </li>
          <li pn="section-3.1-2.4" derivedCounter="(R1d)">The PE <bcp14>MAY</bcp14> support a combination of
        All-Active vESes along with other types of vESes on a single physical
        port. </li>
          <li pn="section-3.1-2.5" derivedCounter="(R1e)">A multihomed vES, whether Single-Active or All-Active, can
        span across two or more ENNIs on any two or more PEs. </li>
        </ol>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.2">
        <name slugifiedName="name-local-switching">Local Switching</name>
        <t indent="0" pn="section-3.2-1"> Many vESes of different types can be aggregated on a single physical
   port on a PE device and some of these vESes can belong to the same
   service instance (e.g., EVI). This translates into the need for
   supporting local switching among the vESes for the same service
   instance on the same physical port (e.g., ENNI) of the PE. </t>
        <ol type="(R2%c)" indent="7" spacing="normal" start="1" pn="section-3.2-2">
        <li pn="section-3.2-2.1" derivedCounter="(R2a)">A PE device that supports the vES function <bcp14>MUST</bcp14> support local switching among different vESes associated with the same service instance on a single physical port. For instance, in <xref target="fig-1" format="default" sectionFormat="of" derivedContent="Figure 1"/>, PE1 must support local switching between CE11 and CE12, which are mapped to two single-homed vESes on ENNI1. In the case of Single-Active vESes, the local switching is performed among active EVCs associated with the same service 
   instance on the same ENNI. </li>
        </ol>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.3">
        <name slugifiedName="name-evc-service-types">EVC Service Types</name>
        <t indent="0" pn="section-3.3-1"> A physical port, such as an ENNI of a PE device, can aggregate numerous 
   EVCs, each associated with a vES. An EVC may carry one or more VLANs. Typically, 
   an EVC carries a single VLAN and is therefore associated with a single broadcast 
   domain. However, there are no restrictions preventing an EVC from carrying 
   multiple VLANs. </t>
        <ol type="(R3%c)" group="req4" indent="7" start="1" spacing="normal" pn="section-3.3-2">
        <li pn="section-3.3-2.1" derivedCounter="(R3a)">An EVC can be associated with a single broadcast domain, such as in 
   a VLAN-based service or a VLAN bundle service. </li>
          <li pn="section-3.3-2.2" derivedCounter="(R3b)">An EVC <bcp14>MAY</bcp14> be associated with several broadcast domains, such as in
   a VLAN-aware bundle service. </li>
        </ol>
        <t indent="0" pn="section-3.3-3"> Similarly, a PE can aggregate multiple LSPs and PWs. In the case of individual 
   PWs per vES, a PW is typically associated with a single broadcast domain, although 
   there are no restrictions preventing a PW from carrying multiple VLANs if the PW 
   is configured in Raw mode. </t>
        <ol type="(R3%c)" group="req4" indent="7" start="3" spacing="normal" pn="section-3.3-4">
        <li pn="section-3.3-4.1" derivedCounter="(R3c)">A PW can be associated with a single broadcast domain, such as in a 
   VLAN-based service or a VLAN bundle service. </li>
          <li pn="section-3.3-4.2" derivedCounter="(R3d)">A PW <bcp14>MAY</bcp14> be associated with several broadcast domains, such as in a
   VLAN-aware bundle service. </li>
        </ol>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.4">
        <name slugifiedName="name-designated-forwarder-df-ele">Designated Forwarder (DF) Election</name>
        <t indent="0" pn="section-3.4-1"><xref section="8.5" target="RFC7432" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-8.5" derivedContent="RFC7432"/> specifies the default procedure for DF 
   election in EVPN, which is also applied in <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> and 
   <xref target="RFC8214" format="default" sectionFormat="of" derivedContent="RFC8214"/>. <xref target="RFC8584" format="default" sectionFormat="of" derivedContent="RFC8584"/> elaborates on additional 
   procedures for DF election in EVPN. These DF election procedures are performed at 
   the granularity of (ESI, Ethernet Tag). In the context of a vES, the same EVPN default 
   procedure for DF election is applicable but at the granularity of (vESI, Ethernet Tag). 
   In this context, the Ethernet Tag is represented by an I-SID in PBB-EVPN and by a 
   VLAN ID (VID) in EVPN.

   As described in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, this default procedure for DF election at 
   the granularity of (vESI, Ethernet Tag) is also known as "service carving." The goal 
   of service carving is to evenly distribute the DFs for different vESes among various PEs, 
   thereby ensuring an even distribution of traffic across the PEs. The following 
   requirements are applicable to the DF election of vESes for EVPN and PBB-EVPN. </t>
        <ol type="(R4%c)" indent="7" spacing="normal" start="1" pn="section-3.4-2">
        <li pn="section-3.4-2.1" derivedCounter="(R4a)">A PE that supports vES function <bcp14>MUST</bcp14> support a vES with m EVCs among
   n ENNIs belonging to p PEs in any arbitrary order, where n &gt;= p &gt;= m &gt;=2.
   For example, if there is a vES with 2 EVCs and there are 5 ENNIs on 5 PEs 
   (PE1 through PE5), then vES can be dual-homed to PE2 and PE4, and the DF 
   election must be performed between PE2 and PE4.</li>
          <li pn="section-3.4-2.2" derivedCounter="(R4b)">Each vES <bcp14>MUST</bcp14> be identified by its own virtual ESI (vESI). </li>
        </ol>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.5">
        <name slugifiedName="name-evc-monitoring">EVC Monitoring</name>
        <t indent="0" pn="section-3.5-1"> To detect the failure of an individual EVC and subsequently perform DF 
   election for its associated vES as a result of this failure, each EVC should 
   be monitored independently. </t>
        <ol type="(R5%c)" indent="7" spacing="normal" start="1" pn="section-3.5-2">
        <li pn="section-3.5-2.1" derivedCounter="(R5a)">Each EVC <bcp14>SHOULD</bcp14> be independently monitored for its operational health. </li>
          <li pn="section-3.5-2.2" derivedCounter="(R5b)">A failure in a single EVC, among many aggregated on a single physical 
   port or ENNI, <bcp14>MUST</bcp14> trigger a DF election for its associated vES. </li>
        </ol>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.6">
        <name slugifiedName="name-failure-and-recovery">Failure and Recovery</name>
        <ol type="(R6%c)" indent="7" spacing="normal" start="1" pn="section-3.6-1">
        <li pn="section-3.6-1.1" derivedCounter="(R6a)">Failure and failure recovery of an EVC for a single-homed vES
   <bcp14>SHALL NOT</bcp14> impact any other EVCs within its service instance or any
   other service instances. In other words, for PBB-EVPN, it <bcp14>SHALL NOT</bcp14>
   trigger any MAC flushing within both its own I-SID and other
   I-SIDs. </li>
          <li pn="section-3.6-1.2" derivedCounter="(R6b)">In case of All-Active vES, failure and failure
   recovery of an EVC for that vES <bcp14>SHALL NOT</bcp14> impact any other EVCs within
   its service instance or any other service instances. In other
   words, for PBB-EVPN, it <bcp14>SHALL NOT</bcp14> trigger any MAC flushing
   within both its own I-SID and other I-SIDs. </li>
          <li pn="section-3.6-1.3" derivedCounter="(R6c)">Failure and failure recovery of an EVC for a Single-Active vES
   <bcp14>SHALL</bcp14> impact only its own service instance. In other words, for PBB-EVPN,
   MAC flushing <bcp14>SHALL</bcp14> be limited to the associated I-SID only and
   <bcp14>SHALL NOT</bcp14> impact any other I-SIDs. </li>
          <li pn="section-3.6-1.4" derivedCounter="(R6d)">Failure and failure recovery of an EVC for a Single-Active vES
   <bcp14>MUST</bcp14> only impact C-MACs associated with a multihomed device/network for that service
   instance. In other words, MAC flushing <bcp14>MUST</bcp14> be limited to a single
   service instance (I-SID in the case of PBB-EVPN) and only C-MACs for a
   Single-Active multihomed device/network. </li>
        </ol>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.7">
        <name slugifiedName="name-fast-convergence">Fast Convergence</name>
        <t indent="0" pn="section-3.7-1"> Since many EVCs (and their associated vESes) are
   aggregated via a single physical port (e.g., ENNI), when there is a failure
   of that physical port, it impacts many vESes and equally triggers
   many ES route withdrawals. Formulating, sending,
   receiving, and processing such large numbers of BGP messages can
   introduce delay in DF election and convergence time. As such, it is
   highly desirable to have a mass-withdraw mechanism similar to the one
   in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> for withdrawing many Ethernet A-D per ES routes. </t>
        <ol type="(R7%c)" indent="7" spacing="normal" start="1" pn="section-3.7-2">
     <li pn="section-3.7-2.1" derivedCounter="(R7a)">There <bcp14>SHOULD</bcp14> be a mechanism equivalent to EVPN mass withdraw
	such that upon an ENNI failure, only a single BGP message to the PEs is needed to trigger DF election for all impacted vESes associated with that ENNI. </li>
        </ol>
      </section>
    </section>
    <section anchor="overview" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-solution-overview">Solution Overview</name>
      <t indent="0" pn="section-4-1"> The solutions described in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/>
      are leveraged         
   as is, with the modification that the ESI assignment is
   performed for an EVC or a group of EVCs or LSPs/PWs instead of a link or a group of
   physical links. In other words, the ESI is associated with a vES (hereby referred to as the "vESI"). </t>
      <t indent="0" pn="section-4-2"> In the EVPN solution, the overall procedures remain consistent, 
   with the primary difference being the handling of physical port failures 
   that can affect multiple vESes. Sections <xref target="fail_evc_sa_evpn" format="counter" sectionFormat="of" derivedContent="5.1"/> 
   and <xref target="fail_port_sa_evpn" format="counter" sectionFormat="of" derivedContent="5.3"/> describe the 
   procedures for managing physical port or link failures in the context of EVPN. 
   In a typical multihomed setup, MAC addresses learned behind a vES are 
   advertised using the ESI associated with the vES (i.e., the vESI). 
   EVPN aliasing and mass-withdraw operations are conducted with respect to the 
   vES identifier. Specifically, the Ethernet A-D routes for these 
      operations are advertised using the vESI instead of the ESI. </t>
      <t indent="0" pn="section-4-3"> For the PBB-EVPN solution, the main change is with respect to the B-MAC
   address assignment, which is performed in a similar way to what is described in
   <xref section="6.2.1.1" target="RFC7623" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7623#section-6.2.1.1" derivedContent="RFC7623"/>, with the following refinements:

      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-4">
        <li pn="section-4-4.1">
          <t indent="0" pn="section-4-4.1.1"> One shared B-MAC address <bcp14>SHOULD</bcp14> be used per PE for the single-homed
   vESes. In other words, a single B-MAC is shared for all single-homed
   vESes on that PE. </t>
        </li>
        <li pn="section-4-4.2">
          <t indent="0" pn="section-4-4.2.1"> One shared B-MAC address <bcp14>SHOULD</bcp14> be used per PE, per physical port
   (e.g., ENNI) for the Single-Active vESes. In other words, a single
   B-MAC is shared for all Single-Active vESes that share the same ENNI. </t>
        </li>
        <li pn="section-4-4.3">
          <t indent="0" pn="section-4-4.3.1"> One shared B-MAC address <bcp14>MAY</bcp14> be used for all Single-Active vESes on
   that PE. </t>
        </li>
        <li pn="section-4-4.4">
          <t indent="0" pn="section-4-4.4.1"> One B-MAC address <bcp14>SHOULD</bcp14> be used per set of EVCs representing an
   All-Active vES.  In other words, a single B-MAC address is
   used per vES for All-Active scenarios. </t>
        </li>
        <li pn="section-4-4.5">
          <t indent="0" pn="section-4-4.5.1"> A single B-MAC address <bcp14>MAY</bcp14> also be used per vES, per PE for Single-Active scenarios. </t>
        </li>
      </ul>
      <section anchor="df_election" numbered="true" removeInRFC="false" toc="include" pn="section-4.1">
        <name slugifiedName="name-evpn-df-election-for-ves">EVPN DF Election for vES</name>
        <t indent="0" pn="section-4.1-1">
   The service carving procedures for vESes are
   almost the same as the procedures outlined in <xref section="8.5" target="RFC7432" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-8.5" derivedContent="RFC7432"/>
   and in <xref target="RFC8584" format="default" sectionFormat="of" derivedContent="RFC8584"/>, except that ES is replaced with vES.</t>
        <t indent="0" pn="section-4.1-2">For the sake of clarity and completeness, the default DF election
   procedure of <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> is repeated below with the necessary 
   changes: 

        </t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-4.1-3">
	  <li pn="section-4.1-3.1" derivedCounter="1.">
            <t indent="0" pn="section-4.1-3.1.1"> When a PE discovers the vESI or is configured with the vESI
            associated with its attached vES, it advertises an ES route with the associated ES-Import Route Target extended community
            attribute. </t>
          </li>
          <li pn="section-4.1-3.2" derivedCounter="2.">
            <t indent="0" pn="section-4.1-3.2.1"> The PE then starts a timer (default value = 3 seconds) to
            allow the reception of ES routes from other PE nodes
            connected to the same vES. This timer value <bcp14>MUST</bcp14> be
            the same across all PEs connected to the same vES. </t>
          </li>
          <li pn="section-4.1-3.3" derivedCounter="3.">
            <t indent="0" pn="section-4.1-3.3.1"> When the timer expires, each PE builds an ordered list of the
            IP addresses of all the PE nodes connected to the vES (including
            itself), in increasing numeric value. Each IP address in this list
            is extracted from the "Originator Router's IP address" field of
            the advertised ES route. Every PE is then given an
            ordinal indicating its position in the ordered list, starting with
            0 as the ordinal for the PE with the numerically lowest IP
            address. The ordinals are used to determine which PE node will be
            the DF for a given EVPN instance on the vES using the following
            rule: Assuming a redundancy group of N PE nodes, the PE with
            ordinal i is the DF for an EVPN instance with an associated
            Ethernet Tag value of V when (V mod N) = i.  It should be noted
            that using the "Originator Router's IP address" field in the ES
            route to get the PE IP address needed for the ordered
            list allows a CE to be multihomed across different ASes, if
            such need ever arises. </t>
          </li>
          <li pn="section-4.1-3.4" derivedCounter="4.">
            <t indent="0" pn="section-4.1-3.4.1"> The PE that is elected as a DF for a given EVPN instance will
            unblock traffic for that EVPN instance. Note that the DF PE
            unblocks all traffic in both ingress and egress directions for
            Single-Active vESes and unblocks multi-destination in the egress
            direction for All-Active multihomed vESes. All non-DF PEs block all
            traffic in both ingress and egress directions for Single-Active
            vESes and block multi-destination traffic in the egress direction
            for All-Active vESes. </t>
          </li>
        </ol>
        <t indent="0" pn="section-4.1-4"> In case of an EVC failure, the affected PE withdraws its corresponding ES route if there are no more EVCs associated to the vES in the
   PE. This will re-trigger the DF election procedure on all the PEs in
   the redundancy group. For PE node failure, or upon PE commissioning
   or decommissioning, the PEs re-trigger the DF election procedure
   across all affected vESes.
   In case of a Single-Active scenario,
   when a service moves from one PE in the redundancy group to another
   PE because of DF re-election, the PE (which ends up being the
   elected DF for the service) <bcp14>MUST</bcp14> trigger a MAC address flush
   notification towards the associated vES if the multihoming device is a bridge
   or the multihoming network is an Ethernet bridged network.</t>
        <t indent="0" pn="section-4.1-5"> For LSP-based and PW-based vES, the non-DF PE <bcp14>SHOULD</bcp14> signal PW-status
   'standby' to the Aggregation PE (e.g., AG1 and AG2 in <xref target="fig-2" format="default" sectionFormat="of" derivedContent="Figure 2"/>),
   and a new DF PE <bcp14>MAY</bcp14> send a Label Distribution Protocol (LDP) MAC withdraw message as a MAC
   address flush notification. It should be noted that the PW-status is
   signaled for the scenarios where there is a one-to-one mapping
   between EVI (EVPN instance) and the PW.  </t>
      </section>
      <section anchor="grouping" numbered="true" removeInRFC="false" toc="include" pn="section-4.2">
        <name slugifiedName="name-grouping-and-route-coloring">Grouping and Route Coloring for vES</name>
        <t indent="0" pn="section-4.2-1">Physical ports (e.g., ENNI) that aggregate many EVCs
        are 'colored' to enable the grouping schemes described below. </t>
        <t indent="0" pn="section-4.2-2">By default, the MAC address of the corresponding port (e.g., ENNI)
        is used to represent the 'color' of the port, and the
        EVPN Router's MAC Extended Community defined
        in <xref target="RFC9135" format="default" sectionFormat="of" derivedContent="RFC9135"/> is used to signal this color.</t>
        <t indent="0" pn="section-4.2-3">The difference between coloring mechanisms for EVPN and PBB-EVPN is that 
        the extended community is advertised with the Ethernet A-D per ES
        route for EVPN, whereas the extended community is advertised
        with the B-MAC route for PBB-EVPN.</t>
        <t indent="0" pn="section-4.2-4"> The subsequent sections detailing Grouping of Ethernet A-D 
	    per ES routes and Grouping of B-MAC addresses will be essential for addressing port 
	    failure handling, as discussed in Sections <xref target="fail_port_sa_evpn" format="counter" sectionFormat="of" derivedContent="5.3"/>, 
	    <xref target="fail_port_sa_pbbevpn" format="counter" sectionFormat="of" derivedContent="5.4"/>, and <xref target="convergence" format="counter" sectionFormat="of" derivedContent="5.5"/>. </t>
        <section anchor="grouping_evpn" numbered="true" removeInRFC="false" toc="include" pn="section-4.2.1">
          <name slugifiedName="name-evpn-route-coloring-for-ves">EVPN Route Coloring for vES</name>
          <t indent="0" pn="section-4.2.1-1">When a PE discovers the vESI or is configured with the vESI associated
            with its attached vES, an ES route and Ethernet A-D per ES
            route are generated using the vESI identifier.</t>
          <t indent="0" pn="section-4.2.1-2">These ES and Ethernet A-D per ES routes specific to each
            vES are colored with an attribute representing their association
            to a physical port (e.g., ENNI).</t>
          <t indent="0" pn="section-4.2.1-3">The corresponding port 'color' is encoded in the 
            EVPN Router's MAC Extended Community defined in <xref target="RFC9135" format="default" sectionFormat="of" derivedContent="RFC9135"/> 
            and advertised along with the ES and Ethernet A-D per ES 
            routes for this vES. The color (which is the MAC address of the port) <bcp14>MUST</bcp14>
            be unique. </t>
          <t indent="0" pn="section-4.2.1-4">The PE also constructs a special Grouping Ethernet A-D per ES route
            that represents all the vESes associated with the port (e.g., ENNI). 
            The corresponding port 'color' is encoded in the ESI field.
            For this encoding, Type 3 ESI (<xref target="RFC7432" section="5" format="default" sectionFormat="of" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-5" derivedContent="RFC7432"/>) is used
            with the MAC field set to the color (MAC address) of the port
            and the 3-octet local discriminator field set to 0xFFFFFF. 
          </t>
          <t indent="0" pn="section-4.2.1-5">The ESI label extended community (<xref target="RFC7432" section="7.5" format="default" sectionFormat="of" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-7.5" derivedContent="RFC7432"/>)
            is not relevant to Grouping Ethernet A-D per ES route. The label value is not
            used for encapsulating Broadcast, Unknown Unicast, and Multicast (BUM) packets
            for any split-horizon function. The ESI
            label extended community <bcp14>MUST NOT</bcp14> be added to Grouping Ethernet A-D per ES route and
            <bcp14>MUST</bcp14> be ignored on receiving the PE.
          </t>
          <t indent="0" pn="section-4.2.1-6"> The Grouping Ethernet A-D per ES route is advertised with a 
	        list of Route Targets corresponding to the affected service instances. If the 
	        number of associated Route Targets exceeds the capacity of a single route, 
	        multiple Grouping Ethernet A-D per ES routes are advertised accordingly as
	        specified in <xref section="8.2" target="RFC7432" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-8.2" derivedContent="RFC7432"/>. </t>
        </section>
        <section anchor="grouping_pbbevpn" numbered="true" removeInRFC="false" toc="include" pn="section-4.2.2">
          <name slugifiedName="name-pbb-evpn-route-coloring-for">PBB-EVPN Route Coloring for vES</name>
          <t indent="0" pn="section-4.2.2-1"> In PBB-EVPN, particularly when there are large numbers of service instances 
	        (i.e., I-SIDs) associated with each EVC, the PE device <bcp14>MAY</bcp14> assign a color attribute 
	        to each vES B-MAC route, indicating their association with a physical port 
	        (e.g., an ENNI). </t>
          <t indent="0" pn="section-4.2.2-2">The corresponding port 'color' is encoded in the 
            EVPN Router's MAC Extended Community defined
            in <xref target="RFC9135" format="default" sectionFormat="of" derivedContent="RFC9135"/> and advertised
            along with the B-MAC for this vES in PBB-EVPN.</t>
          <t indent="0" pn="section-4.2.2-3">The PE <bcp14>MAY</bcp14> also construct a special Grouping B-MAC route
            that represents all the vESes associated with the port (e.g., ENNI).
            The corresponding port 'color' is encoded directly into this
            special Grouping B-MAC route.</t>
        </section>
      </section>
    </section>
    <section anchor="failure" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-failure-handling-and-recove">Failure Handling and Recovery</name>
      <t indent="0" pn="section-5-1"> There are several failure scenarios to consider such as:
      </t>
      <dl newline="false" spacing="normal" indent="3" pn="section-5-2">
        <dt pn="section-5-2.1">A:</dt>
        <dd pn="section-5-2.2">CE uplink port failure</dd>
        <dt pn="section-5-2.3">B:</dt>
        <dd pn="section-5-2.4">Ethernet Access Network failure</dd>
        <dt pn="section-5-2.5">C:</dt>
        <dd pn="section-5-2.6">PE access-facing port or link failure</dd>
        <dt pn="section-5-2.7">D:</dt>
        <dd pn="section-5-2.8">PE node failure</dd>
        <dt pn="section-5-2.9">E:</dt>
        <dd pn="section-5-2.10">PE isolation from IP/MPLS network</dd>
      </dl>
      <t indent="0" pn="section-5-3">
   The solutions specified in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/>, 
   and <xref target="RFC8214" format="default" sectionFormat="of" derivedContent="RFC8214"/> provide protection against failures as described in 
   these respective references. In the context of these solutions, the presence of vESes 
   introduces an additional failure scenario beyond those already considered, specifically 
   the failure of individual EVCs. Addressing vES failure scenarios necessitates the 
   independent monitoring of EVCs or PWs. Upon detection of failure or service restoration, 
   appropriate DF election and failure recovery mechanisms must be executed. </t>
      <t indent="0" pn="section-5-4"> <xref target="RFC7023" format="default" sectionFormat="of" derivedContent="RFC7023"/> is used for monitoring EVCs, and upon failure detection of a
   given EVC, the DF election procedure per <xref target="df_election" format="default" sectionFormat="of" derivedContent="Section 4.1"/> is executed. For
   PBB-EVPN, some extensions are needed to handle the failure and
   recovery procedures of <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> to meet the above
   requirements. These extensions are described in the next section. </t>
      <t indent="0" pn="section-5-5"> <xref target="RFC4377" format="default" sectionFormat="of" derivedContent="RFC4377"/> and <xref target="RFC6310" format="default" sectionFormat="of" derivedContent="RFC6310"/> are used for monitoring the status of LSPs
   and/or PWs associated to vES. </t>
      <figure anchor="fig-3" align="left" suppress-title="false" pn="figure-3">
        <name slugifiedName="name-failure-scenarios-a-b-c-d-a">Failure Scenarios A, B, C, D, and E</name>
        <artwork align="left" pn="section-5-6.1">
                      B            D
                      ||           ||
                      \/           \/
                    +-----+
       +-----+      |     |       +---+
       | CE1 |EVC2--0=====0--ENNI1|   |   +-------+
       +-----+      |    =0--ENNI1|PE1|---|       |  +---+  +---+
       Cust. A      |   / |       |   |   |IP/MPLS|--|PE3|--|CE4|
       +-----+      |  /  |       +---+   |Network|  |   |  +---+
       |     |EVC2--0==   |               |       |  +---+
       | CE2 |      |     |       +---+   |       |
       |     |EVC3--0=====0--ENNI2|PE2|---|       |
       +-----+      |     |       |   |   +-------+
                    +-----+       +---+
              /\                /\     /\
              ||                ||     ||
              A                 C      E</artwork>
      </figure>
      <section anchor="fail_evc_sa_evpn" numbered="true" removeInRFC="false" toc="include" pn="section-5.1">
        <name slugifiedName="name-evc-failure-handling-for-si">EVC Failure Handling for Single-Active vES in EVPN</name>
        <t indent="0" pn="section-5.1-1">
   In <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, when a DF PE connected to a Single-Active multihomed ES loses connectivity to the segment, due to link or port
   failure, it signals the remote PEs to invalidate all MAC addresses
   associated with that ES. This is done by means of a
   mass-withdraw message, by withdrawing the Ethernet A-D per ES route.
   It should be
   noted that for dual-homing use cases where there is only a single
   backup path, MAC invalidating can be avoided by the remote PEs as they
   can update their next hop associated with the affected MAC
   entries to the backup path per the procedure described in <xref section="8.2" sectionFormat="of" target="RFC7432" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-8.2" derivedContent="RFC7432"/>.
        </t>
        <t indent="0" pn="section-5.1-2">
   In case of an EVC failure that impacts a single vES, this same
   EVPN procedure is used. In this case, the mass withdraw is conveyed
   by withdrawing the Ethernet A-D per vES route carrying the vESI representing
   the failed EVC. Upon receiving this
   message, the remote PEs perform the same procedures outlined in <xref section="8.2" sectionFormat="of" target="RFC7432" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7432#section-8.2" derivedContent="RFC7432"/>.
        </t>
      </section>
      <section anchor="fail_evc_sa_pbbevpn" numbered="true" removeInRFC="false" toc="include" pn="section-5.2">
        <name slugifiedName="name-evc-failure-handling-for-a-">EVC Failure Handling for a Single-Active vES in PBB-EVPN</name>
        <t indent="0" pn="section-5.2-1"> In <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>, when a PE connected to a Single-Active ES
   loses connectivity to the segment, due to link or port failure, it
   signals the remote PE to flush all C-MAC addresses associated with
   that ES. This is done by updating the advertised B-MAC route's 
   MAC Mobility extended community. </t>
        <t indent="0" pn="section-5.2-2"> In case of an EVC failure that impacts a single vES, if the above
   PBB-EVPN procedure is used, it results in excessive C-MAC flushing
   because a single physical port can support a large number of EVCs (and
   their associated vESes); therefore, updating the advertised B-MAC corresponding to
   the physical port, with MAC Mobility extended community, will result in
   flushing C-MAC addresses not just for the impacted EVC but for all
   other EVCs on that port.</t>
        <t indent="0" pn="section-5.2-3"> To reduce the scope of C-MAC flushing to only the impacted
   service instances (the service instance(s) impacted by the EVC
   failure), the PBB-EVPN C-MAC flushing needs to be adapted on a per-service-instance
   basis (i.e., per I-SID).

   <xref target="RFC9541" format="default" sectionFormat="of" derivedContent="RFC9541"/> introduces a B-MAC/I-SID route where the 
   existing PBB-EVPN B-MAC route is modified to carry an I-SID, instead of a NULL value, in the "Ethernet Tag ID" field. To the receiving PE, this field indicates flushing all 
   C-MAC addresses associated with that I-SID for that B-MAC. This C-MAC flushing mechanism per I-SID 
   <bcp14>SHOULD</bcp14> be used in case of an EVC failure impacting a vES. Since an EVC typically maps to a single
   broadcast domain and thus a single service instance, the affected PE only needs to 
   advertise a single B-MAC/I-SID route.
   However, if the failed EVC carries multiple
   VLANs each with its own broadcast domain, then the affected PE needs to advertise multiple
   B-MAC/I-SID routes, i.e., one route for each VLAN (broadcast domain), meaning one route for each I-SID.
   Each B‑MAC/I-SID route basically instructs the remote PEs to perform flushing for
   C-MACs corresponding to the advertised B-MAC only for the advertised I-SID.</t>
        <t indent="0" pn="section-5.2-4"> The C-MAC flushing based on a B-MAC/I-SID route works fine when there are only a few
   VLANs (e.g., I-SIDs) per EVC. However, if the number of I-SIDs associated with a 
   failed EVC is large, then it is <bcp14>RECOMMENDED</bcp14> to assign a B-MAC per vES, and upon EVC failure, 
   the affected PE simply withdraws this B-MAC message to other PEs. </t>
      </section>
      <section anchor="fail_port_sa_evpn" numbered="true" removeInRFC="false" toc="include" pn="section-5.3">
        <name slugifiedName="name-port-failure-handling-for-s">Port Failure Handling for Single-Active vESes in EVPN</name>
        <t indent="0" pn="section-5.3-1"> When many EVCs are aggregated via a single physical port
   on a PE, where each EVC corresponds to a vES, then the port failure
   impacts all the associated EVCs and their corresponding vESes. If the
   number of EVCs corresponding to the Single-Active vESes for that
   physical port is in the thousands, then thousands of service instances
   are impacted. Therefore, the propagation of failure in BGP needs
   to address all these impacted service instances. In order to achieve this,
   the following extensions are added to the baseline EVPN mechanism:
   
        </t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-5.3-2"><li pn="section-5.3-2.1" derivedCounter="1.">
            <t indent="0" pn="section-5.3-2.1.1"> The PE <bcp14>MAY</bcp14> color each Ethernet A-D per ES route
            for a given vES, as described in <xref target="grouping_evpn" format="default" sectionFormat="of" derivedContent="Section 4.2.1"/>. The PE <bcp14>SHOULD</bcp14> use the
            MAC physical port by default.  The receiving PEs take note of this
            color and create a list of vESes for this color.</t>
          </li>
          <li pn="section-5.3-2.2" derivedCounter="2.">
            <t indent="0" pn="section-5.3-2.2.1">The PE <bcp14>MAY</bcp14> advertise a special Grouping
            Ethernet A-D per ES route for that color, which represents all the
            vESes associated with the port.</t>
          </li>
          <li pn="section-5.3-2.3" derivedCounter="3.">
            <t indent="0" pn="section-5.3-2.3.1"> Upon a port failure (e.g., an ENNI failure), the PE
            <bcp14>MAY</bcp14> send a mass-withdraw message by withdrawing the
            Grouping Ethernet A-D per ES route.</t>
          </li>
          <li pn="section-5.3-2.4" derivedCounter="4.">
            <t indent="0" pn="section-5.3-2.4.1"> When this message is received, the remote PE
            <bcp14>MAY</bcp14> detect the special vES mass-withdraw message by
            identifying the Grouping Ethernet A-D per ES route. The remote PEs
            <bcp14>MAY</bcp14> then access the list of vESes created
            per item 1 for the specified color and locally initiate MAC address
            invalidating procedures for each of the vESes in the list. </t>
          </li>
        </ol>
        <t indent="0" pn="section-5.3-3">

   In scenarios where a logical ENNI is used, the above procedure equally
   applies. The logical ENNI is represented by a Grouping Ethernet A-D per ES
   route where the Type 3 ESI and the 6 bytes used in the ENNI's ESI MAC address
   field are used as a color for the vESes as described above
   and in <xref target="grouping_evpn" format="default" sectionFormat="of" derivedContent="Section 4.2.1"/>.</t>
      </section>
      <section anchor="fail_port_sa_pbbevpn" numbered="true" removeInRFC="false" toc="include" pn="section-5.4">
        <name slugifiedName="name-port-failure-handling-for-si">Port Failure Handling for Single-Active vESes in PBB-EVPN</name>
        <t indent="0" pn="section-5.4-1">When many EVCs are aggregated via a single physical port
   on a PE, where each EVC corresponds to a vES, then the port failure
   impacts all the associated EVCs and their corresponding vESes. If the
   number of EVCs corresponding to the Single-Active vESes for that
   physical port is in the thousands, then thousands of service instances (I-SIDs) are impacted. In such failure scenarios, the following two
   MAC flushing mechanisms per <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> can be performed.  

        </t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-5.4-2"><li pn="section-5.4-2.1" derivedCounter="1.">
            <t indent="0" pn="section-5.4-2.1.1"> If the MAC address of the physical port is used for PBB
            encapsulation as B-MAC SA, then upon the port failure, the PE
            <bcp14>MUST</bcp14> use the EVPN MAC route withdrawal message to
            signal the flush.</t>
          </li>
          <li pn="section-5.4-2.2" derivedCounter="2.">
            <t indent="0" pn="section-5.4-2.2.1"> If the PE's shared MAC address is used for PBB encapsulation as
            B-MAC SA, then upon the port failure, the PE <bcp14>MUST</bcp14>
            re-advertise this MAC route with the MAC Mobility extended
            community to signal the flush.</t>
          </li>
        </ol>
        <t indent="0" pn="section-5.4-3">

   The first method is recommended because it reduces the scope of
   flushing the most. 
        </t>
        <t indent="0" pn="section-5.4-4">As noted above, the
   advertisement of the extended community along with the B-MAC route for coloring purposes is optional
   and only recommended when there are many vESes per physical port and each vES is associated with
   a very large number of service instances (i.e., a large number of I-SIDs). </t>
        <t indent="0" pn="section-5.4-5"> If there are large numbers of service instances (i.e., I-SIDs)
   associated with each EVC, and if there is a B-MAC assigned per vES 
   as recommended in the above section, then in order to handle
   port failure efficiently, the following extensions are added
   to the baseline PBB-EVPN mechanism:

        </t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-5.4-6">
	  <li pn="section-5.4-6.1" derivedCounter="1.">
            <t indent="0" pn="section-5.4-6.1.1">Each vES <bcp14>MAY</bcp14> be colored with a MAC address representing the
   physical port like the coloring mechanism for EVPN.
   In other words, each B-MAC representing a vES is advertised
   with the 'color' of the physical port per <xref target="grouping_pbbevpn" format="default" sectionFormat="of" derivedContent="Section 4.2.2"/>.
   
   The receiving PEs take note of this color being advertised
   along with the B-MAC route, and for each such color, they
   create a list of vESes associated with this color.</t>
          </li>
          <li pn="section-5.4-6.2" derivedCounter="2.">
            <t indent="0" pn="section-5.4-6.2.1">The PE <bcp14>MAY</bcp14> advertise a special Grouping B-MAC route
   for that color (consisting of a port MAC address by default),
   which represents all the vESes associated with the port.</t>
          </li>
          <li pn="section-5.4-6.3" derivedCounter="3.">
            <t indent="0" pn="section-5.4-6.3.1"> Upon a port failure (e.g., ENNI failure), the PE <bcp14>MAY</bcp14> send a mass-withdraw
   message by withdrawing the Grouping B-MAC route.</t>
          </li>
          <li pn="section-5.4-6.4" derivedCounter="4.">
            <t indent="0" pn="section-5.4-6.4.1"> When this message is received, the remote PE <bcp14>MAY</bcp14> 
   detect the special vES mass-withdraw message by identifying the
   Grouping B-MAC route. The remote PEs <bcp14>MAY</bcp14> then access the list created 
   in (1) above for the specified color and flush all C-MACs associated with the failed physical port. </t>
          </li>
        </ol>
      </section>
      <section anchor="convergence" numbered="true" removeInRFC="false" toc="include" pn="section-5.5">
        <name slugifiedName="name-fast-convergence-in-evpn-an">Fast Convergence in EVPN and PBB-EVPN</name>
        <t indent="0" pn="section-5.5-1">As described above, when many EVCs are aggregated via a
   physical port on a PE, and where each EVC corresponds to a vES, the
   port failure impacts all the associated EVCs and their corresponding
   vESes. Two actions must be taken as the result of such a port failure:

        </t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.5-2">
          <li pn="section-5.5-2.1">
            <t indent="0" pn="section-5.5-2.1.1"> For EVPN, initiate the mass-withdraw procedure for all vESes associated with 
   the failed port to invalidate MACs and for PBB-EVPN to flush all C-MACs associated with 
   the failed port across all vESes and the impacted I-SIDs </t>
          </li>
          <li pn="section-5.5-2.2">
            <t indent="0" pn="section-5.5-2.2.1"> Use DF election for all impacted vESes associated with the failed port </t>
          </li>
        </ul>
        <t indent="0" pn="section-5.5-3">

   <xref target="fail_port_sa_evpn" format="default" sectionFormat="of" derivedContent="Section 5.3"/> already describes how to perform a mass withdraw
   for all affected vESes and invalidate MACs using a single BGP withdrawal
   of the Grouping Ethernet A-D per ES route.
   <xref target="fail_port_sa_pbbevpn" format="default" sectionFormat="of" derivedContent="Section 5.4"/> describes how to only flush C-MAC addresses 
   associated with the failed physical port (e.g., optimum C-MAC flushing)
   as well as, optionally, the withdrawal of a Grouping B-MAC route.</t>
        <t indent="0" pn="section-5.5-4">This section describes how to perform DF election in the most
   optimal way, e.g., by triggering DF election for all impacted vESes
   (which can be very large) among the participating PEs via a single
   BGP message as opposed to sending a large number of BGP messages (one per
   vES). This section assumes that the MAC flushing mechanism described in
   <xref target="fail_port_sa_pbbevpn" format="default" sectionFormat="of" derivedContent="Section 5.4"/> and route coloring are used.
        </t>
        <figure anchor="fig-4" align="left" suppress-title="false" pn="figure-4">
          <name slugifiedName="name-fast-convergence-upon-enni-">Fast Convergence Upon ENNI Failure</name>
          <artwork align="left" pn="section-5.5-5.1">
                  +-----+
       +----+     |     |       +---+
       | CE1|AC1--0=====0--ENNI1|   |  +-------+
       |    |AC2--0     |       |PE1|--|       |
       +----+     |\  ==0--ENNI2|   |  |       |
                  | \/  |       +---+  |       |
                  | /\  |              |IP/MPLS|
       +----+     |/  \ |       +---+  |Network|   +---+  +---+
       | CE2|AC4--0    =0--ENNI3|   |  |       |---|PE4|--|CE4|
       |    |AC4--0=====0--ENNI3|PE2|--|       |   +---+  +---+
       +----+     | ====0--ENNI3|   |  |       |
                  |/    |       +---+  |       |
                  0     |              |       |
       +----+    /|     |       +---+  |       |
       | CE3|AC5- |     |       |PE3|--|       |
       |    |AC6--0=====0--ENNI4|   |  +-------+
       +----+     |     |       +---+
                  +-----+</artwork>
        </figure>
        <t indent="0" pn="section-5.5-6">
   As discussed in <xref target="grouping" format="default" sectionFormat="of" derivedContent="Section 4.2"/>, it is highly desirable to have a
   mass-withdraw mechanism similar to the one in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/>. Although
   such an optimization is desirable, it is <bcp14>OPTIONAL</bcp14>. If the optimization is 
   implemented, the following procedures are used:

        </t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-5.5-7">
	  <li pn="section-5.5-7.1" derivedCounter="1.">
            <t indent="0" pn="section-5.5-7.1.1"> When a vES is configured, the PE advertises the ES route 
   for this vES with a color that corresponds to the associated physical port. </t>
          </li>
          <li pn="section-5.5-7.2" derivedCounter="2.">
            <t indent="0" pn="section-5.5-7.2.1"> All receiving PEs within the redundancy group record this color and 
   compile a list of vESes associated with it. </t>
          </li>
          <li pn="section-5.5-7.3" derivedCounter="3.">
            <t indent="0" pn="section-5.5-7.3.1"> Additionally, the PE advertises a Grouping Ethernet A-D per ES route for EVPN, 
   and a Grouping B-MAC route for PBB-EVPN, which corresponds to the color and vES grouping. </t>
          </li>
          <li pn="section-5.5-7.4" derivedCounter="4.">
            <t indent="0" pn="section-5.5-7.4.1"> In the event of a port failure, such as an ENNI failure, the PE withdraws 
   the previously advertised Grouping Ethernet A-D per ES route or Grouping B-MAC route associated 
   with the failed port. The PE should prioritize sending these Grouping route withdrawal 
   messages over the withdrawal of individual vES routes affected by the failure. For 
   instance, as depicted in <xref target="fig-4" format="default" sectionFormat="of" derivedContent="Figure 4"/>, when the physical port associated with ENNI3 fails 
   on PE2, it withdraws the previously advertised Grouping Ethernet A-D per ES route. 
   Upon receiving this withdrawal message, other multihoming PEs (such as PE1 and PE3) 
   recognize that the vESes associated with CE1 and CE3 are impacted, based on the associated 
   color, and thus initiate the DF election procedure for these vESes. Furthermore, upon receiving this withdrawal message, remote PEs (such as PE4) initiate the failover procedure 
   for the vESes associated with CE1 and CE3 and switch to the other PE for each vES 
   redundancy group. </t>
          </li>
          <li pn="section-5.5-7.5" derivedCounter="5.">
            <t indent="0" pn="section-5.5-7.5.1"> On reception of Grouping Ethernet A-D per ES route or Grouping B-MAC route withdrawal,
   other PEs in the redundancy group initiate DF election procedures
   across all their affected vESes. </t>
          </li>
          <li pn="section-5.5-7.6" derivedCounter="6.">
            <t indent="0" pn="section-5.5-7.6.1"> The PE with the physical port failure (ENNI failure) sends a
   vES route withdrawal for every impacted vES. Upon
   receiving these messages, the other PEs clear up their BGP tables. It should be
   noted that the vES route withdrawal messages are not used for executing DF
   election procedures by the receiving PEs when Grouping Ethernet A-D per ES
   route or Grouping B-MAC route withdrawal has been previously received. </t>
          </li>
        </ol>
      </section>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-6-1">
   All the security considerations in <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> apply
   directly to this document because this document leverages the control
   and data plane procedures described in those documents.
      </t>
      <t indent="0" pn="section-6-2">
   This document does not introduce any new security considerations
   beyond that of <xref target="RFC7432" format="default" sectionFormat="of" derivedContent="RFC7432"/> and <xref target="RFC7623" format="default" sectionFormat="of" derivedContent="RFC7623"/> because advertisements and the
   processing of ES routes for vES in this document follow
   that of physical ES in those RFCs.
      </t>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-7-1">
    This document has no IANA actions.
      </t>
    </section>
  </middle>
  <back>
    <references pn="section-8">
      <name slugifiedName="name-references">References</name>
      <references pn="section-8.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC7432" target="https://www.rfc-editor.org/info/rfc7432" quoteTitle="true" derivedAnchor="RFC7432">
          <front>
            <title>BGP MPLS-Based Ethernet VPN</title>
            <author fullname="A. Sajassi" initials="A." role="editor" surname="Sajassi"/>
            <author fullname="R. Aggarwal" initials="R." surname="Aggarwal"/>
            <author fullname="N. Bitar" initials="N." surname="Bitar"/>
            <author fullname="A. Isaac" initials="A." surname="Isaac"/>
            <author fullname="J. Uttaro" initials="J." surname="Uttaro"/>
            <author fullname="J. Drake" initials="J." surname="Drake"/>
            <author fullname="W. Henderickx" initials="W." surname="Henderickx"/>
            <date month="February" year="2015"/>
            <abstract>
              <t indent="0">This document describes procedures for BGP MPLS-based Ethernet VPNs (EVPN). The procedures described here meet the requirements specified in RFC 7209 -- "Requirements for Ethernet VPN (EVPN)".</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7432"/>
          <seriesInfo name="DOI" value="10.17487/RFC7432"/>
        </reference>
        <reference anchor="RFC7623" target="https://www.rfc-editor.org/info/rfc7623" quoteTitle="true" derivedAnchor="RFC7623">
          <front>
            <title>Provider Backbone Bridging Combined with Ethernet VPN (PBB-EVPN)</title>
            <author fullname="A. Sajassi" initials="A." role="editor" surname="Sajassi"/>
            <author fullname="S. Salam" initials="S." surname="Salam"/>
            <author fullname="N. Bitar" initials="N." surname="Bitar"/>
            <author fullname="A. Isaac" initials="A." surname="Isaac"/>
            <author fullname="W. Henderickx" initials="W." surname="Henderickx"/>
            <date month="September" year="2015"/>
            <abstract>
              <t indent="0">This document discusses how Ethernet Provider Backbone Bridging (PBB) can be combined with Ethernet VPN (EVPN) in order to reduce the number of BGP MAC Advertisement routes by aggregating Customer/Client MAC (C-MAC) addresses via Provider Backbone MAC (B-MAC) address, provide client MAC address mobility using C-MAC aggregation, confine the scope of C-MAC learning to only active flows, offer per-site policies, and avoid C-MAC address flushing on topology changes. The combined solution is referred to as PBB-EVPN.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7623"/>
          <seriesInfo name="DOI" value="10.17487/RFC7623"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol specifications. This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8214" target="https://www.rfc-editor.org/info/rfc8214" quoteTitle="true" derivedAnchor="RFC8214">
          <front>
            <title>Virtual Private Wire Service Support in Ethernet VPN</title>
            <author fullname="S. Boutros" initials="S." surname="Boutros"/>
            <author fullname="A. Sajassi" initials="A." surname="Sajassi"/>
            <author fullname="S. Salam" initials="S." surname="Salam"/>
            <author fullname="J. Drake" initials="J." surname="Drake"/>
            <author fullname="J. Rabadan" initials="J." surname="Rabadan"/>
            <date month="August" year="2017"/>
            <abstract>
              <t indent="0">This document describes how Ethernet VPN (EVPN) can be used to support the Virtual Private Wire Service (VPWS) in MPLS/IP networks. EVPN accomplishes the following for VPWS: provides Single-Active as well as All-Active multihoming with flow-based load-balancing, eliminates the need for Pseudowire (PW) signaling, and provides fast protection convergence upon node or link failure.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8214"/>
          <seriesInfo name="DOI" value="10.17487/RFC8214"/>
        </reference>
        <reference anchor="RFC8365" target="https://www.rfc-editor.org/info/rfc8365" quoteTitle="true" derivedAnchor="RFC8365">
          <front>
            <title>A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)</title>
            <author fullname="A. Sajassi" initials="A." role="editor" surname="Sajassi"/>
            <author fullname="J. Drake" initials="J." role="editor" surname="Drake"/>
            <author fullname="N. Bitar" initials="N." surname="Bitar"/>
            <author fullname="R. Shekhar" initials="R." surname="Shekhar"/>
            <author fullname="J. Uttaro" initials="J." surname="Uttaro"/>
            <author fullname="W. Henderickx" initials="W." surname="Henderickx"/>
            <date month="March" year="2018"/>
            <abstract>
              <t indent="0">This document specifies how Ethernet VPN (EVPN) can be used as a Network Virtualization Overlay (NVO) solution and explores the various tunnel encapsulation options over IP and their impact on the EVPN control plane and procedures. In particular, the following encapsulation options are analyzed: Virtual Extensible LAN (VXLAN), Network Virtualization using Generic Routing Encapsulation (NVGRE), and MPLS over GRE. This specification is also applicable to Generic Network Virtualization Encapsulation (GENEVE); however, some incremental work is required, which will be covered in a separate document. This document also specifies new multihoming procedures for split-horizon filtering and mass withdrawal. It also specifies EVPN route constructions for VXLAN/NVGRE encapsulations and Autonomous System Border Router (ASBR) procedures for multihoming of Network Virtualization Edge (NVE) devices.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8365"/>
          <seriesInfo name="DOI" value="10.17487/RFC8365"/>
        </reference>
        <reference anchor="RFC9135" target="https://www.rfc-editor.org/info/rfc9135" quoteTitle="true" derivedAnchor="RFC9135">
          <front>
            <title>Integrated Routing and Bridging in Ethernet VPN (EVPN)</title>
            <author fullname="A. Sajassi" initials="A." surname="Sajassi"/>
            <author fullname="S. Salam" initials="S." surname="Salam"/>
            <author fullname="S. Thoria" initials="S." surname="Thoria"/>
            <author fullname="J. Drake" initials="J." surname="Drake"/>
            <author fullname="J. Rabadan" initials="J." surname="Rabadan"/>
            <date month="October" year="2021"/>
            <abstract>
              <t indent="0">Ethernet VPN (EVPN) provides an extensible and flexible multihoming VPN solution over an MPLS/IP network for intra-subnet connectivity among Tenant Systems and end devices that can be physical or virtual. However, there are scenarios for which there is a need for a dynamic and efficient inter-subnet connectivity among these Tenant Systems and end devices while maintaining the multihoming capabilities of EVPN. This document describes an Integrated Routing and Bridging (IRB) solution based on EVPN to address such requirements.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9135"/>
          <seriesInfo name="DOI" value="10.17487/RFC9135"/>
        </reference>
        <reference anchor="RFC9541" target="https://www.rfc-editor.org/info/rfc9541" quoteTitle="true" derivedAnchor="RFC9541">
          <front>
            <title>Flush Mechanism for Customer MAC Addresses Based on Service Instance Identifier (I-SID) in Provider Backbone Bridging EVPN (PBB-EVPN)</title>
            <author fullname="J. Rabadan" initials="J." role="editor" surname="Rabadan"/>
            <author fullname="S. Sathappan" initials="S." surname="Sathappan"/>
            <author fullname="K. Nagaraj" initials="K." surname="Nagaraj"/>
            <author fullname="M. Miyake" initials="M." surname="Miyake"/>
            <author fullname="T. Matsuda" initials="T." surname="Matsuda"/>
            <date month="March" year="2024"/>
            <abstract>
              <t indent="0">Provider Backbone Bridging (PBB) can be combined with Ethernet Virtual Private Networks (EVPNs) to deploy Ethernet Local Area Network (E-LAN) services in large Multiprotocol Label Switching (MPLS) networks. That combination is what we refer to as "PBB-EVPN." Single-Active multihoming and per Service Instance Identifier (I-SID) load-balancing can be provided to access devices and aggregation networks. In order to speed up the network convergence in case of failures on Single-Active multihomed Ethernet Segments (ESs), PBB-EVPN defines a flush mechanism for Customer MACs (C-MACs) called "C-MAC flush" that works for different Ethernet Segment Backbone MAC (B-MAC) address allocation models. This document complements those C-MAC flush procedures for cases in which no PBB-EVPN ESs are defined (i.e., the attachment circuit is associated with a zero Ethernet Segment Identifier (ESI)) and the C-MAC flush requires I-SID-level granularity.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9541"/>
          <seriesInfo name="DOI" value="10.17487/RFC9541"/>
        </reference>
      </references>
      <references pn="section-8.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="MEF63" target="https://www.mef.net/resources/mef-6-3-subscriber-ethernet-service-definitions" quoteTitle="true" derivedAnchor="MEF63">
          <front>
            <title>Subscriber Ethernet Services Definitions</title>
            <author>
              <organization showOnFrontPage="true">Metro Ethernet Forum</organization>
            </author>
            <date month="11" year="2019"/>
          </front>
          <seriesInfo name="MEF" value="6.3"/>
          <refcontent>MEF Standard</refcontent>
        </reference>
        <reference anchor="RFC4377" target="https://www.rfc-editor.org/info/rfc4377" quoteTitle="true" derivedAnchor="RFC4377">
          <front>
            <title>Operations and Management (OAM) Requirements for Multi-Protocol Label Switched (MPLS) Networks</title>
            <author fullname="T. Nadeau" initials="T." surname="Nadeau"/>
            <author fullname="M. Morrow" initials="M." surname="Morrow"/>
            <author fullname="G. Swallow" initials="G." surname="Swallow"/>
            <author fullname="D. Allan" initials="D." surname="Allan"/>
            <author fullname="S. Matsushima" initials="S." surname="Matsushima"/>
            <date month="February" year="2006"/>
            <abstract>
              <t indent="0">This document specifies Operations and Management (OAM) requirements for Multi-Protocol Label Switching (MPLS), as well as for applications of MPLS, such as pseudo-wire voice and virtual private network services. These requirements have been gathered from network operators who have extensive experience deploying MPLS networks. This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4377"/>
          <seriesInfo name="DOI" value="10.17487/RFC4377"/>
        </reference>
        <reference anchor="RFC6310" target="https://www.rfc-editor.org/info/rfc6310" quoteTitle="true" derivedAnchor="RFC6310">
          <front>
            <title>Pseudowire (PW) Operations, Administration, and Maintenance (OAM) Message Mapping</title>
            <author fullname="M. Aissaoui" initials="M." surname="Aissaoui"/>
            <author fullname="P. Busschbach" initials="P." surname="Busschbach"/>
            <author fullname="L. Martini" initials="L." surname="Martini"/>
            <author fullname="M. Morrow" initials="M." surname="Morrow"/>
            <author fullname="T. Nadeau" initials="T." surname="Nadeau"/>
            <author fullname="Y(J). Stein" surname="Y(J). Stein"/>
            <date month="July" year="2011"/>
            <abstract>
              <t indent="0">This document specifies the mapping and notification of defect states between a pseudowire (PW) and the Attachment Circuits (ACs) of the end-to-end emulated service. It standardizes the behavior of Provider Edges (PEs) with respect to PW and AC defects. It addresses ATM, Frame Relay, Time Division Multiplexing (TDM), and Synchronous Optical Network / Synchronous Digital Hierarchy (SONET/SDH) PW services, carried over MPLS, MPLS/IP, and Layer 2 Tunneling Protocol version 3/IP (L2TPv3/IP) Packet Switched Networks (PSNs). [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6310"/>
          <seriesInfo name="DOI" value="10.17487/RFC6310"/>
        </reference>
        <reference anchor="RFC7023" target="https://www.rfc-editor.org/info/rfc7023" quoteTitle="true" derivedAnchor="RFC7023">
          <front>
            <title>MPLS and Ethernet Operations, Administration, and Maintenance (OAM) Interworking</title>
            <author fullname="D. Mohan" initials="D." role="editor" surname="Mohan"/>
            <author fullname="N. Bitar" initials="N." role="editor" surname="Bitar"/>
            <author fullname="A. Sajassi" initials="A." role="editor" surname="Sajassi"/>
            <author fullname="S. DeLord" initials="S." surname="DeLord"/>
            <author fullname="P. Niger" initials="P." surname="Niger"/>
            <author fullname="R. Qiu" initials="R." surname="Qiu"/>
            <date month="October" year="2013"/>
            <abstract>
              <t indent="0">This document specifies the mapping of defect states between Ethernet Attachment Circuits (ACs) and associated Ethernet pseudowires (PWs) connected in accordance with the Pseudowire Emulation Edge-to-Edge (PWE3) architecture to realize an end-to-end emulated Ethernet service. It standardizes the behavior of Provider Edges (PEs) with respect to Ethernet PW and AC defects.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7023"/>
          <seriesInfo name="DOI" value="10.17487/RFC7023"/>
        </reference>
        <reference anchor="RFC7080" target="https://www.rfc-editor.org/info/rfc7080" quoteTitle="true" derivedAnchor="RFC7080">
          <front>
            <title>Virtual Private LAN Service (VPLS) Interoperability with Provider Backbone Bridges</title>
            <author fullname="A. Sajassi" initials="A." surname="Sajassi"/>
            <author fullname="S. Salam" initials="S." surname="Salam"/>
            <author fullname="N. Bitar" initials="N." surname="Bitar"/>
            <author fullname="F. Balus" initials="F." surname="Balus"/>
            <date month="December" year="2013"/>
            <abstract>
              <t indent="0">The scalability of Hierarchical Virtual Private LAN Service (H-VPLS) with Ethernet access networks (RFC 4762) can be improved by incorporating Provider Backbone Bridge functionality in the VPLS access. Provider Backbone Bridging has been standardized as IEEE 802.1ah-2008. It aims to improve the scalability of Media Access Control (MAC) addresses and service instances in Provider Ethernet networks. This document describes different interoperability scenarios where Provider Backbone Bridge functionality is used in H-VPLS with Ethernet or MPLS access network to attain better scalability in terms of number of customer MAC addresses and number of service instances. The document also describes the scenarios and the mechanisms for incorporating Provider Backbone Bridge functionality within H-VPLS with existing Ethernet access and interoperability among them. Furthermore, the document discusses the migration mechanisms and scenarios by which Provider Backbone Bridge functionality can be incorporated into H-VPLS with existing MPLS access.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7080"/>
          <seriesInfo name="DOI" value="10.17487/RFC7080"/>
        </reference>
        <reference anchor="RFC7209" target="https://www.rfc-editor.org/info/rfc7209" quoteTitle="true" derivedAnchor="RFC7209">
          <front>
            <title>Requirements for Ethernet VPN (EVPN)</title>
            <author fullname="A. Sajassi" initials="A." surname="Sajassi"/>
            <author fullname="R. Aggarwal" initials="R." surname="Aggarwal"/>
            <author fullname="J. Uttaro" initials="J." surname="Uttaro"/>
            <author fullname="N. Bitar" initials="N." surname="Bitar"/>
            <author fullname="W. Henderickx" initials="W." surname="Henderickx"/>
            <author fullname="A. Isaac" initials="A." surname="Isaac"/>
            <date month="May" year="2014"/>
            <abstract>
              <t indent="0">The widespread adoption of Ethernet L2VPN services and the advent of new applications for the technology (e.g., data center interconnect) have culminated in a new set of requirements that are not readily addressable by the current Virtual Private LAN Service (VPLS) solution. In particular, multihoming with all-active forwarding is not supported, and there's no existing solution to leverage Multipoint-to-Multipoint (MP2MP) Label Switched Paths (LSPs) for optimizing the delivery of multi-destination frames. Furthermore, the provisioning of VPLS, even in the context of BGP-based auto-discovery, requires network operators to specify various network parameters on top of the access configuration. This document specifies the requirements for an Ethernet VPN (EVPN) solution, which addresses the above issues.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7209"/>
          <seriesInfo name="DOI" value="10.17487/RFC7209"/>
        </reference>
        <reference anchor="RFC8584" target="https://www.rfc-editor.org/info/rfc8584" quoteTitle="true" derivedAnchor="RFC8584">
          <front>
            <title>Framework for Ethernet VPN Designated Forwarder Election Extensibility</title>
            <author fullname="J. Rabadan" initials="J." role="editor" surname="Rabadan"/>
            <author fullname="S. Mohanty" initials="S." role="editor" surname="Mohanty"/>
            <author fullname="A. Sajassi" initials="A." surname="Sajassi"/>
            <author fullname="J. Drake" initials="J." surname="Drake"/>
            <author fullname="K. Nagaraj" initials="K." surname="Nagaraj"/>
            <author fullname="S. Sathappan" initials="S." surname="Sathappan"/>
            <date month="April" year="2019"/>
            <abstract>
              <t indent="0">An alternative to the default Designated Forwarder (DF) selection algorithm in Ethernet VPNs (EVPNs) is defined. The DF is the Provider Edge (PE) router responsible for sending Broadcast, Unknown Unicast, and Multicast (BUM) traffic to a multihomed Customer Edge (CE) device on a given VLAN on a particular Ethernet Segment (ES). In addition, the ability to influence the DF election result for a VLAN based on the state of the associated Attachment Circuit (AC) is specified. This document clarifies the DF election Finite State Machine in EVPN services. Therefore, it updates the EVPN specification (RFC 7432).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8584"/>
          <seriesInfo name="DOI" value="10.17487/RFC8584"/>
        </reference>
        <reference anchor="RFC9252" target="https://www.rfc-editor.org/info/rfc9252" quoteTitle="true" derivedAnchor="RFC9252">
          <front>
            <title>BGP Overlay Services Based on Segment Routing over IPv6 (SRv6)</title>
            <author fullname="G. Dawra" initials="G." role="editor" surname="Dawra"/>
            <author fullname="K. Talaulikar" initials="K." role="editor" surname="Talaulikar"/>
            <author fullname="R. Raszuk" initials="R." surname="Raszuk"/>
            <author fullname="B. Decraene" initials="B." surname="Decraene"/>
            <author fullname="S. Zhuang" initials="S." surname="Zhuang"/>
            <author fullname="J. Rabadan" initials="J." surname="Rabadan"/>
            <date month="July" year="2022"/>
            <abstract>
              <t indent="0">This document defines procedures and messages for SRv6-based BGP services, including Layer 3 Virtual Private Network (L3VPN), Ethernet VPN (EVPN), and Internet services. It builds on "BGP/MPLS IP Virtual Private Networks (VPNs)" (RFC 4364) and "BGP MPLS-Based Ethernet VPN" (RFC 7432).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9252"/>
          <seriesInfo name="DOI" value="10.17487/RFC9252"/>
        </reference>
      </references>
    </references>
    <section numbered="false" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.a-1">
   The authors would like to thank <contact fullname="Mei Zhang"/>, <contact fullname="Jose Liste"/>, and <contact fullname="Luc André Burdet"/> for
   their reviews of this document and their feedback.
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="A" surname="Sajassi" fullname="Ali Sajassi">
        <organization showOnFrontPage="true">Cisco Systems</organization>
        <address>
          <email>sajassi@cisco.com</email>
        </address>
      </author>
      <author initials="P" surname="Brissette" fullname="Patrice Brissette">
        <organization showOnFrontPage="true">Cisco Systems</organization>
        <address>
          <email>pbrisset@cisco.com</email>
        </address>
      </author>
      <author initials="R" surname="Schell" fullname="Rick Schell">
        <organization showOnFrontPage="true">Independent</organization>
        <address>
          <email>rick_schell@outlook.com</email>
        </address>
      </author>
      <author initials="J" surname="Drake" fullname="John E. Drake">
        <organization showOnFrontPage="true">Independent</organization>
        <address>
          <email>je_drake@yahoo.com</email>
        </address>
      </author>
      <author initials="J" surname="Rabadan" fullname="Jorge Rabadan">
        <organization showOnFrontPage="true">Nokia</organization>
        <address>
          <email>jorge.rabadan@nokia.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
